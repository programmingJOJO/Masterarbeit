!function(){define("deferLink",["jquery"],function(a){"use strict";function b(a){return function(b){return c.call(this,b,a)}}function c(b,c){function d(){var a=+e.data(h)-1;e.data(h,a),0>=a&&!e.data(j)&&(e.removeData(i),k.location.href=l)}var e="A"===this.nodeName?a(this):a(b.target).closest("a"),l=e.attr("href"),m=e.attr("target"),n=e.length&&l&&1===b.which&&!b.metaKey&&!b.shiftKey,o=c;if(a.isFunction(c)&&(o=c.call(this,b),o===!1))return!1;n&&b.isDefaultPrevented()&&!e.data(h)&&(n=!1),n&&m&&"_self"!==m&&(n=!1),n&&g&&e.is("[download]")&&(n=!1),n&&e.hasClass(f)&&(n=!1);var p=+(e.data(h)||0);n&&(e.data(h,p+1),o.when?("resolved"===o.state()&&d(),o.done(d)):a.isNumeric(o)?k.setTimeout(d,o):(n=!1,e.data(h,p))),n&&!p&&(b.preventDefault(),e.data(i,!0))}function d(d){return d.when||a.isNumeric(d)||a.isFunction(d)?b(d):void c.call(this,d,e)}var e=50,f="no-defer",g="download"in document.createElement("a"),h="defer-link-pends",i="defer-link-preventable",j="defer-link-prevented",k=window,l=a.Event.prototype.preventDefault;return a.Event.prototype.preventDefault=function(){var b=a(this.target);return b.data(i)&&b.data(j,!0),l.apply(this,Array.prototype.slice.call(arguments))},d}),define("utils/applyAll",["jquery"],function(a){"use strict";function b(c,d,e){var f,g;for(f=0,g=d.length;g>f;f++)a.isArray(d[f])?b(c,d[f],e):d[f].apply(c,e)}return b}),define("utils/throwError",[],function(){"use strict";return function(a){throw new Error("Error in TED: "+a)}}),define("lib/pubSub",["jquery","utils/applyAll","utils/throwError"],function(a,b,c){"use strict";function d(a){var d={publish:a.fire,subscribe:a.add,unsubscribe:a.remove},e=null;a.add(function(a){e=a}),d.read=function(){return e};var f;return d.publishUnique=function(){if(!window.JSON)return c("JSON object not available. You may need to shim it on this client."),!1;var b=Array.prototype.slice.call(arguments,0),d=JSON.stringify(b);d!==f&&(a.fire.apply(a,b),f=d)},d.once=function(){function c(){b(a,d,arguments),a.remove(c)}var d=arguments;return a.add(c)},d.future=function(){function c(){f&&b(a,e,arguments)}var d,e=arguments,f=!1;return d=a.add(c),f=!0,d},d}function e(b){var c,e=b&&f[b];return e||(c=a.Callbacks("memory"),e=d(c),b&&(f[b]=e)),e}var f={};return e._reset=function(){f={}},e}),define("lib/resize",["jquery","lodash","lib/pubSub"],function(a,b,c){"use strict";function d(a){for(var b,d=m;d--;)!b&&a>=l[d].at&&(b=l[d].its);c("sizeGroup").publishUnique(b)}function e(){var a=0,b=k;if(f=window.innerHeight,g=window.innerWidth||document.documentElement.clientWidth,j)a=i;else for(;b--;)!a&&g>=h[b]&&(a=h[b]);c("breakpoint").publishUnique(a),c("height").publishUnique(f),c("width").publishUnique(g)}var f,g,h=[320,480,600,768,1024,1200],i=1024,j=a("html").is(".oldie"),k=h.length,l=[{at:0,its:"oh"},{at:480,its:"xs"},{at:768,its:"sm"},{at:1024,its:"lg"}],m=l.length;return a(window).on("resize",b.throttle(e,100)),e(),c("breakpoint").subscribe(d),c}),define("lib/ga",["jquery","lodash","deferLink","lib/pubSub","lib/resize"],function(a,b,c,d){"use strict";function e(){(j[j.GoogleAnalyticsObject]||a.noop).apply(j,i.slice.call(arguments))}function f(){var a=i.slice.call(arguments),d=this;return function(f){return d.apply(e,a),b.has(f,"originalEvent")&&b.has(this,"nodeName")&&"click"===f.type?c.call(this,f):void 0}}function g(){var a,b=0;d("breakpoint").subscribe(function(c){e("set","dimension1",c),b++&&e.sendEvent("breakpoint","change",a+"|"+c,b),a=c})}function h(b){var c=a(this),d="ga-";b=a.extend(b||{},{category:c.data(d+"category"),action:c.data(d+"action"),label:c.data(d+"label")}),e.sendEvent(b.category,b.action,b.label)}var i=[],j=window;return b.assign(e,{send:b.partial(e,"send"),set:b.partial(e,"set"),sendEvent:b.partial(e,"send","event"),sendSocial:b.partial(e,"send","social")},function(a,b){return b.recall=f,b}),e.virtualPageview=function(a){e.set("page",a+(-1===a.indexOf("?")?"?":"&")+"vp"),e.send("pageview")},g(),e.send("pageview"),a(function(){a(document).on("click","a.ga-link",c(function(){return h.call(this,{action:"click",category:"site.link",label:this.href}),50}))}),e}),function(){function a(a){this._value=a}function b(a,b,c,d){var e,f,g=Math.pow(10,b);return f=(c(a*g)/g).toFixed(b),d&&(e=new RegExp("0{1,"+d+"}$"),f=f.replace(e,"")),f}function c(a,b,c){var d;return d=b.indexOf("$")>-1?e(a,b,c):b.indexOf("%")>-1?f(a,b,c):b.indexOf(":")>-1?g(a,b):i(a._value,b,c)}function d(a,b){var c,d,e,f,g,i=b,j=["KB","MB","GB","TB","PB","EB","ZB","YB"],k=!1;if(b.indexOf(":")>-1)a._value=h(b);else if(b===o)a._value=0;else{for("."!==m[n].delimiters.decimal&&(b=b.replace(/\./g,"").replace(m[n].delimiters.decimal,".")),c=new RegExp("[^a-zA-Z]"+m[n].abbreviations.thousand+"(?:\\)|(\\"+m[n].currency.symbol+")?(?:\\))?)?$"),d=new RegExp("[^a-zA-Z]"+m[n].abbreviations.million+"(?:\\)|(\\"+m[n].currency.symbol+")?(?:\\))?)?$"),e=new RegExp("[^a-zA-Z]"+m[n].abbreviations.billion+"(?:\\)|(\\"+m[n].currency.symbol+")?(?:\\))?)?$"),f=new RegExp("[^a-zA-Z]"+m[n].abbreviations.trillion+"(?:\\)|(\\"+m[n].currency.symbol+")?(?:\\))?)?$"),g=0;g<=j.length&&!(k=b.indexOf(j[g])>-1?Math.pow(1024,g+1):!1);g++);a._value=(k?k:1)*(i.match(c)?Math.pow(10,3):1)*(i.match(d)?Math.pow(10,6):1)*(i.match(e)?Math.pow(10,9):1)*(i.match(f)?Math.pow(10,12):1)*(b.indexOf("%")>-1?.01:1)*((b.split("-").length+Math.min(b.split("(").length-1,b.split(")").length-1))%2?1:-1)*Number(b.replace(/[^0-9\.]+/g,"")),a._value=k?Math.ceil(a._value):a._value}return a._value}function e(a,b,c){var d,e=b.indexOf("$")<=1,f="";return b.indexOf(" $")>-1?(f=" ",b=b.replace(" $","")):b.indexOf("$ ")>-1?(f=" ",b=b.replace("$ ","")):b=b.replace("$",""),d=i(a._value,b,c),e?d.indexOf("(")>-1||d.indexOf("-")>-1?(d=d.split(""),d.splice(1,0,m[n].currency.symbol+f),d=d.join("")):d=m[n].currency.symbol+f+d:d.indexOf(")")>-1?(d=d.split(""),d.splice(-1,0,f+m[n].currency.symbol),d=d.join("")):d=d+f+m[n].currency.symbol,d}function f(a,b,c){var d,e="",f=100*a._value;return b.indexOf(" %")>-1?(e=" ",b=b.replace(" %","")):b=b.replace("%",""),d=i(f,b,c),d.indexOf(")")>-1?(d=d.split(""),d.splice(-1,0,e+"%"),d=d.join("")):d=d+e+"%",d}function g(a){var b=Math.floor(a._value/60/60),c=Math.floor((a._value-60*b*60)/60),d=Math.round(a._value-60*b*60-60*c);return b+":"+(10>c?"0"+c:c)+":"+(10>d?"0"+d:d)}function h(a){var b=a.split(":"),c=0;return 3===b.length?(c+=60*Number(b[0])*60,c+=60*Number(b[1]),c+=Number(b[2])):2===b.length&&(c+=60*Number(b[0]),c+=Number(b[1])),Number(c)}function i(a,c,d){var e,f,g,h,i,j,k=!1,l=!1,p=!1,q="",r="",s="",t=Math.abs(a),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],v="",w=!1;if(0===a&&null!==o)return o;if(c.indexOf("(")>-1?(k=!0,c=c.slice(1,-1)):c.indexOf("+")>-1&&(l=!0,c=c.replace(/\+/g,"")),c.indexOf("a")>-1&&(c.indexOf(" a")>-1?(q=" ",c=c.replace(" a","")):c=c.replace("a",""),t>=Math.pow(10,12)?(q+=m[n].abbreviations.trillion,a/=Math.pow(10,12)):t<Math.pow(10,12)&&t>=Math.pow(10,9)?(q+=m[n].abbreviations.billion,a/=Math.pow(10,9)):t<Math.pow(10,9)&&t>=Math.pow(10,6)?(q+=m[n].abbreviations.million,a/=Math.pow(10,6)):t<Math.pow(10,6)&&t>=Math.pow(10,3)&&(q+=m[n].abbreviations.thousand,a/=Math.pow(10,3))),c.indexOf("b")>-1)for(c.indexOf(" b")>-1?(r=" ",c=c.replace(" b","")):c=c.replace("b",""),g=0;g<=u.length;g++)if(e=Math.pow(1024,g),f=Math.pow(1024,g+1),a>=e&&f>a){r+=u[g],e>0&&(a/=e);break}return c.indexOf("o")>-1&&(c.indexOf(" o")>-1?(s=" ",c=c.replace(" o","")):c=c.replace("o",""),s+=m[n].ordinal(a)),c.indexOf("[.]")>-1&&(p=!0,c=c.replace("[.]",".")),h=a.toString().split(".")[0],i=c.split(".")[1],j=c.indexOf(","),i?(i.indexOf("[")>-1?(i=i.replace("]",""),i=i.split("["),v=b(a,i[0].length+i[1].length,d,i[1].length)):v=b(a,i.length,d),h=v.split(".")[0],v=v.split(".")[1].length?m[n].delimiters.decimal+v.split(".")[1]:"",p&&0===Number(v.slice(1))&&(v="")):h=b(a,null,d),h.indexOf("-")>-1&&(h=h.slice(1),w=!0),j>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+m[n].delimiters.thousands)),0===c.indexOf(".")&&(h=""),(k&&w?"(":"")+(!k&&w?"-":"")+(!w&&l?"+":"")+h+v+(s?s:"")+(q?q:"")+(r?r:"")+(k&&w?")":"")}function j(a,b){m[a]=b}var k,l="1.5.2",m={},n="en",o=null,p="0,0",q="undefined"!=typeof module&&module.exports;k=function(b){return k.isNumeral(b)?b=b.value():0===b||"undefined"==typeof b?b=0:Number(b)||(b=k.fn.unformat(b)),new a(Number(b))},k.version=l,k.isNumeral=function(b){return b instanceof a},k.language=function(a,b){if(!a)return n;if(a&&!b){if(!m[a])throw new Error("Unknown language : "+a);n=a}return!b&&m[a]||j(a,b),k},k.languageData=function(a){if(!a)return m[n];if(!m[a])throw new Error("Unknown language : "+a);return m[a]},k.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(a){var b=a%10;return 1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),k.zeroFormat=function(a){o="string"==typeof a?a:null},k.defaultFormat=function(a){p="string"==typeof a?a:"0.0"},k.fn=a.prototype={clone:function(){return k(this)},format:function(a,b){return c(this,a?a:p,void 0!==b?b:Math.round)},unformat:function(a){return"[object Number]"===Object.prototype.toString.call(a)?a:d(this,a?a:p)},value:function(){return this._value},valueOf:function(){return this._value},set:function(a){return this._value=Number(a),this},add:function(a){return this._value=this._value+Number(a),this},subtract:function(a){return this._value=this._value-Number(a),this},multiply:function(a){return this._value=this._value*Number(a),this},divide:function(a){return this._value=this._value/Number(a),this},difference:function(a){var b=this._value-Number(a);return 0>b&&(b=-b),b}},q&&(module.exports=k),"undefined"==typeof ender&&(this.numeral=k),"function"==typeof define&&define.amd&&define("numeral",[],function(){return k})}.call(this),define("abby-tests/sponsorship-2/sponsorship",["jquery","lib/ga","numeral","exports"],function(a,b,c,d){"use strict";function e(){return m?"complete":"incomplete"}function f(a){a=parseInt(a,10),b.sendEvent("talk.sponsorship.pay","click",a),m=!0,j.find("input.Sponsorship__amount").val(c(a).format("0.00")),j.find("form").submit()}function g(a){a.preventDefault(),b.sendEvent("talk.sponsorship.banner","close",e()),j.slideUp(300);try{localStorage.setItem("hideSponsorship",!0)}catch(c){}}function h(b){var c=a(b.target);b.preventDefault(),f(c.data("amount"))}function i(b){var d=a(b.target),e=c(d.data("amount")).format("0"),f=c(d.data("effect")).format("0,0");k=k||j.find("span.Sponsorship__message__amount"),l=l||j.find("span.Sponsorship__message__effect"),k.text("$"+e),l.text(f)}var j,k,l,m=!1;d.init=function(){j=a("#sponsorship"),j.find("button.Sponsorship__selection").on("click",h).on("mouseenter",i).removeAttr("disabled"),j.find("a.Sponsorship__close").on("click",g),j.is(":visible")||j.slideDown(400)}}),define("utils/is_mobile",[],function(){"use strict";function a(){return a.isIOS()||a.isAndroid()}function b(b){return!!a.ua.match(b)}var c=/Android/g,d=/(iPad|iPhone|iPod)/g;return a.isIOS=function(){return b(d)},a.isAndroid=function(){return b(c)},a.ua=window.navigator&&window.navigator.userAgent||"",a}),define("lib/instaplay",["jquery","utils/is_mobile","exports"],function(a,b,c){"use strict";var d="instaplay",e=50,f=15e3;c.capable=function(){return!b()&&this._storage()},c.set=function(b,d){var e=c._getStore()||{history:[]};d=a.extend({clearHistory:!0},d||{}),e.url=b,e.time=+new Date,d.clearHistory&&(e.history=[]),c._setStore(e)},c.check=function(a){var b=c._getStore();return b&&-1!==a.indexOf(b.url)&&+new Date-b.time<f?(b.history=b.history.slice(0,e-1),b.history.push(a),c._setStore(b),!0):(c._clearStore(),!1)},c.history=function(){var a=c._getStore();return a?a.history:[]},c.recentMatches=function(a){var b=c.history(),d=b.length,e=[];if(d)for(var f=0;d>f&&b[f].match(a);f++)e.push(b[f]);return e},c._getStore=function(){var a=c._storage();if(a){var b=a.getItem(d);if(b&&(b=window.JSON.parse(b),b&&b.url&&b.history&&b.time))return b}},c._setStore=function(a){var b=c._storage();b&&b.setItem(d,window.JSON.stringify(a))},c._clearStore=function(){var a=c._storage();a&&a.removeItem(d)},c._storage=function(){try{var a=window.sessionStorage,b=d+"-test",c="1";if(a.setItem(b,c),a.getItem(b)===c)return a.removeItem(b),a}catch(e){}return null},a(function(){a(document).on("click","a.instaplay-link",function(){c.set(a(this).attr("href"))})})}),define("hbs/underscore",{}),function(window){var JSON=window.JSON||{};!function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),define("hbs/json2",[],function(){return JSON})}.call(this,this),define("hbs",{load:function(a){throw new Error("Dynamic load not allowed: "+a)}}),define("utils/formatDuration",[],function(){"use strict";function a(a){return(a>9?"":"0")+a}return function(b){var c=b%60|0,d=b/3600|0,e=b%3600/60|0;return(d?d+":"+a(e):e)+":"+a(c)}}),define("templates/helpers/formatDuration",["Handlebars","utils/formatDuration"],function(a,b){"use strict";a.registerHelper("formatDuration",b)}),define("hbs!templates/thumb",["hbs","hbs/handlebars","templates/helpers/formatDuration"],function(a,b){var c=b.template({1:function(a,b,c,d){return'    <span class="thumb__duration">\n      '+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=a?a.playDuration:a,{name:"formatDuration",hash:{},data:d}))+"\n    </span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f;return'\n<span class="thumb thumb--'+this.escapeExpression((f=null!=(f=b.ratio||(null!=a?a.ratio:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"ratio",hash:{},data:d}):f))+" "+this.escapeExpression((f=null!=(f=b.cropClass||(null!=a?a.cropClass:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"cropClass",hash:{},data:d}):f))+'">\n  <span class="thumb__sizer"><span class="thumb__tugger"><img src="'+this.escapeExpression((f=null!=(f=b.src||(null!=a?a.src:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"src",hash:{},data:d}):f))+'" class="thumb__image" alt=""><span class="thumb__aligner"></span></span></span>\n\n'+(null!=(e=b["if"].call(a,null!=a?a.playDuration:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"</span>\n"},useData:!0});return b.registerPartial("templates/thumb",c),c}),define("templates/helpers/thumb",["Handlebars","hbs!templates/thumb"],function(a,b){"use strict";a.registerHelper("thumb",function(c,d,e){var f=e&&e>0?e:!1;return d=d||"video",new a.SafeString(b({cropClass:"video"===d?"thumb--crop-top":"",src:c,ratio:d,playDuration:f,playIcon:!f}))})}),define("hbs!templates/talk-countdown-checker",["hbs","hbs/handlebars","templates/helpers/thumb","templates/helpers/formatDuration"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'            <div class="col">\n              <a class="ga-link undec" href="/talks/'+this.escapeExpression((e=null!=(e=b.slug||(null!=a?a.slug:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"slug",hash:{},data:d}):e))+'" data-ga-category="talk.relatedTalk">\n                <div class="m4">'+this.escapeExpression((b.thumb||a&&a.thumb||b.helperMissing).call(a,null!=a?a.image:a,{name:"thumb",hash:{},data:d}))+'</div>\n\n                <div class="small hide-sm">'+this.escapeExpression((e=null!=(e=b.title||(null!=a?a.title:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"title",hash:{},data:d}):e))+'</div>\n                <div class="show-sm">\n                  <div class="h12 show-sm m5">'+this.escapeExpression((e=null!=(e=b.speaker||(null!=a?a.speaker:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"speaker",hash:{},data:d}):e))+'</div>\n                  <div class="h9 m5">'+this.escapeExpression((e=null!=(e=b.title||(null!=a?a.title:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"title",hash:{},data:d}):e))+'</div>\n                  <div class="show-sm">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=a?a.duration:a,{name:"formatDuration",hash:{},data:d}))+"</div>\n                </div>\n              </a>\n            </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="talk-end-card Talk-countdown-checker inverse">\n  <div class="vc">\n    <div class="vc__wrap">\n      <div class="container">\n\n        <h2 class="h4 m2 show-sm">Recommended talks:</h2>\n        <div class="row row-oh-3up row-skinny row-lg-wide">\n          <div class="col">\n            <a class="ga-link undec" href="/talks/'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.slug:e,a))+'" data-ga-category="talk.relatedTalk">\n              <div class="m4">'+this.escapeExpression((b.thumb||a&&a.thumb||b.helperMissing).call(a,null!=(e=null!=a?a.nextTalk:a)?e.image:e,{name:"thumb",hash:{},data:d}))+'</div>\n\n              <div class="small hide-sm">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.title:e,a))+'</div>\n              <div class="show-sm">\n                <div class="h12 show-sm m5">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.speaker:e,a))+'</div>\n                <div class="h9 m5">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.title:e,a))+'</div>\n                <div class="show-sm">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=(e=null!=a?a.nextTalk:a)?e.duration:e,{name:"formatDuration",hash:{},data:d}))+"</div>\n              </div>\n            </a>\n          </div>\n\n"+(null!=(e=b.each.call(a,null!=a?a.relatedTalks:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"        </div>\n\n      </div>\n    </div>\n  </div>\n</div>\n"},useData:!0});return b.registerPartial("templates/talk-countdown-checker",c),c}),define("hbs!templates/talk-countdown-timer",["hbs","hbs/handlebars","templates/helpers/thumb","templates/helpers/formatDuration"],function(a,b){var c=b.template({1:function(a,b,c,d){var e,f;return'            <div class="col col-oh-6 col-lg-4 '+(null!=(e=b.unless.call(a,d&&d.index,{name:"unless",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:"")+'">\n              <a class="ga-link undec Talk-countdown-timer__talk" href="/talks/'+this.escapeExpression((f=null!=(f=b.slug||(null!=a?a.slug:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"slug",hash:{},data:d}):f))+'" data-ga-category="talk.countdownTalk">\n                <div class="m3">'+this.escapeExpression((b.thumb||a&&a.thumb||b.helperMissing).call(a,null!=a?a.image:a,{name:"thumb",hash:{},data:d}))+'</div>\n                <div class="h12 Talk-countdown-timer__talk__speaker show-sm">'+this.escapeExpression((f=null!=(f=b.speaker||(null!=a?a.speaker:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"speaker",hash:{},data:d}):f))+'</div>\n                <div class="Talk-countdown-timer__talk__title">'+this.escapeExpression((f=null!=(f=b.title||(null!=a?a.title:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"title",hash:{},data:d}):f))+'</div>\n                <div class="Talk-countdown-timer__talk__duration show-sm">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=a?a.duration:a,{name:"formatDuration",hash:{},data:d}))+"</div>\n              </a>\n            </div>\n"},2:function(a,b,c,d){return"col-lg-offset-1"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="talk-end-card Talk-countdown-timer inverse">\n\n  <div class="container Talk-countdown-timer__container Talk-countdown-timer__container--running">\n    <div class="row row-skinny row-lg-wide">\n      <div class="col col-sm-4">\n        <div class="Talk-countdown-timer__heading">\n          Playing next in\n          <span class="Talk-countdown-timer__remaining">10</span>\n\n          <a class="Talk-countdown-timer__cancel undec" href="#">Cancel</a>\n        </div>\n\n        <div class="Talk-countdown-timer__progress Talk-countdown-timer__progress--top show-lg">\n          <div class="Talk-countdown-timer__progress__meter" style="width:100%"></div>\n        </div>\n      </div>\n    </div>\n\n    <div class="row row-skinny row-lg-wide m3">\n      <div class="col col-oh-4">\n        <a class="ga-link undec" href="/talks/'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.slug:e,a))+'" data-ga-category="talk.countdownTalk">\n          '+this.escapeExpression((b.thumb||a&&a.thumb||b.helperMissing).call(a,null!=(e=null!=a?a.nextTalk:a)?e.image:e,{name:"thumb",hash:{},data:d}))+'\n        </a>\n      </div>\n\n      <div class="col col-oh-8">\n        <a class="ga-link undec Talk-countdown-timer__talk Talk-countdown-timer__talk--next" href="/talks/'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.slug:e,a))+'" data-ga-category="talk.countdownTalk">\n          <div class="h12 m5 Talk-countdown-timer__talk__speaker">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.speaker:e,a))+'</div>\n          <div class="h6 m4 Talk-countdown-timer__talk__title">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.title:e,a))+'</div>\n          <div class="h11 Talk-countdown-timer__talk__duration show-sm">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=(e=null!=a?a.nextTalk:a)?e.duration:e,{name:"formatDuration",hash:{},data:d}))+'</div>\n        </a>\n      </div>\n    </div>\n\n    <div class="Talk-countdown-timer__progress hide-lg">\n      <div class="Talk-countdown-timer__progress__meter" style="width:100%"></div>\n    </div>\n  </div>\n\n  <div class="container Talk-countdown-timer__container Talk-countdown-timer__container--canceled">\n    <h2 class="Talk-countdown-timer__heading hide-lg">Related talks</h2>\n\n    <div class="row row-skinny row-lg-wide">\n      <div class="col col-oh-4">\n        <h2 class="Talk-countdown-timer__heading show-lg">Up next</h2>\n\n        <a class="ga-link undec Talk-countdown-timer__talk" href="/talks/'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.slug:e,a))+'" data-ga-category="talk.countdownTalk">\n          <div class="m3">'+this.escapeExpression((b.thumb||a&&a.thumb||b.helperMissing).call(a,null!=(e=null!=a?a.nextTalk:a)?e.image:e,{name:"thumb",hash:{},data:d}))+'</div>\n          <div class="h12 Talk-countdown-timer__talk__speaker show-sm">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.speaker:e,a))+'</div>\n          <div class="Talk-countdown-timer__talk__title">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.nextTalk:a)?e.title:e,a))+'</div>\n          <div class="Talk-countdown-timer__talk__duration show-sm">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=(e=null!=a?a.nextTalk:a)?e.duration:e,{name:"formatDuration",hash:{},data:d}))+'</div>\n        </a>\n      </div>\n\n      <div class="col col-oh-8">\n        <div class="row row-skinny row-lg-wide show-lg">\n          <div class="col col-lg-offset-1">\n            <h2 class="Talk-countdown-timer__heading">More related talks</h2>\n          </div>\n        </div>\n\n        <div class="row row-skinny row-lg-wide">\n'+(null!=(e=b.each.call(a,null!=a?a.relatedTalks:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"        </div>\n      </div>\n    </div>\n  </div>\n\n</div>\n"},useData:!0});return b.registerPartial("templates/talk-countdown-timer",c),c}),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},b=[].slice;!function(a,b){return"function"==typeof define&&define.amd?define("waypoints",["jquery"],function(c){return b(c,a)}):b(a.jQuery,a)}(this,function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return e=c(d),l=a.call(d,"ontouchstart")>=0,h={horizontal:{},vertical:{}},i=1,k={},j="waypoints-context-id",o="resize.waypoints",p="scroll.waypoints",q=1,r="waypoints-waypoint-ids",s="waypoint",t="waypoints",f=function(){function a(a){var b=this;this.$element=a,this.element=a[0],this.didResize=!1,this.didScroll=!1,this.id="context"+i++,this.oldScroll={x:a.scrollLeft(),y:a.scrollTop()},this.waypoints={horizontal:{},vertical:{}},this.element[j]=this.id,k[this.id]=this,a.bind(p,function(){var a;return b.didScroll||l?void 0:(b.didScroll=!0,a=function(){return b.doScroll(),b.didScroll=!1},d.setTimeout(a,c[t].settings.scrollThrottle))}),a.bind(o,function(){var a;return b.didResize?void 0:(b.didResize=!0,a=function(){return c[t]("refresh"),b.didResize=!1},d.setTimeout(a,c[t].settings.resizeThrottle))})}return a.prototype.doScroll=function(){var a,b=this;return a={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!l||a.vertical.oldScroll&&a.vertical.newScroll||c[t]("refresh"),c.each(a,function(a,d){var e,f,g;return g=[],f=d.newScroll>d.oldScroll,e=f?d.forward:d.backward,c.each(b.waypoints[a],function(a,b){var c,e;return d.oldScroll<(c=b.offset)&&c<=d.newScroll?g.push(b):d.newScroll<(e=b.offset)&&e<=d.oldScroll?g.push(b):void 0}),g.sort(function(a,b){return a.offset-b.offset}),f||g.reverse(),c.each(g,function(a,b){return b.options.continuous||a===g.length-1?b.trigger([e]):void 0})}),this.oldScroll={x:a.horizontal.newScroll,y:a.vertical.newScroll}},a.prototype.refresh=function(){var a,b,d,e=this;return d=c.isWindow(this.element),b=this.$element.offset(),this.doScroll(),a={horizontal:{contextOffset:d?0:b.left,contextScroll:d?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:d?0:b.top,contextScroll:d?0:this.oldScroll.y,contextDimension:d?c[t]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},c.each(a,function(a,b){return c.each(e.waypoints[a],function(a,d){var e,f,g,h,i;return e=d.options.offset,g=d.offset,f=c.isWindow(d.element)?0:d.$element.offset()[b.offsetProp],c.isFunction(e)?e=e.apply(d.element):"string"==typeof e&&(e=parseFloat(e),d.options.offset.indexOf("%")>-1&&(e=Math.ceil(b.contextDimension*e/100))),d.offset=f-b.contextOffset+b.contextScroll-e,d.options.onlyOnScroll&&null!=g||!d.enabled?void 0:null!==g&&g<(h=b.oldScroll)&&h<=d.offset?d.trigger([b.backward]):null!==g&&g>(i=b.oldScroll)&&i>=d.offset?d.trigger([b.forward]):null===g&&b.oldScroll>=d.offset?d.trigger([b.forward]):void 0})})},a.prototype.checkEmpty=function(){return c.isEmptyObject(this.waypoints.horizontal)&&c.isEmptyObject(this.waypoints.vertical)?(this.$element.unbind([o,p].join(" ")),delete k[this.id]):void 0},a}(),g=function(){function a(a,b,d){var e,f;d=c.extend({},c.fn[s].defaults,d),"bottom-in-view"===d.offset&&(d.offset=function(){var a;return a=c[t]("viewportHeight"),c.isWindow(b.element)||(a=b.$element.height()),a-c(this).outerHeight()}),this.$element=a,this.element=a[0],this.axis=d.horizontal?"horizontal":"vertical",this.callback=d.handler,this.context=b,this.enabled=d.enabled,this.id="waypoints"+q++,this.offset=null,this.options=d,b.waypoints[this.axis][this.id]=this,h[this.axis][this.id]=this,e=null!=(f=this.element[r])?f:[],e.push(this.id),this.element[r]=e}return a.prototype.trigger=function(a){return this.enabled?(null!=this.callback&&this.callback.apply(this.element,a),this.options.triggerOnce?this.destroy():void 0):void 0},a.prototype.disable=function(){return this.enabled=!1},a.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},a.prototype.destroy=function(){return delete h[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},a.getWaypointsByElement=function(a){var b,d;return(d=a[r])?(b=c.extend({},h.horizontal,h.vertical),c.map(d,function(a){return b[a]})):[]},a}(),n={init:function(a,b){var d;return null==b&&(b={}),null==(d=b.handler)&&(b.handler=a),this.each(function(){var a,d,e,h;return a=c(this),e=null!=(h=b.context)?h:c.fn[s].defaults.context,c.isWindow(e)||(e=a.closest(e)),e=c(e),d=k[e[0][j]],d||(d=new f(e)),new g(a,d,b)}),c[t]("refresh"),this},disable:function(){return n._invoke.call(this,"disable")},enable:function(){return n._invoke.call(this,"enable")},destroy:function(){return n._invoke.call(this,"destroy")},prev:function(a,b){return n._traverse.call(this,a,b,function(a,b,c){return b>0?a.push(c[b-1]):void 0})},next:function(a,b){return n._traverse.call(this,a,b,function(a,b,c){return b<c.length-1?a.push(c[b+1]):void 0})},_traverse:function(a,b,e){var f,g;return null==a&&(a="vertical"),null==b&&(b=d),g=m.aggregate(b),f=[],this.each(function(){var b;return b=c.inArray(this,g[a]),e(f,b,g[a])}),this.pushStack(f)},_invoke:function(a){return this.each(function(){var b;return b=g.getWaypointsByElement(this),c.each(b,function(b,c){return c[a](),!0})}),this}},c.fn[s]=function(){var a,d;return d=arguments[0],a=2<=arguments.length?b.call(arguments,1):[],n[d]?n[d].apply(this,a):c.isFunction(d)?n.init.apply(this,arguments):c.isPlainObject(d)?n.init.apply(this,[null,d]):d?c.error("The "+d+" method does not exist in jQuery Waypoints."):c.error("jQuery Waypoints needs a callback function or handler option.");
},c.fn[s].defaults={context:d,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},m={refresh:function(){return c.each(k,function(a,b){return b.refresh()})},viewportHeight:function(){var a;return null!=(a=d.innerHeight)?a:e.height()},aggregate:function(a){var b,d,e;return b=h,a&&(b=null!=(e=k[c(a)[0][j]])?e.waypoints:void 0),b?(d={horizontal:[],vertical:[]},c.each(d,function(a,e){return c.each(b[a],function(a,b){return e.push(b)}),e.sort(function(a,b){return a.offset-b.offset}),d[a]=c.map(e,function(a){return a.element}),d[a]=c.unique(d[a])}),d):[]},above:function(a){return null==a&&(a=d),m._filter(a,"vertical",function(a,b){return b.offset<=a.oldScroll.y})},below:function(a){return null==a&&(a=d),m._filter(a,"vertical",function(a,b){return b.offset>a.oldScroll.y})},left:function(a){return null==a&&(a=d),m._filter(a,"horizontal",function(a,b){return b.offset<=a.oldScroll.x})},right:function(a){return null==a&&(a=d),m._filter(a,"horizontal",function(a,b){return b.offset>a.oldScroll.x})},enable:function(){return m._invoke("enable")},disable:function(){return m._invoke("disable")},destroy:function(){return m._invoke("destroy")},extendFn:function(a,b){return n[a]=b},_invoke:function(a){var b;return b=c.extend({},h.vertical,h.horizontal),c.each(b,function(b,c){return c[a](),!0})},_filter:function(a,b,d){var e,f;return(e=k[c(a)[0][j]])?(f=[],c.each(e.waypoints[b],function(a,b){return d(e,b)?f.push(b):void 0}),f.sort(function(a,b){return a.offset-b.offset}),c.map(f,function(a){return a.element})):[]}},c[t]=function(){var a,c;return c=arguments[0],a=2<=arguments.length?b.call(arguments,1):[],m[c]?m[c].apply(null,a):m.aggregate.call(null,c)},c[t].settings={resizeThrottle:100,scrollThrottle:30},e.load(function(){return c[t]("refresh")})})}.call(this),define("talk/countdown",["jquery","lodash","lib/ga","lib/instaplay","hbs!templates/talk-countdown-checker","hbs!templates/talk-countdown-timer","exports","waypoints"],function(a,b,c,d,e,f,g){"use strict";g.countdownPeriod=1e4,g.maxInstaplays=3;var h=g._cache={};g.checkerTemplate=e,g.timerTemplate=b.wrap(f,function(a,b){return h.renderedTimer=!0,a(b)}),g.startCountdown=function(){h.renderedTimer&&(g._initCountdown(),h.targetDate||(h.targetDate=new Date(+new Date+g.countdownPeriod)))},g.pauseCountdown=function(){h.targetDate=null},g.cancelCountdown=function(){h.targetDate=null,h.intervalId&&window.clearInterval(h.intervalId),h.$timer.addClass("Talk-countdown-timer--canceled")},g.countdownInterval=function(){if(h.targetDate){var a=h.targetDate-new Date;0>=a?(g.countdownStep(0),g.countdownReached()):g.countdownStep(a)}},g.countdownStep=function(a){h.$meter.css({width:a/g.countdownPeriod*100+"%"}),h.$remaining.text(a>0?Math.round(a/1e3):"0")},g.countdownReached=function(){h.targetDate=null;var a=h.$timer.find("a.Talk-countdown-timer__talk--next").attr("href");c.sendEvent("talk.countdownTalk","force",a),d.set(a,{clearHistory:!1}),window.location.href=a},g.hasMaxed=function(){return d.recentMatches(/\/talks\//).length>=g.maxInstaplays},g.getNext=function(a){if(a&&a.length){var b=d.recentMatches(/\/talks\//);if(!b.length)return a[0];for(var c=0,e=a.length;e>c;c++){for(var f=a[c],g=new RegExp("/talks/"+f.slug),h=!0,i=0,j=b.length;j>i;i++)h=h&&!b[i].match(g);if(h)return f}}},g.template=function(a){return g.hasMaxed()?g.checkerTemplate(a):g.timerTemplate(a)},g._initCountdown=function(){if(!h.initedCounter){h.initedCounter=!0;var b=a("div.Talk-countdown-timer");h.$timer=b,h.$remaining=b.find("span.Talk-countdown-timer__remaining"),h.$meter=b.find("div.Talk-countdown-timer__progress__meter"),h.$remaining.waypoint(function(a){"up"===a?g.startCountdown():g.pauseCountdown()}),h.intervalId=window.setInterval(g.countdownInterval,100),b.find("a.Talk-countdown-timer__cancel").click(function(a){a.preventDefault(),g.cancelCountdown()})}}}),define("utils/query_param",[],function(){"use strict";return function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}}),define("hbs!templates/talkArticle",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'<div class="talk-article">\n  <div class="container">\n    <div class="talk-article__container">\n    </div>\n  </div>\n</div>\n'},useData:!0});return b.registerPartial("templates/talkArticle",c),c}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("spinjs",b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=k.substring(0,k.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return m[e]||(n.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",n.cssRules.length),m[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<l.length;d++)if(c=l[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a){for(var b={x:a.offsetLeft,y:a.offsetTop};a=a.offsetParent;)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}function h(a,b){return"string"==typeof a?a:a[b%a.length]}function i(a){return"undefined"==typeof this?new i(a):void(this.opts=f(a||{},i.defaults,o))}function j(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}n.addRule(".spin-vml","behavior:url(#default#VML)"),i.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function g(a,g,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~g}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:h(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)g(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)g(i);return b(a,m)},i.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var k,l=["webkit","Moz","ms","O"],m={},n=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),o={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};i.defaults={},f(i.prototype,{spin:function(b){this.stop();var c,d,f=this,h=f.opts,i=f.el=e(a(0,{className:h.className}),{position:h.position,width:0,zIndex:h.zIndex}),j=h.radius+h.length+h.width;if(b&&(b.insertBefore(i,b.firstChild||null),d=g(b),c=g(i),e(i,{left:("auto"==h.left?d.x-c.x+(b.offsetWidth>>1):parseInt(h.left,10)+j)+"px",top:("auto"==h.top?d.y-c.y+(b.offsetHeight>>1):parseInt(h.top,10)+j)+"px"})),i.setAttribute("role","progressbar"),f.lines(i,f.opts),!k){var l,m=0,n=(h.lines-1)*(1-h.direction)/2,o=h.fps,p=o/h.speed,q=(1-h.opacity)/(p*h.trail/100),r=p/h.lines;!function s(){m++;for(var a=0;a<h.lines;a++)l=Math.max(1-(m+(h.lines-a)*r)%p*q,h.opacity),f.opacity(i,a*h.direction+n,l,h);f.timeout=f.el&&setTimeout(s,~~(1e3/o))}()}return f},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function g(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*j+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,j=0,l=(f.lines-1)*(1-f.direction)/2;j<f.lines;j++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:k&&c(f.opacity,f.trail,l+j*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(g("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,g(h(f.color,j),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var p=e(a("group"),{behavior:"url(#default#VML)"});return!d(p,"transform")&&p.adj?j():k=d(p,"animation"),i}),define("jqueryui/widget",["jquery"],function(a){return function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){return this._createWidget?void(arguments.length&&this._createWidget(a,b)):new g(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){return a.isFunction(d)?void(i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()):void(i[b]=d)}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(a.isPlainObject(f)?c[e]=a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):c[e]=f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){return b||f.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof g?f[g]:g).apply(f,arguments):void 0}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(a),a}),define("transit",["jquery"],function(a){return function(a){function b(a){if(a in l.style)return a;var b=["Moz","Webkit","O","ms"],c=a.charAt(0).toUpperCase()+a.substr(1);if(a in l.style)return a;for(var d=0;d<b.length;++d){var e=b[d]+c;if(e in l.style)return e}}function c(){return l.style[m.transform]="",l.style[m.transform]="rotateY(90deg)",""!==l.style[m.transform]}function d(a){return"string"==typeof a&&this.parse(a),this}function e(a,b,c){b===!0?a.queue(c):b?a.queue(b,c):c()}function f(b){var c=[];return a.each(b,function(b){b=a.camelCase(b),b=a.transit.propertyMap[b]||a.cssProps[b]||b,b=i(b),-1===a.inArray(b,c)&&c.push(b)}),c}function g(b,c,d,e){var g=f(b);a.cssEase[d]&&(d=a.cssEase[d]);var h=""+k(c)+" "+d;parseInt(e,10)>0&&(h+=" "+k(e));var i=[];return a.each(g,function(a,b){i.push(b+" "+h)}),i.join(", ")}function h(b,c){c||(a.cssNumber[b]=!0),a.transit.propertyMap[b]=m.transform,a.cssHooks[b]={get:function(c){var d=a(c).css("transit:transform");return d.get(b)},set:function(c,d){var e=a(c).css("transit:transform");e.setFromString(b,d),a(c).css({"transit:transform":e})}}}function i(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function j(a,b){return"string"!=typeof a||a.match(/^[\-0-9\.]+$/)?""+a+b:a}function k(b){var c=b;return a.fx.speeds[c]&&(c=a.fx.speeds[c]),j(c,"ms")}a.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:!0,useTransitionEnd:!1};var l=document.createElement("div"),m={},n=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;m.transition=b("transition"),m.transitionDelay=b("transitionDelay"),m.transform=b("transform"),m.transformOrigin=b("transformOrigin"),m.transform3d=c();var o={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"},p=m.transitionEnd=o[m.transition]||null;for(var q in m)m.hasOwnProperty(q)&&"undefined"==typeof a.support[q]&&(a.support[q]=m[q]);l=null,a.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"},a.cssHooks["transit:transform"]={get:function(b){return a(b).data("transform")||new d},set:function(b,c){var e=c;e instanceof d||(e=new d(e)),"WebkitTransform"!==m.transform||n?b.style[m.transform]=e.toString():b.style[m.transform]=e.toString(!0),a(b).data("transform",e)}},a.cssHooks.transform={set:a.cssHooks["transit:transform"].set},a.fn.jquery<"1.8"&&(a.cssHooks.transformOrigin={get:function(a){return a.style[m.transformOrigin]},set:function(a,b){a.style[m.transformOrigin]=b}},a.cssHooks.transition={get:function(a){return a.style[m.transition]},set:function(a,b){a.style[m.transition]=b}}),h("scale"),h("translate"),h("rotate"),h("rotateX"),h("rotateY"),h("rotate3d"),h("perspective"),h("skewX"),h("skewY"),h("x",!0),h("y",!0),d.prototype={setFromString:function(a,b){var c="string"==typeof b?b.split(","):b.constructor===Array?b:[b];c.unshift(a),d.prototype.set.apply(this,c)},set:function(a){var b=Array.prototype.slice.apply(arguments,[1]);this.setter[a]?this.setter[a].apply(this,b):this[a]=b.join(",")},get:function(a){return this.getter[a]?this.getter[a].apply(this):this[a]||0},setter:{rotate:function(a){this.rotate=j(a,"deg")},rotateX:function(a){this.rotateX=j(a,"deg")},rotateY:function(a){this.rotateY=j(a,"deg")},scale:function(a,b){void 0===b&&(b=a),this.scale=a+","+b},skewX:function(a){this.skewX=j(a,"deg")},skewY:function(a){this.skewY=j(a,"deg")},perspective:function(a){this.perspective=j(a,"px")},x:function(a){this.set("translate",a,null)},y:function(a){this.set("translate",null,a)},translate:function(a,b){void 0===this._translateX&&(this._translateX=0),void 0===this._translateY&&(this._translateY=0),null!==a&&void 0!==a&&(this._translateX=j(a,"px")),null!==b&&void 0!==b&&(this._translateY=j(b,"px")),this.translate=this._translateX+","+this._translateY}},getter:{x:function(){return this._translateX||0},y:function(){return this._translateY||0},scale:function(){var a=(this.scale||"1,1").split(",");return a[0]&&(a[0]=parseFloat(a[0])),a[1]&&(a[1]=parseFloat(a[1])),a[0]===a[1]?a[0]:a},rotate3d:function(){for(var a=(this.rotate3d||"0,0,0,0deg").split(","),b=0;3>=b;++b)a[b]&&(a[b]=parseFloat(a[b]));return a[3]&&(a[3]=j(a[3],"deg")),a}},parse:function(a){var b=this;a.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(a,c,d){b.setFromString(c,d)})},toString:function(a){var b=[];for(var c in this)if(this.hasOwnProperty(c)){if(!m.transform3d&&("rotateX"===c||"rotateY"===c||"perspective"===c||"transformOrigin"===c))continue;"_"!==c[0]&&(a&&"scale"===c?b.push(c+"3d("+this[c]+",1)"):a&&"translate"===c?b.push(c+"3d("+this[c]+",0)"):b.push(c+"("+this[c]+")"))}return b.join(" ")}},a.fn.transition=a.fn.transit=function(b,c,d,f){var h=this,i=0,j=!0;"function"==typeof c&&(f=c,c=void 0),"function"==typeof d&&(f=d,d=void 0),"undefined"!=typeof b.easing&&(d=b.easing,delete b.easing),"undefined"!=typeof b.duration&&(c=b.duration,delete b.duration),"undefined"!=typeof b.complete&&(f=b.complete,delete b.complete),"undefined"!=typeof b.queue&&(j=b.queue,delete b.queue),"undefined"!=typeof b.delay&&(i=b.delay,delete b.delay),"undefined"==typeof c&&(c=a.fx.speeds._default),"undefined"==typeof d&&(d=a.cssEase._default),c=k(c);var l=g(b,c,d,i),n=a.transit.enabled&&m.transition,o=n?parseInt(c,10)+parseInt(i,10):0;if(0===o){var q=function(a){h.css(b),f&&f.apply(h),a&&a()};return e(h,j,q),h}var r={},s=function(c){var d=!1,e=function(){d&&h.unbind(p,e),o>0&&h.each(function(){this.style[m.transition]=r[this]||null}),"function"==typeof f&&f.apply(h),"function"==typeof c&&c()};o>0&&p&&a.transit.useTransitionEnd?(d=!0,h.bind(p,e)):window.setTimeout(e,o),h.each(function(){o>0&&(this.style[m.transition]=l),a(this).css(b)})},t=function(a){var b=0;"MozTransition"===m.transition&&25>b&&(b=25),window.setTimeout(function(){s(a)},b)};return e(h,j,t),this},a.transit.getTransitionValue=g}(a),a}),define("widgets/talkArticle",["jquery","lodash","jqueryui/widget","transit"],function(a,b){"use strict";function c(){f.show(),f.removeClass(k)}function d(){f.hide()}var e,f,g,h,i,j=300,k="talk-article--main--collapsed",l=b.once(function(){e=a("#talk-pusher"),f=a("#talk"),g=a("body,html"),h=a("#player-hero"),i=h.find("div.player-hero__banner")});return a.widget("ted.talkArticle",{options:{autoShow:!0},_create:function(){var a=this;l(),this.element.hide(),f.after(this.element),this._on("a.talk-article__return__link",{click:function(b){b.preventDefault(),a.hide()}}),this.options.autoShow&&this.show()},show:function(){this.element.fadeIn(j),f.addClass(k),e.transition({duration:j,marginTop:0-f.outerHeight(),complete:d}),g.animate({scrollTop:i.offset().top+i.outerHeight()},j),this._trigger("show")},hide:function(){this.element.fadeOut(j),f.show(),e.transition({duration:j,marginTop:0,complete:c}),this._trigger("hide")}}),function(b,c){return a(b).talkArticle(c)}}),define("widgets/talkArticleLink",["jquery","lodash","hbs!templates/talkArticle","spinjs","widgets/talkArticle"],function(a,b,c,d){"use strict";var e="talk-article-link",f="talk-article-link--loading";return a.widget("ted.talkArticleLink",{options:{articleUrl:null,returnUrl:window.location.href,unpopped:!1},_create:function(){var a=this;this.options.articleUrl||(this.options.articleUrl=this.element.attr("href")),this.element.addClass(e),this._on(this.element,this._handleEvents),this._on(window,{popstate:function(){a.options.unpopped&&(a.options.unpopped=!1,a.article.talkArticle("hide"))}})},_handleEvents:{click:function(a){a.preventDefault(),this.showArticle()}},_onShow:function(){this._trigger("show")},_onHide:function(){window.history&&history.pushState&&this.options.unpopped&&(this.options.unpopped=!1,history.back()),this._trigger("hide")},article:null,loadUrl:function(e){var g=this;g.article&&g.article.remove();var h=a(c());h.addClass("talk-article--loading"),g.article=h,g.article.talkArticle({show:b.bind(g._onShow,g),hide:b.bind(g._onHide,g)}),this.article.talkArticle("show"),this._spinner||(this._spinner=new d),this._spinner.spin(g.article.find("div.talk-article__container")[0]),this.options.articleUrl=e,this.element.addClass(f),e+=(e.match(/\?/)?"&":"?")+"talkarticle=true",a.get(e).then(b.bind(this.loadHtml,this))},loadHtml:function(c){var d=!0,e=this;window.history&&window.history.pushState&&!e.options.unpopped&&(d=!1),e.article&&(this._spinner.stop(),e.article.remove()),e.article=a(c).find("div.talk-article"),e.article.talkArticle({autoShow:d,show:b.bind(e._onShow,e),hide:b.bind(e._onHide,e)}),e.element.removeClass(f)},showArticle:function(){var a=this;a.element.hasClass(f)||(this.article?this.article.talkArticle("show"):this.loadUrl(this.options.articleUrl),window.history&&history.pushState&&(history.pushState(null,null,this.options.articleUrl),this.options.unpopped=!0))}}),function(b,c){return a(b).talkArticle(c)}}),define("talk/transcript",["jquery","lodash","lib/ga","widgets/talkArticleLink"],function(a,b,c){"use strict";function d(a){var c,d;return c=b.findIndex(s,function(b){return d=b===a,d||b>a}),1>c&&!d?!1:q.eq(c-(d?0:1))}function e(){var b=+a(this).data("time"),d=Math.floor((r.offset+b)/1e3);w.player&&(w.player.player("seek",d),c.sendEvent("player","seek","transcript",d)),window.history&&history.pushState&&history.pushState(null,null,location.href.split("#")[0]+"#t-"+b)}function f(a){var b=d(a);b&&b!==o&&(o&&(o.removeClass(t),p.removeClass(u)),o=b.addClass(t),p=b.closest("p.talk-transcript__para").addClass(u))}function g(a){a||(a=v),f(1e3*a-r.offset),v=a}function h(){m||(m=a("div.talk-transcript").first()),q=m.find("span.talk-transcript__fragment"),s=q.map(function(b,c){return+a(c).data("time")}).toArray(),m.on("click","span.talk-transcript__fragment",e),w.player&&w.player.on("playercurrenttime",function(a,b){g(b.currentTime)}),g()}function i(){m&&m.parent().length||(m=n.data("ted-talkArticleLink").article,h())}function j(){i()}function k(){a(document).on("change","select.talk-transcript__language",function(){var b=a(this),c="/talks/"+b.data("slug")+"/transcript?language="+b.val();n?n.talkArticleLink("loadUrl",c):location.href=c})}function l(b){r=b,n=a("#open-transcript"),k(),n.talkArticleLink({show:j}),n.on("click",function(){c.sendEvent("talk.transcript","show","talk details")}),a("#hero-transcript-link").on("click",function(a){a.preventDefault(),n.data("ted-talkArticleLink").showArticle(),c.sendEvent("talk.transcript","show","hero")}),a("#player-hero").on("click","a.controls__transcript",function(a){a.preventDefault(),n.data("ted-talkArticleLink").showArticle(),c.sendEvent("talk.transcript","show","controls")})}var m,n,o,p,q,r,s,t="talk-transcript__fragment--current",u="talk-transcript__para--current",v=0,w={player:null};return w.initArticle=h,w.initLanguages=b.once(k),w.initLink=l,w}),define("widgets/ad",["lodash","jquery","jqueryui/widget"],function(a,b){"use strict";b.widget("ted.ad",{_rendered:!1,$image:null,$text:null,$link:null,blocked:function(){this.element.hide()},refreshJsonAd:function(){if(this.options.blocked)return void this.blocked();if(this._rendered||(this._addAdClass(),this.element.children().addClass("ad__prefill"),this.options.ad.houseAd||this._getAppreciationText().appendTo(this.element),this.$link=b('<a class="ad__unit" href="#" rel="nofollow" target="_blank">').appendTo(this.element),this.$image=b("<img>").appendTo(this.$link),this._rendered=!0),!this.options.ad)return void this.element.hide();var a=this._getRenderDetails();this.$link.attr("href",a.click),this.$image.attr({src:a.currentCreative.url,width:a.dimensions.width,height:a.dimensions.height}),this.element[this.options.ad.hasDisplay===!1?"hide":"show"](),this._impress()},refreshHtmlAd:function(){this._addAdClass(),this._getAppreciationText().prependTo(this.element)},_init:function(){var a=String(this.options.mode);this._rendered=!1,"json"===a?this.refreshJsonAd():"html"===a&&this.refreshHtmlAd()},_fireImpression:function(a){var b=new Image;b.src=a},_impress:function(){this._fireImpression(this.options.ad.impression),a.forEach(this.options.ad.thirdPartyImpressions,this._fireImpression)},_getCreative:function(){var b=a.filter(this.options.ad.creative,function(a){return""!==a.url}),c=Math.max(window.devicePixelRatio||1,1);return a.reduce(b,function(a,b){return b.density<=c?b:a||b},{})},_getRenderDetails:function(){return a.extend({currentCreative:this._getCreative()},this.options.ad)},_getAppreciationText:function(){return this.$text=b('<div class="ad__text">TED Talks are free thanks to support from</div>'),this.$text},_addAdClass:function(){this.element.addClass("ad")}})}),define("hbs!templates/sponsorshipBug",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<a class="sponsorship-bug__link media" href="#" rel="nofollow" target="_blank">\n  <div class="sponsorship-bug__image media__image media__image--alt">\n    <img src="" alt="">\n  </div>\n  <div class="sponsorship-bug__message media__message">\n    TED Talks are free<br>\n    thanks to support from\n  </div>\n</a>\n'},useData:!0});return b.registerPartial("templates/sponsorshipBug",c),c}),define("templates/helpers/assetUrl",["Handlebars"],function(a){"use strict";function b(a){return TED.assetHost+a}return a.registerHelper("assetUrl",b),b}),define("hbs!templates/sponsorshipBugBlocked",["hbs","hbs/handlebars","templates/helpers/assetUrl"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<a class="sponsorship-bug__nag" href="http://support.ted.com/customer/portal/articles/1532436-how-can-i-support-ted-by-modifying-my-ad-blocker-settings" target="_blank">\n  <img class="sponsorship-bug__nag__image" src="'+this.escapeExpression((b.assetUrl||a&&a.assetUrl||b.helperMissing).call(a,"/temp/ad-blocker-bug.png",{name:"assetUrl",hash:{},data:d}))+'" alt="Show your support by unblocking ted.com from ad blockers">\n</a>\n'},useData:!0});return b.registerPartial("templates/sponsorshipBugBlocked",c),c}),define("widgets/sponsorshipBug",["jquery","hbs!templates/sponsorshipBug","hbs!templates/sponsorshipBugBlocked","widgets/ad"],function(a,b,c){"use strict";a.widget("ted.sponsorshipBug",a.ted.ad,{blocked:function(){this.element.html(c()),this.element.show(),this._rendered=!1},refreshJsonAd:function(){return this.options.blocked?this.blocked():(this._rendered||(this.element.children().addClass("sponsorship-bug__prefill"),this.element.append(b()),this.$image=this.element.find("img"),this.$link=this.element.find("a.sponsorship-bug__link"),this._rendered=!0),void this._super())},_init:function(){this.element.addClass("sponsorship-bug"),this._super()}})}),define("lib/ads",["jquery","lodash","utils/query_param","exports","widgets/ad","widgets/sponsorshipBug"],function(a,b,c,d){"use strict";function e(a){var b=new Image;b.src=a}function f(b){var c=String(b.type),d=l[b.type];"master"===c?m.deferred.resolve(b):void 0===d?window.console&&console.log&&(console.log("Unknown ad type"),console.log(b)):a(d.id)[d.widget]({ad:b,mode:"json"})}function g(c){b.forEach(m.companionAdSlots,function(b){if(b.gptSlot.setTargeting(b.key,c.target),b.displayed){var e=a("#"+b.containerId);e.data("tedAd")?e.ad("destroy"):e.data("sponsorshipBug")&&e.sponsorshipBug("destroy"),d.refreshAd(b.gptSlot)}else d.displayAd(b.containerId);b.displayed=!0}),e(c.impression)}function h(a){return a.replace("{adUnit}",m.slot.adUnit)}function i(a){d.player.player("sendAds",{postroll:h(a.postrollURL),preroll:h(a.prerollURL)})}function j(b){var c=d.player=b;if(c){
var e=d.playerMode=String(c.player("mode"));if("hls"===e)c.on({playerad:function(a,b){f(b.ad)}});else{m.deferred.done(g),c.on({playeradblock:function(){var b=l.bug;a(b.id)[b.widget]({blocked:!0})}});var h=!0;c.on({playertalk:function(a,b){var f=String(c.player("talks")[0].id),g=String(b.id);h&&f===g?(h=!1,"flash"===e&&m.deferred.done(i)):d.refreshMasterAd({targeting:b.targeting}),h=!1}})}}}function k(){b.forEach(m.slot.targeting,function(a,c){m.slot.gptSlot.setTargeting(c,b.isArray(a)?a.join(","):a)});var a=c("dfptest");a&&m.slot.gptSlot.setTargeting("dfptest",a)}var l={bug:{id:"#sponsorship-bug-placeholder",widget:"sponsorshipBug"},companion:{id:"#ad-unit",widget:"ad"},"companion-mobile":{id:"#ad-unit-mobile",widget:"ad"},devil:{id:"#devil-ad",widget:"ad"},onPage:{id:"#ad-unit",widget:"ad"}},m={companionAdSlots:[],deferred:a.Deferred(),slot:{adUnit:null,containerId:null,gptSlot:null,targeting:{}}};d._masterAd=m,d.player=null,window.googletag=window.googletag||{cmd:[]},d.slotRenderEndedHandler=function(c){var d=b.find(m.companionAdSlots,function(a){return a.gptSlot===c.slot});if(!c.isEmpty&&d){var e=String(d.containerId);if("ad-unit"===e){var f=a("#ad-unit"),g=f.data("tedAd");g||f.ad({mode:"html"})}}},d.displayMasterAd=function(a){m.slot.containerId=a.containerId,m.slot.adUnit=a.adUnit,window.googletag.cmd.push(function(){m.slot.gptSlot=googletag.defineOutOfPageSlot(m.slot.adUnit,m.slot.containerId).addService(googletag.pubads()),b.assign(m.slot.targeting,a.targeting),k(),d.displayAd(m.slot.containerId)})},d.refreshMasterAd=function(c){"hls"!==d.playerMode&&(m.deferred=a.Deferred(),m.deferred.done(g),"flash"===d.playerMode&&m.deferred.done(i),m.slot.gptSlot.clearTargeting(),b.forEach(m.companionAdSlots,function(a){a.gptSlot.clearTargeting()}),b.assign(m.slot.targeting,c.targeting),k(),d.refreshAd(m.slot.gptSlot))},d.displayAd=function(b){a(function(){window.googletag.cmd.push(function(){googletag.display(b)})})},d.refreshAd=function(a){window.googletag.cmd.push(function(){googletag.pubads().refresh([a])})},d.createCompanionSlot=function(a){window.googletag.cmd.push(function(){var b=googletag.defineSlot(a.adUnit,a.size,a.containerId).addService(googletag.pubads());m.companionAdSlots.push({containerId:a.containerId,gptSlot:b,key:a.key})})},d.initPlayer=j,d.gptAd=function(a){f(a.ad)},window.googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",d.slotRenderEndedHandler)})}),define("flot",["jquery"],function(a){return function(a){a.color={},a.color.make=function(b,c,d,e){var f={};return f.r=b||0,f.g=c||0,f.b=d||0,f.a=null!=e?e:1,f.add=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]+=b;return f.normalize()},f.scale=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]*=b;return f.normalize()},f.toString=function(){return f.a>=1?"rgb("+[f.r,f.g,f.b].join(",")+")":"rgba("+[f.r,f.g,f.b,f.a].join(",")+")"},f.normalize=function(){function a(a,b,c){return a>b?a:b>c?c:b}return f.r=a(0,parseInt(f.r),255),f.g=a(0,parseInt(f.g),255),f.b=a(0,parseInt(f.b),255),f.a=a(0,f.a,1),f},f.clone=function(){return a.color.make(f.r,f.b,f.g,f.a)},f.normalize()},a.color.extract=function(b,c){var d;do{if(d=b.css(c).toLowerCase(),""!=d&&"transparent"!=d)break;b=b.parent()}while(b.length&&!a.nodeName(b.get(0),"body"));return"rgba(0, 0, 0, 0)"==d&&(d="transparent"),a.color.parse(d)},a.color.parse=function(c){var d,e=a.color.make;if(d=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10));if(d=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(parseInt(d[1],10),parseInt(d[2],10),parseInt(d[3],10),parseFloat(d[4]));if(d=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return e(2.55*parseFloat(d[1]),2.55*parseFloat(d[2]),2.55*parseFloat(d[3]));if(d=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(c))return e(2.55*parseFloat(d[1]),2.55*parseFloat(d[2]),2.55*parseFloat(d[3]),parseFloat(d[4]));if(d=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return e(parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16));if(d=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return e(parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16));var f=a.trim(c).toLowerCase();return"transparent"==f?e(255,255,255,0):(d=b[f]||[0,0,0],e(d[0],d[1],d[2]))};var b={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(a),function(a){function b(b,c){var d=c.children("."+b)[0];if(null==d&&(d=document.createElement("canvas"),d.className=b,a(d).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(c),!d.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");d=window.G_vmlCanvasManager.initElement(d)}this.element=d;var e=this.context=d.getContext("2d"),f=window.devicePixelRatio||1,g=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;this.pixelRatio=f/g,this.resize(c.width(),c.height()),this.textContainer=null,this.text={},this._textCache={}}function c(c,e,f,g){function h(a,b){b=[qa].concat(b);for(var c=0;c<a.length;++c)a[c].apply(this,b)}function i(){for(var c={Canvas:b},d=0;d<g.length;++d){var e=g[d];e.init(qa,c),e.options&&a.extend(!0,ea,e.options)}}function j(b){a.extend(!0,ea,b),b&&b.colors&&(ea.colors=b.colors),null==ea.xaxis.color&&(ea.xaxis.color=a.color.parse(ea.grid.color).scale("a",.22).toString()),null==ea.yaxis.color&&(ea.yaxis.color=a.color.parse(ea.grid.color).scale("a",.22).toString()),null==ea.xaxis.tickColor&&(ea.xaxis.tickColor=ea.grid.tickColor||ea.xaxis.color),null==ea.yaxis.tickColor&&(ea.yaxis.tickColor=ea.grid.tickColor||ea.yaxis.color),null==ea.grid.borderColor&&(ea.grid.borderColor=ea.grid.color),null==ea.grid.tickColor&&(ea.grid.tickColor=a.color.parse(ea.grid.color).scale("a",.22).toString());var d,e,f,g=c.css("font-size"),i=g?+g.replace("px",""):13,j={style:c.css("font-style"),size:Math.round(.8*i),variant:c.css("font-variant"),weight:c.css("font-weight"),family:c.css("font-family")};for(f=ea.xaxes.length||1,d=0;f>d;++d)e=ea.xaxes[d],e&&!e.tickColor&&(e.tickColor=e.color),e=a.extend(!0,{},ea.xaxis,e),ea.xaxes[d]=e,e.font&&(e.font=a.extend({},j,e.font),e.font.color||(e.font.color=e.color),e.font.lineHeight||(e.font.lineHeight=Math.round(1.15*e.font.size)));for(f=ea.yaxes.length||1,d=0;f>d;++d)e=ea.yaxes[d],e&&!e.tickColor&&(e.tickColor=e.color),e=a.extend(!0,{},ea.yaxis,e),ea.yaxes[d]=e,e.font&&(e.font=a.extend({},j,e.font),e.font.color||(e.font.color=e.color),e.font.lineHeight||(e.font.lineHeight=Math.round(1.15*e.font.size)));for(ea.xaxis.noTicks&&null==ea.xaxis.ticks&&(ea.xaxis.ticks=ea.xaxis.noTicks),ea.yaxis.noTicks&&null==ea.yaxis.ticks&&(ea.yaxis.ticks=ea.yaxis.noTicks),ea.x2axis&&(ea.xaxes[1]=a.extend(!0,{},ea.xaxis,ea.x2axis),ea.xaxes[1].position="top"),ea.y2axis&&(ea.yaxes[1]=a.extend(!0,{},ea.yaxis,ea.y2axis),ea.yaxes[1].position="right"),ea.grid.coloredAreas&&(ea.grid.markings=ea.grid.coloredAreas),ea.grid.coloredAreasColor&&(ea.grid.markingsColor=ea.grid.coloredAreasColor),ea.lines&&a.extend(!0,ea.series.lines,ea.lines),ea.points&&a.extend(!0,ea.series.points,ea.points),ea.bars&&a.extend(!0,ea.series.bars,ea.bars),null!=ea.shadowSize&&(ea.series.shadowSize=ea.shadowSize),null!=ea.highlightColor&&(ea.series.highlightColor=ea.highlightColor),d=0;d<ea.xaxes.length;++d)q(ka,d+1).options=ea.xaxes[d];for(d=0;d<ea.yaxes.length;++d)q(la,d+1).options=ea.yaxes[d];for(var k in pa)ea.hooks[k]&&ea.hooks[k].length&&(pa[k]=pa[k].concat(ea.hooks[k]));h(pa.processOptions,[ea])}function k(a){da=l(a),r(),s()}function l(b){for(var c=[],d=0;d<b.length;++d){var e=a.extend(!0,{},ea.series);null!=b[d].data?(e.data=b[d].data,delete b[d].data,a.extend(!0,e,b[d]),b[d].data=e.data):e.data=b[d],c.push(e)}return c}function m(a,b){var c=a[b+"axis"];return"object"==typeof c&&(c=c.n),"number"!=typeof c&&(c=1),c}function n(){return a.grep(ka.concat(la),function(a){return a})}function o(a){var b,c,d={};for(b=0;b<ka.length;++b)c=ka[b],c&&c.used&&(d["x"+c.n]=c.c2p(a.left));for(b=0;b<la.length;++b)c=la[b],c&&c.used&&(d["y"+c.n]=c.c2p(a.top));return void 0!==d.x1&&(d.x=d.x1),void 0!==d.y1&&(d.y=d.y1),d}function p(a){var b,c,d,e={};for(b=0;b<ka.length;++b)if(c=ka[b],c&&c.used&&(d="x"+c.n,null==a[d]&&1==c.n&&(d="x"),null!=a[d])){e.left=c.p2c(a[d]);break}for(b=0;b<la.length;++b)if(c=la[b],c&&c.used&&(d="y"+c.n,null==a[d]&&1==c.n&&(d="y"),null!=a[d])){e.top=c.p2c(a[d]);break}return e}function q(b,c){return b[c-1]||(b[c-1]={n:c,direction:b==ka?"x":"y",options:a.extend(!0,{},b==ka?ea.xaxis:ea.yaxis)}),b[c-1]}function r(){var b,c=da.length,d=-1;for(b=0;b<da.length;++b){var e=da[b].color;null!=e&&(c--,"number"==typeof e&&e>d&&(d=e))}d>=c&&(c=d+1);var f,g=[],h=ea.colors,i=h.length,j=0;for(b=0;c>b;b++)f=a.color.parse(h[b%i]||"#666"),b%i==0&&b&&(j=j>=0?.5>j?-j-.2:0:-j),g[b]=f.scale("rgb",1+j);var k,l=0;for(b=0;b<da.length;++b){if(k=da[b],null==k.color?(k.color=g[l].toString(),++l):"number"==typeof k.color&&(k.color=g[k.color].toString()),null==k.lines.show){var n,o=!0;for(n in k)if(k[n]&&k[n].show){o=!1;break}o&&(k.lines.show=!0)}null==k.lines.zero&&(k.lines.zero=!!k.lines.fill),k.xaxis=q(ka,m(k,"x")),k.yaxis=q(la,m(k,"y"))}}function s(){function b(a,b,c){b<a.datamin&&b!=-s&&(a.datamin=b),c>a.datamax&&c!=s&&(a.datamax=c)}var c,d,e,f,g,i,j,k,l,m,o,p,q=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,s=Number.MAX_VALUE;for(a.each(n(),function(a,b){b.datamin=q,b.datamax=r,b.used=!1}),c=0;c<da.length;++c)g=da[c],g.datapoints={points:[]},h(pa.processRawData,[g,g.data,g.datapoints]);for(c=0;c<da.length;++c){if(g=da[c],o=g.data,p=g.datapoints.format,!p){if(p=[],p.push({x:!0,number:!0,required:!0}),p.push({y:!0,number:!0,required:!0}),g.bars.show||g.lines.show&&g.lines.fill){var t=!!(g.bars.show&&g.bars.zero||g.lines.show&&g.lines.zero);p.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:t}),g.bars.horizontal&&(delete p[p.length-1].y,p[p.length-1].x=!0)}g.datapoints.format=p}if(null==g.datapoints.pointsize){g.datapoints.pointsize=p.length,j=g.datapoints.pointsize,i=g.datapoints.points;var u=g.lines.show&&g.lines.steps;for(g.xaxis.used=g.yaxis.used=!0,d=e=0;d<o.length;++d,e+=j){m=o[d];var v=null==m;if(!v)for(f=0;j>f;++f)k=m[f],l=p[f],l&&(l.number&&null!=k&&(k=+k,isNaN(k)?k=null:k==1/0?k=s:k==-(1/0)&&(k=-s)),null==k&&(l.required&&(v=!0),null!=l.defaultValue&&(k=l.defaultValue))),i[e+f]=k;if(v)for(f=0;j>f;++f)k=i[e+f],null!=k&&(l=p[f],l.autoscale!==!1&&(l.x&&b(g.xaxis,k,k),l.y&&b(g.yaxis,k,k))),i[e+f]=null;else if(u&&e>0&&null!=i[e-j]&&i[e-j]!=i[e]&&i[e-j+1]!=i[e+1]){for(f=0;j>f;++f)i[e+j+f]=i[e+f];i[e+1]=i[e-j+1],e+=j}}}}for(c=0;c<da.length;++c)g=da[c],h(pa.processDatapoints,[g,g.datapoints]);for(c=0;c<da.length;++c){g=da[c],i=g.datapoints.points,j=g.datapoints.pointsize,p=g.datapoints.format;var w=q,x=q,y=r,z=r;for(d=0;d<i.length;d+=j)if(null!=i[d])for(f=0;j>f;++f)k=i[d+f],l=p[f],l&&l.autoscale!==!1&&k!=s&&k!=-s&&(l.x&&(w>k&&(w=k),k>y&&(y=k)),l.y&&(x>k&&(x=k),k>z&&(z=k)));if(g.bars.show){var A;switch(g.bars.align){case"left":A=0;break;case"right":A=-g.bars.barWidth;break;default:A=-g.bars.barWidth/2}g.bars.horizontal?(x+=A,z+=A+g.bars.barWidth):(w+=A,y+=A+g.bars.barWidth)}b(g.xaxis,w,y),b(g.yaxis,x,z)}a.each(n(),function(a,b){b.datamin==q&&(b.datamin=null),b.datamax==r&&(b.datamax=null)})}function t(){c.css("padding",0).children().filter(function(){return!a(this).hasClass("flot-overlay")&&!a(this).hasClass("flot-base")}).remove(),"static"==c.css("position")&&c.css("position","relative"),fa=new b("flot-base",c),ga=new b("flot-overlay",c),ia=fa.context,ja=ga.context,ha=a(ga.element).unbind();var d=c.data("plot");d&&(d.shutdown(),ga.clear()),c.data("plot",qa)}function u(){ea.grid.hoverable&&(ha.mousemove(T),ha.bind("mouseleave",U)),ea.grid.clickable&&ha.click(V),h(pa.bindEvents,[ha])}function v(){sa&&clearTimeout(sa),ha.unbind("mousemove",T),ha.unbind("mouseleave",U),ha.unbind("click",V),h(pa.shutdown,[ha])}function w(a){function b(a){return a}var c,d,e=a.options.transform||b,f=a.options.inverseTransform;"x"==a.direction?(c=a.scale=na/Math.abs(e(a.max)-e(a.min)),d=Math.min(e(a.max),e(a.min))):(c=a.scale=oa/Math.abs(e(a.max)-e(a.min)),c=-c,d=Math.max(e(a.max),e(a.min))),e==b?a.p2c=function(a){return(a-d)*c}:a.p2c=function(a){return(e(a)-d)*c},f?a.c2p=function(a){return f(d+a/c)}:a.c2p=function(a){return d+a/c}}function x(a){for(var b=a.options,c=a.ticks||[],d=b.labelWidth||0,e=b.labelHeight||0,f=d||("x"==a.direction?Math.floor(fa.width/(c.length||1)):null),g=a.direction+"Axis "+a.direction+a.n+"Axis",h="flot-"+a.direction+"-axis flot-"+a.direction+a.n+"-axis "+g,i=b.font||"flot-tick-label tickLabel",j=0;j<c.length;++j){var k=c[j];if(k.label){var l=fa.getTextInfo(h,k.label,i,null,f);d=Math.max(d,l.width),e=Math.max(e,l.height)}}a.labelWidth=b.labelWidth||d,a.labelHeight=b.labelHeight||e}function y(b){var c=b.labelWidth,d=b.labelHeight,e=b.options.position,f="x"===b.direction,g=b.options.tickLength,h=ea.grid.axisMargin,i=ea.grid.labelMargin,j=!0,k=!0,l=!0,m=!1;a.each(f?ka:la,function(a,c){c&&c.reserveSpace&&(c===b?m=!0:c.options.position===e&&(m?k=!1:j=!1),m||(l=!1))}),k&&(h=0),null==g&&(g=l?"full":5),isNaN(+g)||(i+=+g),f?(d+=i,"bottom"==e?(ma.bottom+=d+h,b.box={top:fa.height-ma.bottom,height:d}):(b.box={top:ma.top+h,height:d},ma.top+=d+h)):(c+=i,"left"==e?(b.box={left:ma.left+h,width:c},ma.left+=c+h):(ma.right+=c+h,b.box={left:fa.width-ma.right,width:c})),b.position=e,b.tickLength=g,b.box.padding=i,b.innermost=j}function z(a){"x"==a.direction?(a.box.left=ma.left-a.labelWidth/2,a.box.width=fa.width-ma.left-ma.right+a.labelWidth):(a.box.top=ma.top-a.labelHeight/2,a.box.height=fa.height-ma.bottom-ma.top+a.labelHeight)}function A(){var b,c=ea.grid.minBorderMargin;if(null==c)for(c=0,b=0;b<da.length;++b)c=Math.max(c,2*(da[b].points.radius+da[b].points.lineWidth/2));var d={left:c,right:c,top:c,bottom:c};a.each(n(),function(a,b){if(b.reserveSpace&&b.ticks&&b.ticks.length){var c=b.ticks[b.ticks.length-1];"x"===b.direction?(d.left=Math.max(d.left,b.labelWidth/2),c.v<=b.max&&(d.right=Math.max(d.right,b.labelWidth/2))):(d.bottom=Math.max(d.bottom,b.labelHeight/2),c.v<=b.max&&(d.top=Math.max(d.top,b.labelHeight/2)))}}),ma.left=Math.ceil(Math.max(d.left,ma.left)),ma.right=Math.ceil(Math.max(d.right,ma.right)),ma.top=Math.ceil(Math.max(d.top,ma.top)),ma.bottom=Math.ceil(Math.max(d.bottom,ma.bottom))}function B(){var b,c=n(),d=ea.grid.show;for(var e in ma){var f=ea.grid.margin||0;ma[e]="number"==typeof f?f:f[e]||0}h(pa.processOffset,[ma]);for(var e in ma)"object"==typeof ea.grid.borderWidth?ma[e]+=d?ea.grid.borderWidth[e]:0:ma[e]+=d?ea.grid.borderWidth:0;if(a.each(c,function(a,b){b.show=b.options.show,null==b.show&&(b.show=b.used),b.reserveSpace=b.show||b.options.reserveSpace,C(b)}),d){var g=a.grep(c,function(a){return a.reserveSpace});for(a.each(g,function(a,b){D(b),E(b),F(b,b.ticks),x(b)}),b=g.length-1;b>=0;--b)y(g[b]);A(),a.each(g,function(a,b){z(b)})}na=fa.width-ma.left-ma.right,oa=fa.height-ma.bottom-ma.top,a.each(c,function(a,b){w(b)}),d&&K(),R()}function C(a){var b=a.options,c=+(null!=b.min?b.min:a.datamin),d=+(null!=b.max?b.max:a.datamax),e=d-c;if(0==e){var f=0==d?1:.01;null==b.min&&(c-=f),null!=b.max&&null==b.min||(d+=f)}else{var g=b.autoscaleMargin;null!=g&&(null==b.min&&(c-=e*g,0>c&&null!=a.datamin&&a.datamin>=0&&(c=0)),null==b.max&&(d+=e*g,d>0&&null!=a.datamax&&a.datamax<=0&&(d=0)))}a.min=c,a.max=d}function D(b){var c,e=b.options;c="number"==typeof e.ticks&&e.ticks>0?e.ticks:.3*Math.sqrt("x"==b.direction?fa.width:fa.height);var f=(b.max-b.min)/c,g=-Math.floor(Math.log(f)/Math.LN10),h=e.tickDecimals;null!=h&&g>h&&(g=h);var i,j=Math.pow(10,-g),k=f/j;if(1.5>k?i=1:3>k?(i=2,k>2.25&&(null==h||h>=g+1)&&(i=2.5,++g)):i=7.5>k?5:10,i*=j,null!=e.minTickSize&&i<e.minTickSize&&(i=e.minTickSize),b.delta=f,b.tickDecimals=Math.max(0,null!=h?h:g),b.tickSize=e.tickSize||i,"time"==e.mode&&!b.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(b.tickGenerator||(b.tickGenerator=function(a){var b,c=[],e=d(a.min,a.tickSize),f=0,g=Number.NaN;do b=g,g=e+f*a.tickSize,c.push(g),++f;while(g<a.max&&g!=b);return c},b.tickFormatter=function(a,b){var c=b.tickDecimals?Math.pow(10,b.tickDecimals):1,d=""+Math.round(a*c)/c;if(null!=b.tickDecimals){var e=d.indexOf("."),f=-1==e?0:d.length-e-1;if(f<b.tickDecimals)return(f?d:d+".")+(""+c).substr(1,b.tickDecimals-f)}return d}),a.isFunction(e.tickFormatter)&&(b.tickFormatter=function(a,b){return""+e.tickFormatter(a,b)}),null!=e.alignTicksWithAxis){var l=("x"==b.direction?ka:la)[e.alignTicksWithAxis-1];if(l&&l.used&&l!=b){var m=b.tickGenerator(b);if(m.length>0&&(null==e.min&&(b.min=Math.min(b.min,m[0])),null==e.max&&m.length>1&&(b.max=Math.max(b.max,m[m.length-1]))),b.tickGenerator=function(a){var b,c,d=[];for(c=0;c<l.ticks.length;++c)b=(l.ticks[c].v-l.min)/(l.max-l.min),b=a.min+b*(a.max-a.min),d.push(b);return d},!b.mode&&null==e.tickDecimals){var n=Math.max(0,-Math.floor(Math.log(b.delta)/Math.LN10)+1),o=b.tickGenerator(b);o.length>1&&/\..*0$/.test((o[1]-o[0]).toFixed(n))||(b.tickDecimals=n)}}}}function E(b){var c=b.options.ticks,d=[];null==c||"number"==typeof c&&c>0?d=b.tickGenerator(b):c&&(d=a.isFunction(c)?c(b):c);var e,f;for(b.ticks=[],e=0;e<d.length;++e){var g=null,h=d[e];"object"==typeof h?(f=+h[0],h.length>1&&(g=h[1])):f=+h,null==g&&(g=b.tickFormatter(f,b)),isNaN(f)||b.ticks.push({v:f,label:g})}}function F(a,b){a.options.autoscaleMargin&&b.length>0&&(null==a.options.min&&(a.min=Math.min(a.min,b[0].v)),null==a.options.max&&b.length>1&&(a.max=Math.max(a.max,b[b.length-1].v)))}function G(){fa.clear(),h(pa.drawBackground,[ia]);var a=ea.grid;a.show&&a.backgroundColor&&I(),a.show&&!a.aboveData&&J();for(var b=0;b<da.length;++b)h(pa.drawSeries,[ia,da[b]]),L(da[b]);h(pa.draw,[ia]),a.show&&a.aboveData&&J(),fa.render(),X()}function H(a,b){for(var c,d,e,f,g=n(),h=0;h<g.length;++h)if(c=g[h],c.direction==b&&(f=b+c.n+"axis",a[f]||1!=c.n||(f=b+"axis"),a[f])){d=a[f].from,e=a[f].to;break}if(a[f]||(c="x"==b?ka[0]:la[0],d=a[b+"1"],e=a[b+"2"]),null!=d&&null!=e&&d>e){var i=d;d=e,e=i}return{from:d,to:e,axis:c}}function I(){ia.save(),ia.translate(ma.left,ma.top),ia.fillStyle=ca(ea.grid.backgroundColor,oa,0,"rgba(255, 255, 255, 0)"),ia.fillRect(0,0,na,oa),ia.restore()}function J(){var b,c,d,e;ia.save(),ia.translate(ma.left,ma.top);var f=ea.grid.markings;if(f)for(a.isFunction(f)&&(c=qa.getAxes(),c.xmin=c.xaxis.min,c.xmax=c.xaxis.max,c.ymin=c.yaxis.min,c.ymax=c.yaxis.max,f=f(c)),b=0;b<f.length;++b){var g=f[b],h=H(g,"x"),i=H(g,"y");null==h.from&&(h.from=h.axis.min),null==h.to&&(h.to=h.axis.max),null==i.from&&(i.from=i.axis.min),null==i.to&&(i.to=i.axis.max),h.to<h.axis.min||h.from>h.axis.max||i.to<i.axis.min||i.from>i.axis.max||(h.from=Math.max(h.from,h.axis.min),h.to=Math.min(h.to,h.axis.max),i.from=Math.max(i.from,i.axis.min),i.to=Math.min(i.to,i.axis.max),h.from==h.to&&i.from==i.to||(h.from=h.axis.p2c(h.from),h.to=h.axis.p2c(h.to),i.from=i.axis.p2c(i.from),i.to=i.axis.p2c(i.to),h.from==h.to||i.from==i.to?(ia.beginPath(),ia.strokeStyle=g.color||ea.grid.markingsColor,ia.lineWidth=g.lineWidth||ea.grid.markingsLineWidth,ia.moveTo(h.from,i.from),ia.lineTo(h.to,i.to),ia.stroke()):(ia.fillStyle=g.color||ea.grid.markingsColor,ia.fillRect(h.from,i.to,h.to-h.from,i.from-i.to))))}c=n(),d=ea.grid.borderWidth;for(var j=0;j<c.length;++j){var k,l,m,o,p=c[j],q=p.box,r=p.tickLength;if(p.show&&0!=p.ticks.length){for(ia.lineWidth=1,"x"==p.direction?(k=0,l="full"==r?"top"==p.position?0:oa:q.top-ma.top+("top"==p.position?q.height:0)):(l=0,k="full"==r?"left"==p.position?0:na:q.left-ma.left+("left"==p.position?q.width:0)),p.innermost||(ia.strokeStyle=p.options.color,ia.beginPath(),m=o=0,"x"==p.direction?m=na+1:o=oa+1,1==ia.lineWidth&&("x"==p.direction?l=Math.floor(l)+.5:k=Math.floor(k)+.5),ia.moveTo(k,l),ia.lineTo(k+m,l+o),ia.stroke()),ia.strokeStyle=p.options.tickColor,ia.beginPath(),b=0;b<p.ticks.length;++b){var s=p.ticks[b].v;m=o=0,isNaN(s)||s<p.min||s>p.max||"full"==r&&("object"==typeof d&&d[p.position]>0||d>0)&&(s==p.min||s==p.max)||("x"==p.direction?(k=p.p2c(s),o="full"==r?-oa:r,"top"==p.position&&(o=-o)):(l=p.p2c(s),m="full"==r?-na:r,"left"==p.position&&(m=-m)),1==ia.lineWidth&&("x"==p.direction?k=Math.floor(k)+.5:l=Math.floor(l)+.5),ia.moveTo(k,l),ia.lineTo(k+m,l+o))}ia.stroke()}}d&&(e=ea.grid.borderColor,"object"==typeof d||"object"==typeof e?("object"!=typeof d&&(d={top:d,right:d,bottom:d,left:d}),"object"!=typeof e&&(e={top:e,right:e,bottom:e,left:e}),d.top>0&&(ia.strokeStyle=e.top,ia.lineWidth=d.top,ia.beginPath(),ia.moveTo(0-d.left,0-d.top/2),ia.lineTo(na,0-d.top/2),ia.stroke()),d.right>0&&(ia.strokeStyle=e.right,ia.lineWidth=d.right,ia.beginPath(),ia.moveTo(na+d.right/2,0-d.top),ia.lineTo(na+d.right/2,oa),ia.stroke()),d.bottom>0&&(ia.strokeStyle=e.bottom,ia.lineWidth=d.bottom,ia.beginPath(),ia.moveTo(na+d.right,oa+d.bottom/2),ia.lineTo(0,oa+d.bottom/2),ia.stroke()),d.left>0&&(ia.strokeStyle=e.left,ia.lineWidth=d.left,ia.beginPath(),ia.moveTo(0-d.left/2,oa+d.bottom),ia.lineTo(0-d.left/2,0),ia.stroke())):(ia.lineWidth=d,ia.strokeStyle=ea.grid.borderColor,ia.strokeRect(-d/2,-d/2,na+d,oa+d))),ia.restore()}function K(){a.each(n(),function(a,b){var c,d,e,f,g,h=b.box,i=b.direction+"Axis "+b.direction+b.n+"Axis",j="flot-"+b.direction+"-axis flot-"+b.direction+b.n+"-axis "+i,k=b.options.font||"flot-tick-label tickLabel";if(fa.removeText(j),b.show&&0!=b.ticks.length)for(var l=0;l<b.ticks.length;++l)c=b.ticks[l],!c.label||c.v<b.min||c.v>b.max||("x"==b.direction?(f="center",d=ma.left+b.p2c(c.v),"bottom"==b.position?e=h.top+h.padding:(e=h.top+h.height-h.padding,g="bottom")):(g="middle",e=ma.top+b.p2c(c.v),"left"==b.position?(d=h.left+h.width-h.padding,f="right"):d=h.left+h.padding),fa.addText(j,d,e,c.label,k,null,null,f,g))})}function L(a){a.lines.show&&M(a),a.bars.show&&P(a),a.points.show&&N(a)}function M(a){function b(a,b,c,d,e){var f=a.points,g=a.pointsize,h=null,i=null;ia.beginPath();for(var j=g;j<f.length;j+=g){var k=f[j-g],l=f[j-g+1],m=f[j],n=f[j+1];if(null!=k&&null!=m){if(n>=l&&l<e.min){if(n<e.min)continue;k=(e.min-l)/(n-l)*(m-k)+k,l=e.min}else if(l>=n&&n<e.min){if(l<e.min)continue;m=(e.min-l)/(n-l)*(m-k)+k,n=e.min}if(l>=n&&l>e.max){if(n>e.max)continue;k=(e.max-l)/(n-l)*(m-k)+k,l=e.max}else if(n>=l&&n>e.max){if(l>e.max)continue;m=(e.max-l)/(n-l)*(m-k)+k,n=e.max}if(m>=k&&k<d.min){if(m<d.min)continue;l=(d.min-k)/(m-k)*(n-l)+l,k=d.min}else if(k>=m&&m<d.min){if(k<d.min)continue;n=(d.min-k)/(m-k)*(n-l)+l,m=d.min}if(k>=m&&k>d.max){if(m>d.max)continue;l=(d.max-k)/(m-k)*(n-l)+l,k=d.max}else if(m>=k&&m>d.max){if(k>d.max)continue;n=(d.max-k)/(m-k)*(n-l)+l,m=d.max}k==h&&l==i||ia.moveTo(d.p2c(k)+b,e.p2c(l)+c),h=m,i=n,ia.lineTo(d.p2c(m)+b,e.p2c(n)+c)}}ia.stroke()}function c(a,b,c){for(var d=a.points,e=a.pointsize,f=Math.min(Math.max(0,c.min),c.max),g=0,h=!1,i=1,j=0,k=0;;){if(e>0&&g>d.length+e)break;g+=e;var l=d[g-e],m=d[g-e+i],n=d[g],o=d[g+i];if(h){if(e>0&&null!=l&&null==n){k=g,e=-e,i=2;continue}if(0>e&&g==j+e){ia.fill(),h=!1,e=-e,i=1,g=j=k+e;continue}}if(null!=l&&null!=n){if(n>=l&&l<b.min){if(n<b.min)continue;m=(b.min-l)/(n-l)*(o-m)+m,l=b.min}else if(l>=n&&n<b.min){if(l<b.min)continue;o=(b.min-l)/(n-l)*(o-m)+m,n=b.min}if(l>=n&&l>b.max){if(n>b.max)continue;m=(b.max-l)/(n-l)*(o-m)+m,l=b.max}else if(n>=l&&n>b.max){if(l>b.max)continue;o=(b.max-l)/(n-l)*(o-m)+m,n=b.max}if(h||(ia.beginPath(),ia.moveTo(b.p2c(l),c.p2c(f)),h=!0),m>=c.max&&o>=c.max)ia.lineTo(b.p2c(l),c.p2c(c.max)),ia.lineTo(b.p2c(n),c.p2c(c.max));else if(m<=c.min&&o<=c.min)ia.lineTo(b.p2c(l),c.p2c(c.min)),ia.lineTo(b.p2c(n),c.p2c(c.min));else{var p=l,q=n;o>=m&&m<c.min&&o>=c.min?(l=(c.min-m)/(o-m)*(n-l)+l,m=c.min):m>=o&&o<c.min&&m>=c.min&&(n=(c.min-m)/(o-m)*(n-l)+l,o=c.min),m>=o&&m>c.max&&o<=c.max?(l=(c.max-m)/(o-m)*(n-l)+l,m=c.max):o>=m&&o>c.max&&m<=c.max&&(n=(c.max-m)/(o-m)*(n-l)+l,o=c.max),l!=p&&ia.lineTo(b.p2c(p),c.p2c(m)),ia.lineTo(b.p2c(l),c.p2c(m)),ia.lineTo(b.p2c(n),c.p2c(o)),n!=q&&(ia.lineTo(b.p2c(n),c.p2c(o)),ia.lineTo(b.p2c(q),c.p2c(o)))}}}}ia.save(),ia.translate(ma.left,ma.top),ia.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(d>0&&e>0){ia.lineWidth=e,ia.strokeStyle="rgba(0,0,0,0.1)";var f=Math.PI/18;b(a.datapoints,Math.sin(f)*(d/2+e/2),Math.cos(f)*(d/2+e/2),a.xaxis,a.yaxis),ia.lineWidth=e/2,b(a.datapoints,Math.sin(f)*(d/2+e/4),Math.cos(f)*(d/2+e/4),a.xaxis,a.yaxis)}ia.lineWidth=d,ia.strokeStyle=a.color;var g=Q(a.lines,a.color,0,oa);g&&(ia.fillStyle=g,c(a.datapoints,a.xaxis,a.yaxis)),d>0&&b(a.datapoints,0,0,a.xaxis,a.yaxis),ia.restore()}function N(a){function b(a,b,c,d,e,f,g,h){for(var i=a.points,j=a.pointsize,k=0;k<i.length;k+=j){var l=i[k],m=i[k+1];null==l||l<f.min||l>f.max||m<g.min||m>g.max||(ia.beginPath(),l=f.p2c(l),m=g.p2c(m)+d,"circle"==h?ia.arc(l,m,b,0,e?Math.PI:2*Math.PI,!1):h(ia,l,m,b,e),ia.closePath(),c&&(ia.fillStyle=c,ia.fill()),ia.stroke())}}ia.save(),ia.translate(ma.left,ma.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,f=a.points.symbol;if(0==c&&(c=1e-4),c>0&&d>0){var g=d/2;ia.lineWidth=g,ia.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,g+g/2,!0,a.xaxis,a.yaxis,f),ia.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,g/2,!0,a.xaxis,a.yaxis,f)}ia.lineWidth=c,ia.strokeStyle=a.color,b(a.datapoints,e,Q(a.points,a.color),0,!1,a.xaxis,a.yaxis,f),ia.restore()}function O(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q,r,s,t;j?(s=q=r=!0,p=!1,l=c,m=a,o=b+d,n=b+e,l>m&&(t=m,m=l,l=t,p=!0,q=!1)):(p=q=r=!0,s=!1,l=a+d,m=a+e,n=c,o=b,n>o&&(t=o,o=n,n=t,s=!0,r=!1)),m<g.min||l>g.max||o<h.min||n>h.max||(l<g.min&&(l=g.min,p=!1),m>g.max&&(m=g.max,q=!1),n<h.min&&(n=h.min,s=!1),o>h.max&&(o=h.max,r=!1),l=g.p2c(l),n=h.p2c(n),m=g.p2c(m),o=h.p2c(o),f&&(i.fillStyle=f(n,o),i.fillRect(l,o,m-l,n-o)),k>0&&(p||q||r||s)&&(i.beginPath(),i.moveTo(l,n),p?i.lineTo(l,o):i.moveTo(l,o),r?i.lineTo(m,o):i.moveTo(m,o),q?i.lineTo(m,n):i.moveTo(m,n),s?i.lineTo(l,n):i.moveTo(l,n),i.stroke()))}function P(a){function b(b,c,d,e,f,g){for(var h=b.points,i=b.pointsize,j=0;j<h.length;j+=i)null!=h[j]&&O(h[j],h[j+1],h[j+2],c,d,e,f,g,ia,a.bars.horizontal,a.bars.lineWidth)}ia.save(),ia.translate(ma.left,ma.top),ia.lineWidth=a.bars.lineWidth,ia.strokeStyle=a.color;var c;switch(a.bars.align){case"left":c=0;break;case"right":c=-a.bars.barWidth;break;default:c=-a.bars.barWidth/2}var d=a.bars.fill?function(b,c){return Q(a.bars,a.color,b,c)}:null;b(a.datapoints,c,c+a.bars.barWidth,d,a.xaxis,a.yaxis),ia.restore()}function Q(b,c,d,e){var f=b.fill;if(!f)return null;if(b.fillColor)return ca(b.fillColor,d,e,c);var g=a.color.parse(c);return g.a="number"==typeof f?f:.4,g.normalize(),g.toString()}function R(){if(null!=ea.legend.container?a(ea.legend.container).html(""):c.find(".legend").remove(),ea.legend.show){for(var b,d,e=[],f=[],g=!1,h=ea.legend.labelFormatter,i=0;i<da.length;++i)b=da[i],b.label&&(d=h?h(b.label,b):b.label,d&&f.push({label:d,color:b.color}));if(ea.legend.sorted)if(a.isFunction(ea.legend.sorted))f.sort(ea.legend.sorted);else if("reverse"==ea.legend.sorted)f.reverse();else{var j="descending"!=ea.legend.sorted;f.sort(function(a,b){return a.label==b.label?0:a.label<b.label!=j?1:-1})}for(var i=0;i<f.length;++i){var k=f[i];i%ea.legend.noColumns==0&&(g&&e.push("</tr>"),e.push("<tr>"),g=!0),e.push('<td class="legendColorBox"><div style="border:1px solid '+ea.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+k.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+k.label+"</td>")}if(g&&e.push("</tr>"),0!=e.length){var l='<table style="font-size:smaller;color:'+ea.grid.color+'">'+e.join("")+"</table>";if(null!=ea.legend.container)a(ea.legend.container).html(l);else{var m="",n=ea.legend.position,o=ea.legend.margin;null==o[0]&&(o=[o,o]),"n"==n.charAt(0)?m+="top:"+(o[1]+ma.top)+"px;":"s"==n.charAt(0)&&(m+="bottom:"+(o[1]+ma.bottom)+"px;"),"e"==n.charAt(1)?m+="right:"+(o[0]+ma.right)+"px;":"w"==n.charAt(1)&&(m+="left:"+(o[0]+ma.left)+"px;");var p=a('<div class="legend">'+l.replace('style="','style="position:absolute;'+m+";")+"</div>").appendTo(c);if(0!=ea.legend.backgroundOpacity){var q=ea.legend.backgroundColor;null==q&&(q=ea.grid.backgroundColor,q=q&&"string"==typeof q?a.color.parse(q):a.color.extract(p,"background-color"),q.a=1,q=q.toString());var r=p.children();a('<div style="position:absolute;width:'+r.width()+"px;height:"+r.height()+"px;"+m+"background-color:"+q+';"> </div>').prependTo(p).css("opacity",ea.legend.backgroundOpacity)}}}}}function S(a,b,c){var d,e,f,g=ea.grid.mouseActiveRadius,h=g*g+1,i=null;for(d=da.length-1;d>=0;--d)if(c(da[d])){var j=da[d],k=j.xaxis,l=j.yaxis,m=j.datapoints.points,n=k.c2p(a),o=l.c2p(b),p=g/k.scale,q=g/l.scale;if(f=j.datapoints.pointsize,k.options.inverseTransform&&(p=Number.MAX_VALUE),l.options.inverseTransform&&(q=Number.MAX_VALUE),j.lines.show||j.points.show)for(e=0;e<m.length;e+=f){var r=m[e],s=m[e+1];if(null!=r&&!(r-n>p||-p>r-n||s-o>q||-q>s-o)){var t=Math.abs(k.p2c(r)-a),u=Math.abs(l.p2c(s)-b),v=t*t+u*u;h>v&&(h=v,i=[d,e/f])}}if(j.bars.show&&!i){var w,x;switch(j.bars.align){case"left":w=0;break;case"right":w=-j.bars.barWidth;break;default:w=-j.bars.barWidth/2}for(x=w+j.bars.barWidth,e=0;e<m.length;e+=f){var r=m[e],s=m[e+1],y=m[e+2];null!=r&&(da[d].bars.horizontal?n<=Math.max(y,r)&&n>=Math.min(y,r)&&o>=s+w&&s+x>=o:n>=r+w&&r+x>=n&&o>=Math.min(y,s)&&o<=Math.max(y,s))&&(i=[d,e/f])}}}return i?(d=i[0],e=i[1],f=da[d].datapoints.pointsize,{datapoint:da[d].datapoints.points.slice(e*f,(e+1)*f),dataIndex:e,series:da[d],seriesIndex:d}):null}function T(a){ea.grid.hoverable&&W("plothover",a,function(a){return 0!=a.hoverable})}function U(a){ea.grid.hoverable&&W("plothover",a,function(a){return!1})}function V(a){W("plotclick",a,function(a){return 0!=a.clickable})}function W(a,b,d){var e=ha.offset(),f=b.pageX-e.left-ma.left,g=b.pageY-e.top-ma.top,h=o({left:f,top:g});h.pageX=b.pageX,h.pageY=b.pageY;var i=S(f,g,d);if(i&&(i.pageX=parseInt(i.series.xaxis.p2c(i.datapoint[0])+e.left+ma.left,10),i.pageY=parseInt(i.series.yaxis.p2c(i.datapoint[1])+e.top+ma.top,10)),ea.grid.autoHighlight){for(var j=0;j<ra.length;++j){var k=ra[j];k.auto!=a||i&&k.series==i.series&&k.point[0]==i.datapoint[0]&&k.point[1]==i.datapoint[1]||$(k.series,k.point)}i&&Z(i.series,i.datapoint,a)}c.trigger(a,[h,i])}function X(){var a=ea.interaction.redrawOverlayInterval;return-1==a?void Y():void(sa||(sa=setTimeout(Y,a)))}function Y(){sa=null,ja.save(),ga.clear(),ja.translate(ma.left,ma.top);var a,b;for(a=0;a<ra.length;++a)b=ra[a],b.series.bars.show?ba(b.series,b.point):aa(b.series,b.point);ja.restore(),h(pa.drawOverlay,[ja])}function Z(a,b,c){if("number"==typeof a&&(a=da[a]),"number"==typeof b){var d=a.datapoints.pointsize;b=a.datapoints.points.slice(d*b,d*(b+1))}var e=_(a,b);-1==e?(ra.push({series:a,point:b,auto:c}),X()):c||(ra[e].auto=!1)}function $(a,b){if(null==a&&null==b)return ra=[],void X();if("number"==typeof a&&(a=da[a]),"number"==typeof b){var c=a.datapoints.pointsize;
b=a.datapoints.points.slice(c*b,c*(b+1))}var d=_(a,b);-1!=d&&(ra.splice(d,1),X())}function _(a,b){for(var c=0;c<ra.length;++c){var d=ra[c];if(d.series==a&&d.point[0]==b[0]&&d.point[1]==b[1])return c}return-1}function aa(b,c){var d=c[0],e=c[1],f=b.xaxis,g=b.yaxis,h="string"==typeof b.highlightColor?b.highlightColor:a.color.parse(b.color).scale("a",.5).toString();if(!(d<f.min||d>f.max||e<g.min||e>g.max)){var i=b.points.radius+b.points.lineWidth/2;ja.lineWidth=i,ja.strokeStyle=h;var j=1.5*i;d=f.p2c(d),e=g.p2c(e),ja.beginPath(),"circle"==b.points.symbol?ja.arc(d,e,j,0,2*Math.PI,!1):b.points.symbol(ja,d,e,j,!1),ja.closePath(),ja.stroke()}}function ba(b,c){var d,e="string"==typeof b.highlightColor?b.highlightColor:a.color.parse(b.color).scale("a",.5).toString(),f=e;switch(b.bars.align){case"left":d=0;break;case"right":d=-b.bars.barWidth;break;default:d=-b.bars.barWidth/2}ja.lineWidth=b.bars.lineWidth,ja.strokeStyle=e,O(c[0],c[1],c[2]||0,d,d+b.bars.barWidth,function(){return f},b.xaxis,b.yaxis,ja,b.bars.horizontal,b.bars.lineWidth)}function ca(b,c,d,e){if("string"==typeof b)return b;for(var f=ia.createLinearGradient(0,d,0,c),g=0,h=b.colors.length;h>g;++g){var i=b.colors[g];if("string"!=typeof i){var j=a.color.parse(e);null!=i.brightness&&(j=j.scale("rgb",i.brightness)),null!=i.opacity&&(j.a*=i.opacity),i=j.toString()}f.addColorStop(g/(h-1),i)}return f}var da=[],ea={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},fa=null,ga=null,ha=null,ia=null,ja=null,ka=[],la=[],ma={left:0,right:0,top:0,bottom:0},na=0,oa=0,pa={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},qa=this;qa.setData=k,qa.setupGrid=B,qa.draw=G,qa.getPlaceholder=function(){return c},qa.getCanvas=function(){return fa.element},qa.getPlotOffset=function(){return ma},qa.width=function(){return na},qa.height=function(){return oa},qa.offset=function(){var a=ha.offset();return a.left+=ma.left,a.top+=ma.top,a},qa.getData=function(){return da},qa.getAxes=function(){var b={};return a.each(ka.concat(la),function(a,c){c&&(b[c.direction+(1!=c.n?c.n:"")+"axis"]=c)}),b},qa.getXAxes=function(){return ka},qa.getYAxes=function(){return la},qa.c2p=o,qa.p2c=p,qa.getOptions=function(){return ea},qa.highlight=Z,qa.unhighlight=$,qa.triggerRedrawOverlay=X,qa.pointOffset=function(a){return{left:parseInt(ka[m(a,"x")-1].p2c(+a.x)+ma.left,10),top:parseInt(la[m(a,"y")-1].p2c(+a.y)+ma.top,10)}},qa.shutdown=v,qa.destroy=function(){v(),c.removeData("plot").empty(),da=[],ea=null,fa=null,ga=null,ha=null,ia=null,ja=null,ka=[],la=[],pa=null,ra=[],qa=null},qa.resize=function(){var a=c.width(),b=c.height();fa.resize(a,b),ga.resize(a,b)},qa.hooks=pa,i(qa),j(f),t(),k(e),B(),G(),u();var ra=[],sa=null}function d(a,b){return b*Math.floor(a/b)}var e=Object.prototype.hasOwnProperty;b.prototype.resize=function(a,b){if(0>=a||0>=b)throw new Error("Invalid dimensions for plot, width = "+a+", height = "+b);var c=this.element,d=this.context,e=this.pixelRatio;this.width!=a&&(c.width=a*e,c.style.width=a+"px",this.width=a),this.height!=b&&(c.height=b*e,c.style.height=b+"px",this.height=b),d.restore(),d.save(),d.scale(e,e)},b.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},b.prototype.render=function(){var a=this._textCache;for(var b in a)if(e.call(a,b)){var c=this.getTextLayer(b),d=a[b];c.hide();for(var f in d)if(e.call(d,f)){var g=d[f];for(var h in g)if(e.call(g,h)){for(var i,j=g[h].positions,k=0;i=j[k];k++)i.active?i.rendered||(c.append(i.element),i.rendered=!0):(j.splice(k--,1),i.rendered&&i.element.detach());0==j.length&&delete g[h]}}c.show()}},b.prototype.getTextLayer=function(b){var c=this.text[b];return null==c&&(null==this.textContainer&&(this.textContainer=a("<div class='flot-text'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),c=this.text[b]=a("<div></div>").addClass(b).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),c},b.prototype.getTextInfo=function(b,c,d,e,f){var g,h,i,j;if(c=""+c,g="object"==typeof d?d.style+" "+d.variant+" "+d.weight+" "+d.size+"px/"+d.lineHeight+"px "+d.family:d,h=this._textCache[b],null==h&&(h=this._textCache[b]={}),i=h[g],null==i&&(i=h[g]={}),j=i[c],null==j){var k=a("<div></div>").html(c).css({position:"absolute","max-width":f,top:-9999}).appendTo(this.getTextLayer(b));"object"==typeof d?k.css({font:g,color:d.color}):"string"==typeof d&&k.addClass(d),j=i[c]={width:k.outerWidth(!0),height:k.outerHeight(!0),element:k,positions:[]},k.detach()}return j},b.prototype.addText=function(a,b,c,d,e,f,g,h,i){var j=this.getTextInfo(a,d,e,f,g),k=j.positions;"center"==h?b-=j.width/2:"right"==h&&(b-=j.width),"middle"==i?c-=j.height/2:"bottom"==i&&(c-=j.height);for(var l,m=0;l=k[m];m++)if(l.x==b&&l.y==c)return void(l.active=!0);l={active:!0,rendered:!1,element:k.length?j.element.clone():j.element,x:b,y:c},k.push(l),l.element.css({top:Math.round(c),left:Math.round(b),"text-align":h})},b.prototype.removeText=function(a,b,c,d,f,g){if(null==d){var h=this._textCache[a];if(null!=h)for(var i in h)if(e.call(h,i)){var j=h[i];for(var k in j)if(e.call(j,k))for(var l,m=j[k].positions,n=0;l=m[n];n++)l.active=!1}}else for(var l,m=this.getTextInfo(a,d,f,g).positions,n=0;l=m[n];n++)l.x==b&&l.y==c&&(l.active=!1)},a.plot=function(b,d,e){var f=new c(a(b),d,e,a.plot.plugins);return f},a.plot.version="0.8.2",a.plot.plugins=[],a.fn.plot=function(b,c){return this.each(function(){a.plot(this,b,c)})}}(a),a}),define("widgets/continuousGraph",["jquery","jqueryui/widget","flot"],function(a){"use strict";a.widget("ted.continuousGraph",{options:{label:"Label",numberOfDataPoints:120,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!0}},colors:["#ff0000"],yaxis:{min:0,max:5e3},xaxis:{show:!1},legend:{backgroundOpacity:0}}},_create:function(){this.data=[];for(var b=0;b<this.options.numberOfDataPoints;b++)this.data.push([b,this.options.initialValue]);this.ui=a.plot(this.element,[{label:this.options.label,data:this.data}],this.options.flotConfig),this._refresh()},_refresh:function(){this.ui.draw()},_setOption:function(a,b){this._super(a,b),this._refresh()},update:function(a){this.data.length===this.options.numberOfDataPoints&&(this.data=this.data.slice(1)),this.data.push(Math.min(a,this.options.flotConfig.yaxis.max));for(var b=[],c=0;c<this.data.length;c++)b.push([c,this.data[c]]);this.ui.setData([{label:this.options.label,data:b}]),this._refresh()}})}),define("widgets/multiSeriesIndexGraph",["jquery","jqueryui/widget","flot"],function(a){"use strict";a.widget("ted.multiSeriesIndexGraph",{options:{labels:["Label"],initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!0}},colors:["#00ff00"],yaxis:{min:0,max:100},xaxis:{show:!1},legend:{backgroundOpacity:0}},numberOfDataPoints:120},_create:function(){this.data=[];for(var b=0;b<this.options.labels.length;b++){this.data[b]=[];for(var c=0;c<this.options.numberOfDataPoints;c++)this.data[b].push(this.options.initialValue)}this.ui=a.plot(this.element,this._graphData(),this.options.flotConfig),this._refresh()},_refresh:function(){this.ui.draw()},_setOption:function(a,b){this._super(a,b),this._refresh()},_graphData:function(){for(var a=[],b=0;b<this.data.length;b++){for(var c=[],d=0;d<this.options.numberOfDataPoints;d++)c.push([d,this.data[b][d]]);a.push({label:this.options.labels[b],data:c})}return a},update:function(a){if(this.data[0].length===this.options.numberOfDataPoints)for(var b=0;b<this.data.length;b++)this.data[b]=this.data[b].slice(1);for(var c=0;c<a.length;c++)this.data[c].push(Math.min(a[c],this.options.flotConfig.yaxis.max));this.ui.setData(this._graphData()),this._refresh()}})}),define("widgets/videoQos",["lodash","jquery","jqueryui/widget","widgets/continuousGraph","widgets/multiSeriesIndexGraph"],function(a,b){"use strict";b.widget("ted.videoQos",{options:{bandwidth:0,bufferLength:0,backBufferLength:0,loadLevel:0,nextLevel:0,currentLevel:0},_create:function(){var c="";a(["bandwidth","buffer","level"]).forEach(function(a){c+='<div id="'+a+'-graph" class="qos-player-graph"></div>'}),this.element.append('<div class="qos-graph-container">'+c+"</div>");var d=b("#bandwidth-graph");this.bwGraph=d,this.bwGraph.continuousGraph({label:"Bandwidth (kbps)",numberOfDataPoints:300,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!0}},colors:["#ff0000"],yaxis:{min:0,max:5e3},xaxis:{show:!1},legend:{backgroundOpacity:0}}});var e=b("#buffer-graph");this.bufferGraph=e,this.bufferGraph.multiSeriesIndexGraph({labels:["Buffer","Back Buffer"],numberOfDataPoints:300,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{fill:!1}},colors:["#00ff00","#0000ff"],yaxis:{min:0,max:100},xaxis:{show:!1},legend:{backgroundOpacity:0}}});var f=b("#level-graph");this.levelGraph=f,this.levelGraph.multiSeriesIndexGraph({labels:["Load level","Next level","Current level"],numberOfDataPoints:300,initialValue:0,flotConfig:{series:{shadowSize:0,lines:{show:!0,fill:!1}},colors:["#F3610D","#644089","#dbe66b"],yaxis:{min:0,max:7},xaxis:{show:!1},legend:{backgroundOpacity:0}}}),this._refresh()},_refresh:function(){this.bwGraph.continuousGraph("update",parseInt(this.options.bandwidth/1e3,10)),this.bufferGraph.multiSeriesIndexGraph("update",[parseInt(this.options.bufferLength,10),parseInt(this.options.backBufferLength,10)]),this.levelGraph.multiSeriesIndexGraph("update",[parseInt(this.options.loadLevel,10),parseInt(this.options.nextLevel,10),parseInt(this.options.currentLevel,10)])},_setOption:function(a,b){this._super(a,b),this._refresh()},_destroy:function(){this.element.children(".qos-graph-container").remove()}})}),define("jqueryui/core",["jquery"],function(a){return function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"@VERSION",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(a),a}),define("lib/qos",["widgets/videoQos","jqueryui/core"],function(){"use strict";function a(){return c.player.is(":data(tedVideoQos)")}function b(){var b=c.player,d=!1;"flash"===b.player("mode")&&(b.on("playermetricsdata",function(c,e){d&&a()&&b.videoQos("option",e.metricsData)}),b.on("playermetricstoggle",function(){d=!d,d?a()||b.videoQos():a()&&b.videoQos("destroy")}))}var c={player:null};return c.initQos=b,c}),function(a){"use strict";var b=function(a,c,d){return 1===arguments.length?b.get(a):b.set(a,c,d)};b._document=document,b._navigator=navigator,b.defaults={path:"/"},b.get=function(a){return b._cachedDocumentCookie!==b._document.cookie&&b._renewCache(),b._cache[a]},b.set=function(c,d,e){return e=b._getExtendedOptions(e),e.expires=b._getExpiresDate(d===a?-1:e.expires),b._document.cookie=b._generateCookieString(c,d,e),b},b.expire=function(c,d){return b.set(c,a,d)},b._getExtendedOptions=function(c){return{path:c&&c.path||b.defaults.path,domain:c&&c.domain||b.defaults.domain,expires:c&&c.expires||b.defaults.expires,secure:c&&c.secure!==a?c.secure:b.defaults.secure}},b._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())},b._getExpiresDate=function(a,c){switch(c=c||new Date,typeof a){case"number":a=new Date(c.getTime()+1e3*a);break;case"string":a=new Date(a)}if(a&&!b._isValidDate(a))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return a},b._generateCookieString=function(a,b,c){a=encodeURIComponent(a),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),c=c||{};var d=a+"="+b;return d+=c.path?";path="+c.path:"",d+=c.domain?";domain="+c.domain:"",d+=c.expires?";expires="+c.expires.toGMTString():"",d+=c.secure?";secure":""},b._getCookieObjectFromString=function(c){for(var d={},e=c?c.split("; "):[],f=0;f<e.length;f++){var g=b._getKeyValuePairFromCookieString(e[f]);d[g.key]===a&&(d[g.key]=g.value)}return d},b._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("=");return b=0>b?a.length:b,{key:decodeURIComponent(a.substr(0,b)),value:decodeURIComponent(a.substr(b+1))}},b._renewCache=function(){b._cache=b._getCookieObjectFromString(b._document.cookie),b._cachedDocumentCookie=b._document.cookie},b._areEnabled=function(){return b._navigator.cookieEnabled||"1"===b.set("cookies.js",1).get("cookies.js")},b.enabled=b._areEnabled(),"function"==typeof define&&define.amd?define("Cookies",[],function(){return b}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.Cookies=b):window.Cookies=b}(),define("lib/currentUserId",["Cookies"],function(a){"use strict";var b="_ted_user_id";return{get:function(){return a.get(b)}}}),define("lib/favorite",["exports","jquery","lib/ga","lib/currentUserId","lib/pubSub"],function(a,b,c,d,e){"use strict";function f(a){var b=!!d.get();return b||a.reject(new Error("Not logged in")),b}var g=b.Deferred;a.add=function(a){var d=new g,h=d.promise();return f(d)?(b.post("/favorites",a).then(function(a){e("favorite.add").publish(a),d.resolve(a),c.sendEvent("favorite","add",a.itemType.toLowerCase())},function(){d.reject(new Error("Rejected by server"))}),h):h},a.get=function(a){var c=new g,d=c.promise();return f(c)?(b.getJSON("/favorites/find",a).then(function(a){c.resolve(a)},function(){c.reject(new Error("Rejected by server"))}),d):d},a.remove=function(a){var c=new g,d=c.promise();if(!f(c))return d;var h={data:a,dataType:"json",type:"DELETE",url:"/favorites/"+a.id};return b.ajax(h).then(function(a){e("favorite.remove").publish(a),c.resolve(a)},function(){c.reject(new Error("Rejected by server"))}),d}}),define("Modernizr",[],function(){"use strict";return window.Modernizr}),define("lib/personalStorage",["lodash","Modernizr","exports","lib/currentUserId"],function(a,b,c,d){"use strict";function e(b,d){var e=a.toArray(arguments);return c.storageAdapter?(e[1]=c.getKey(d),b.apply(c.storageAdapter,e.slice(1))):!1}c.storageAdapter=b.localstorage?window.localStorage:void 0,c.getKey=function(a){var b=d.get();return b||(b="0"),b+"-"+a},c.getItem=a.wrap(function(a){return c.storageAdapter.getItem(a)},e),c.setItem=a.wrap(function(a,b){c.storageAdapter.setItem(a,b)},e),c.removeItem=a.wrap(function(a){c.storageAdapter.removeItem(a)},e)}),define("lib/watchLaterLocal",["exports","jquery","lodash","Modernizr","lib/currentUserId","lib/personalStorage"],function(a,b,c,d,e,f){"use strict";function g(a){return+a.split("|",1).pop()}function h(a){return(a.match(/(\|\d+)+/)||"|")[0]+"|"}function i(b){var c=new j,d=c.promise(),e=a._checkCapability();return e!==!0?(c.reject(e),d):(b.apply(c,Array.prototype.splice.call(arguments,1)),d)}var j=b.Deferred,k="wl",l=null,m=18e4,n=null;a.addPlaylist=function(b){return a._add("playlists",b)},a.addTalk=function(b){return a._add("talks",b)},a.checkPlaylist=function(b){return a._check("playlists",b)},a.checkTalk=function(b){return a._check("talks",b)},a.count=c.wrap(function(){var b=this;a._getCache().then(function(a){b.resolve({total:a.talksCount+a.playlistsCount,talks:a.talksCount,playlists:a.playlistsCount})},function(a){b.reject(a)})},i),a.removePlaylist=function(b){return a._remove("playlists",b)},a.removeTalk=function(b){return a._remove("talks",b)},a.sync=c.wrap(function(){if(n)return n;var d=this;return n=d.promise(),b.get("/saved_items/sync.txt").then(function(b){return b=+new Date+";"+b,(l=a._fromS(b))?(f.setItem(k,b),void d.resolve(l)):void d.reject(new Error("Invalid response"))},function(){d.reject(new Error("Rejected by server"))}).always(c.delay(function(){n=null},m)),n},i),a._add=c.wrap(function(b,c){var d=this;a._check(b,c).then(function(e){e||(l[b+"List"]+=c+"|",l[b+"Count"]++,f.setItem(k,a._toS(l))),d.resolve(l)},function(a){d.reject(a)})},i),a._check=c.wrap(function(b,c){var d=this;a._getCache().then(function(a){d.resolve(-1!==a[b+"List"].indexOf("|"+c+"|"))},function(a){d.reject(a)})},i),a._checkCapability=function(){return d.localstorage?e.get()?!0:new Error("Not logged in"):new Error("No localStorage")},a._getCache=function(){var b=new j,c=b.promise();return l?(b.resolve(l),c):(l=a._fromS(f.getItem(k)),l?(b.resolve(l),+new Date-+l.lastSync>m&&a.sync()):a.sync().then(function(){b.resolve(l)},function(a){b.reject(a)}),c)},a._remove=c.wrap(function(b,c){var d=this;a._check(b,c).then(function(e){e&&(l[b+"List"]=l[b+"List"].replace("|"+c+"|","|"),l[b+"Count"]--,f.setItem(k,a._toS(l))),d.resolve(l)},function(a){d.reject(a)})},i),a._reset=function(){l=null,n=null},a._fromS=function(a){if(!a)return null;if(!a.match(/^\d+;\d+(\|\d+)*;\d+(\|\d+)*$/))return null;var b=a.split(";");return{lastSync:+b[0],talksCount:g(b[1]),talksList:h(b[1]),playlistsCount:g(b[2]),playlistsList:h(b[2])}},a._toS=function(a){return a?[a.lastSync,a.talksCount+a.talksList.slice(0,-1),a.playlistsCount+a.playlistsList.slice(0,-1)].join(";"):null}}),define("lib/watchLater",["exports","jquery","lodash","Modernizr","lib/ga","lib/currentUserId","lib/watchLaterLocal","lib/pubSub"],function(a,b,c,d,e,f,g,h){"use strict";function i(a){return d.localstorage?f.get()?!0:(a.reject(new Error("Not logged in")),!1):(a.reject(new Error("No localStorage")),!1)}var j=b.Deferred,k=[];a.add=function(a){var c=new j,d=c.promise();return i(c)?(b.post("/saved_items",a).then(function(a){g["add"+a.itemType](a.itemId),h("watchLater.add").publish(a),c.resolve(a),e.sendEvent("watchLater","add",a.itemType.toLowerCase())},function(){c.reject(new Error("Rejected by server"))}),d):d},a.get=function(a){var d=new j,e=d.promise();if(!i(d))return e;var f={itemId:a.itemId,itemType:a.itemType},g=c.find(k,f);return g?g.promise:(f.promise=e,k.push(f),b.getJSON("/saved_items/find",a).then(function(a){d.resolve(a)},function(){d.reject(new Error("Rejected by server"))}),e)},a.remove=function(a){var c=new j,d=c.promise();if(!i(c))return d;var e={data:a,dataType:"json",type:"DELETE",url:"/saved_items/"+a.id};return b.ajax(e).then(function(a){g["remove"+a.itemType](a.itemId),h("watchLater.remove").publish(a),c.resolve(a)},function(){c.reject(new Error("Rejected by server"))}),d},a.update=function(a){var c=new j,d=c.promise();if(!i(c))return d;var e={data:a,dataType:"json",type:"PUT",url:"/saved_items/"+a.id};return b.ajax(e).then(function(a){c.resolve(a)},function(){c.reject(new Error("Rejected by server"))}),d},a._reset=function(){k=[]}}),define("utils/share",["jquery","lodash","lib/ga"],function(a,b,c){"use strict";var d={media:a('meta[property="og:image"]').first().attr("content"),height:450,message:"",url:location.href,width:500,utmSource:"tedcomshare",utmMedium:"social",utmCampaign:"tedspread"},e=encodeURIComponent,f={email:{href:"mailto:?subject=<%= message %>&body=<%= email %>",ga:"email",utmMedium:"email"},facebook:{href:"//www.facebook.com/sharer/sharer.php?u=<%= url %>",ga:"facebook",utmSource:"facebook.com"},gplus:{href:"//plus.google.com/share?url=<%= url %>",ga:"googlePlus",utmSource:"plus.google.com"},linkedin:{href:"//www.linkedin.com/shareArticle?mini=true&url=<%= url %>&title=<%= message %>&source=TED",ga:"linkedIn",height:500,utmSource:"linkedin.com"},twitter:{href:"//twitter.com/intent/tweet?url=<%= url %>&text=<%= message %>",ga:"twitter",utmSource:"twitter.com"},pinterest:{href:"//pinterest.com/pin/create/button/?url=<%= url %>&media=<%= media %>",ga:"pinterest",utmSource:"pinterest.com"}};return function(a,g){var h=f[a];if(!h)return!1;g=b.merge({},d,h,g);var i=g.url+(-1===g.url.indexOf("?")?"?":"&")+"utm_source="+g.utmSource+"&utm_medium="+g.utmMedium+"&utm_campaign="+g.utmCampaign,j=b.template(g.href,{url:e(i),message:e(g.message),media:e(g.media),email:e(g.message+"\n"+i)});j.match(/mailto:/)?window.location.href=j:window.open(j,"sharingpopup",["scrollbars=1","resizable=1","height="+g.height,"width="+g.width].join(",")).focus(),c.sendSocial(a,"start",g.url)}}),define("utils/timeFromUrl",[],function(){"use strict";return function(a){var b,c,d,e={offset:!0};return a||(a=document.location.href),b=a.match(/#t=(\d+)m(\d+)s[^\/]*/),b&&(c=parseInt(b[1],10),d=parseInt(b[2],10)+60*c,e.offset=!1),b=a.match(/#t-(\d+)[^\/]*/),b&&(d=parseInt(b[1],10)/1e3),b=a.match(/#(\d+)[^\/]*/),b&&(d=parseInt(b[1],10)),e.seconds=d,e}}),define("views/mixins/cached-find",["exports"],function(a){"use strict";a._findEls=null,a.find=function(a){if(this._findEls||(this._findEls={}),this._findEls[a])return this._findEls[a];var b=this.$el.find(a);return b.length&&(this._findEls[a]=b),b}}),define("templates/helpers/ifCond",["Handlebars"],function(a){"use strict";a.registerHelper("ifCond",function(a,b,c,d){switch(b){case"!=":case"!==":return a!==c?d.fn(this):d.inverse(this);case"==":case"===":return a===c?d.fn(this):d.inverse(this);case"===":return a===c?d.fn(this):d.inverse(this);case"<":return c>a?d.fn(this):d.inverse(this);case"<=":return c>=a?d.fn(this):d.inverse(this);case">":return a>c?d.fn(this):d.inverse(this);case">=":return a>=c?d.fn(this):d.inverse(this);case"&&":return a&&c?d.fn(this):d.inverse(this);case"||":return a||c?d.fn(this):d.inverse(this);default:return d.inverse(this)}})}),define("hbs!templates/language-list",["hbs","hbs/handlebars","templates/helpers/ifCond"],function(a,b){var c=b.template({1:function(a,b,c,d){var e,f;return'    <li class="language-list__item">\n      <a class="language checkable" href="#" data-language-code="'+this.escapeExpression((f=null!=(f=b.languageCode||(null!=a?a.languageCode:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"languageCode",hash:{},data:d}):f))+'">\n        <div class="language__exonym">\n          <span class="language__label checkable__label">'+this.escapeExpression((f=null!=(f=b.languageName||(null!=a?a.languageName:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"languageName",hash:{},data:d}):f))+"</span>\n        </div>\n"+(null!=(e=(b.ifCond||a&&a.ifCond||b.helperMissing).call(a,null!=a?a.languageName:a,"!=",null!=a?a.endonym:a,{name:"ifCond",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:"")+"      </a>\n    </li>\n"},2:function(a,b,c,d){var e;return'          <div class="language__endonym" lang="'+this.escapeExpression((e=null!=(e=b.ianaCode||(null!=a?a.ianaCode:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"ianaCode",hash:{},data:d}):e))+'">\n            <span class="language__label checkable__label">'+this.escapeExpression((e=null!=(e=b.endonym||(null!=a?a.endonym:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"endonym",hash:{},data:d}):e))+"</span>\n          </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<ul class="m3 sl language-list">\n'+(null!=(e=b.each.call(a,null!=a?a.languages:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"</ul>\n"},useData:!0});return b.registerPartial("templates/language-list",c),b.registerPartial("templates/language-list",c),c}),define("templates/helpers/icon",["Handlebars"],function(a){"use strict";function b(a,b,d){return a=c(a),b=c(b),d=c(d),'<i class="icon icon_'+a+" "+(d||"")+'">'+(b?"<span class=screen-reader-text>"+b+"</span>":"")+"</i>"}var c=a.Utils.escapeExpression;return a.registerHelper("icon",function(c,d,e){return new a.SafeString(b(c,d,e))}),b}),define("hbs!templates/subtitle-modal",["hbs","hbs/handlebars","hbs!templates/language-list","templates/helpers/icon"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n  <h3 class="modal__head__title">\n    '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"subtitle",null,"modal__head__icon",{name:"icon",hash:{},data:d}))+'\n    Language\n  </h3>\n</div>\n\n<div class="m3">\n  <a class="Subtitle-modal__switch checkable checkable--checked" href="#">\n    Subtitles off\n  </a>\n</div>\n\n<div class="m3 Subtitle-modal__list">\n'+(null!=(e=this.invokePartial(c["templates/language-list"],a,{name:"templates/language-list",data:d,indent:"  ",helpers:b,partials:c}))?e:"")+'</div>\n\n<hr>\n\nTED Talks are subtitled by volunteers.\nDon\'t see your language?\n<a href="http://www.ted.com/participate/translate/get-started" target="_blank">Help us translate</a>!\n'},usePartial:!0,useData:!0});return b.registerPartial("templates/subtitle-modal",c),c}),define("templates/helpers/t",["Handlebars"],function(a){"use strict";a.registerHelper("t",function(a){return a})}),define("hbs!templates/modalDefault",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n  </a>\n  <h3 class="modal__head__title">'+this.escapeExpression((e=null!=(e=b.title||(null!=a?a.title:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"title",hash:{},data:d}):e))+"</h3>\n</div>\n"},useData:!0});return b.registerPartial("templates/modalDefault",c),c}),define("lib/focus-zone",["jquery","lodash","jqueryui/core"],function(a,b){"use strict";function c(b){this.$el=a(b)}function d(a){a.preventDefault()}var e=a(window);return c.__reset=function(){b.assign(c,{__active:void 0,__isListening:!1,__zones:[]})},c.__addZone=function(a){c.__zones.push(a),c.__setActive(),c.__startListening()},c.__removeZone=function(a){c.__zones=b.without(c.__zones,a),c.__setActive(),c.__stopListening()},c.__setActive=function(){c.__active=b.last(c.__zones)},c.__startListening=function(){c.__isListening||c.__active&&(c.__startListeningInner(),c.__isListening=!0)},c.__startListeningInner=function(){e.on("keydown",c.__keyDown)},c.__stopListening=function(){c.__isListening&&(c.__active||(c.__stopListeningInner(),c.__isListening=!1))},c.__stopListeningInner=function(){e.off("keydown",c.__keyDown)},c.__keyDown=function(e){var f=c.__active;if(f&&e.keyCode===a.ui.keyCode.TAB){var g=e.target,h=f.$el,i=h.find(":tabbable"),j=i.filter(":first"),k=i.filter(":last");g!==k[0]&&g!==h[0]||e.shiftKey?g!==j[0]&&g!==h[0]||!e.shiftKey?-1===b.indexOf(i,g)&&(j.focus(),d(e)):(k.focus(),d(e)):(j.focus(),d(e))}},b.assign(c.prototype,{activate:function(){return this._recordFocus(),c.__addZone(this),this},deactivate:function(){return c.__removeZone(this),this._restoreFocus(),this},_recordFocus:function(){this.$focus=a(":focus")},_restoreFocus:function(){this.$focus&&this.$focus.length&&this.$focus.focus()}}),c.__reset(),c}),define("widgets/modal",["jquery","lodash","hbs!templates/modalDefault","lib/pubSub","lib/focus-zone","jqueryui/widget","lib/resize"],function(a,b,c,d,e){"use strict";function f(){l||(k=a(window),i=a(document.body),j=a("html"))}var g,h,i,j,k,l=0,m="modal-backdrop--show",n="modal--show",o="modal-open",p="modal__content",q=0;return h=["<div class=modal>","<div class=modal__outer>","<div class=modal__inner>"].join(""),
d("breakpoint").subscribe(function(a){g=768>a}),a.widget("ted.modal",{options:{align:"middle",autoOpen:!0},_create:function(){var b=this;f(),this.options.title&&this.element.prepend(c(this.options)),this.modal=this.element.addClass(p).css("display","").wrap(h).closest("div.modal"),this.modal.addClass("modal--align-"+this.options.align);var d=a("<div class=modal-backdrop>");this.backdrop=d;var j=a("<div class=modal-wrapper>");this.wrapper=j,j.append(this.backdrop).append(this.modal),this.focusZone=new e(this.modal),this.wrapper.on("click",function(c){return g?!0:a(c.target).closest("div.modal__content").length?!0:(c.preventDefault(),void b.close())}),i.append(this.wrapper),this._on({"click a.modal__close":function(a){a.preventDefault(),b.close()},keyup:function(c){c.preventDefault(),c.keyCode===a.ui.keyCode.ESCAPE&&b.close()}}),this.options.autoOpen&&b.open()},_destroy:function(){var a=this;b.defer(function(){a.wrapper.remove()})},open:function(){var a=this;return this._hasOpened?(a.backdrop.addClass(m),a.openedAt={y:k.scrollTop()},q++||j.addClass(o),g&&window.scrollTo(0,0),a.modal.addClass(n),a.focusZone.activate(),this.element.attr("tabindex",0),this.element.focus(),void a._trigger("open")):void window.setTimeout(function(){a._hasOpened||(a._hasOpened=!0,a.open())},10)},close:function(){this.modal.removeClass(n),--q||j.removeClass(o),this.openedAt&&window.scrollTo(0,this.openedAt.y),this.backdrop.removeClass(m),this.element.attr("tabindex",-1),this.focusZone.deactivate(),this._trigger("close")}}),function(b,c){return a(b).modal(c)}}),define("views/subtitle-modal",["jquery","lodash","Backbone","views/mixins/cached-find","hbs!templates/subtitle-modal","hbs!templates/language-list","widgets/modal"],function(a,b,c,d,e,f){"use strict";var g="checkable--checked",h=c.View.extend({className:"Subtitle-modal",template:e,events:{"click a.language":"_clickLanguage","click a.Subtitle-modal__switch":"_clickSwitch"},_rendered:!1,close:function(){return this.$el.modal("close"),this},initialize:function(a){var d=this;return d.state=new c.Model(b.extend({isOpen:!1,selected:!1},a||{})),d.listenTo(d.state,"change:selected",d._actSelected),d.listenTo(d.state,"change:languages",d._rerenderLanguages),this},open:function(){return this.$el.modal("open"),this},render:function(){var a=this;return a.$el.addClass("subtitle-modal").html(a.template(a.state.toJSON())).modal({autoOpen:!1}).on("modalclose",function(){a.trigger("close"),a.state.set("isOpen",!1)}).on("modalopen",function(){a.trigger("open"),a.state.set("isOpen",!0)}),a._rendered=!0,this._actSelected(),this},_actSelected:function(){var a=this.state.get("selected"),b=this.find("a.language");b.removeClass(g),a&&b.filter('[data-language-code="'+a+'"]').addClass(g),this.find("a.Subtitle-modal__switch")[a?"removeClass":"addClass"](g)},_clickLanguage:function(b){b.preventDefault();var c=a(b.target).closest("a.language"),d=c.data("language-code")||!1;this.state.set("selected",d)},_clickSwitch:function(a){a.preventDefault(),this.state.set("selected",!1)},_rerenderLanguages:function(){if(this._rendered){var a=this.state.get("languages");this.find("div.Subtitle-modal__list").html(f({languages:a}))}}});return b.extend(h.prototype,d),h}),define("hbs!templates/talkEndCard",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/formatDuration"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'        <li class="talk-end-card__item">\n          <a class="l3 talk-end-card__link ga-link" href="/talks/'+this.escapeExpression((e=null!=(e=b.slug||(null!=a?a.slug:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"slug",hash:{},data:d}):e))+'" data-ga-category="talk.relatedTalk">\n            <img class="talk-end-card__image" src="'+this.escapeExpression((e=null!=(e=b.image||(null!=a?a.image:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"image",hash:{},data:d}):e))+'" alt="'+this.escapeExpression((e=null!=(e=b.title||(null!=a?a.title:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"title",hash:{},data:d}):e))+'">\n\n            <div class="talk-end-card__speaker">'+this.escapeExpression((e=null!=(e=b.speaker||(null!=a?a.speaker:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"speaker",hash:{},data:d}):e))+'</div>\n            <div class="talk-end-card__title">'+this.escapeExpression((e=null!=(e=b.title||(null!=a?a.title:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"title",hash:{},data:d}):e))+'</div>\n            <div class="talk-end-card__duration">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=a?a.duration:a,{name:"formatDuration",hash:{},data:d}))+"</div>\n          </a>\n        </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="talk-end-card">\n  <h2 class="talk-end-card__headline">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"More TED Talks",{name:"t",hash:{},data:d}))+'</h2>\n\n  <div class="talk-end-card__container">\n    <ul class="talk-end-card__list">\n'+(null!=(e=b.each.call(a,null!=a?a.relatedTalks:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"    </ul>\n  </div>\n</div>\n"},useData:!0});return b.registerPartial("templates/talkEndCard",c),c}),define("hbs!templates/talkViewsBreakdown",["hbs","hbs/handlebars"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'      <li class="talk-breakdown__source">\n        <span class="talk-breakdown__source__bar" style="width:'+this.escapeExpression((e=null!=(e=b.width||(null!=a?a.width:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"width",hash:{},data:d}):e))+'%"></span>\n        <span class="talk-breakdown__source__label">'+this.escapeExpression((e=null!=(e=b.value||(null!=a?a.value:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"value",hash:{},data:d}):e))+"% "+this.escapeExpression((e=null!=(e=b.label||(null!=a?a.label:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"label",hash:{},data:d}):e))+"</span>\n      </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="talk-breakdown">\n  <p><strong>This number combines views from the following outlets:</strong></p>\n\n  <ul class="sl talk-breakdown__sources">\n'+(null!=(e=b.each.call(a,null!=a?a.sources:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"  </ul>\n</div>\n"},useData:!0});return b.registerPartial("templates/talkViewsBreakdown",c),c}),define("hbs!templates/commentApologyModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Could not save comment",{name:"t",hash:{},data:d}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Sorry: we're currently experiencing difficulties and were unable to save your comment.",{name:"t",hash:{},data:d}))+"</p>\n</div>\n"},useData:!0});return b.registerPartial("templates/commentApologyModal",c),c}),define("lib/currentUser",["jquery","lodash","lib/currentUserId","lib/personalStorage"],function(a,b,c,d){"use strict";function e(a){return b.isFinite(a)?+a:null}function f(a){return a?""+a:null}function g(a){return a=b.pick(a,z),b.forOwn(a,function(b,c){a[c]=y[c](b)}),a}function h(a){return a&&JSON.parse(a)}function i(){return g(h(v.storageAdapter.getItem(w)))}function j(){return a.ajax({dataType:"json",url:"/me",data:{c:c.get()+"-"+Math.round(+new Date/1e3/120)},timeout:3e3})}function k(){r=null,v.storageAdapter.removeItem(w),a(document.documentElement).removeClass("loggedin").addClass("loggedout")}function l(a){k(),a.reject()}function m(){return v._check(r)}function n(a){var b=m();return b?a.resolve(r):(k(),a.reject()),b}function o(a,b){if(!b)return void l(a,b);if(b.unavailable&&b.unavailable.length)for(var c=i(),d=b.unavailable,e=d.length;e--;)b[d[e]]=c[d[e]]||b[d[e]];b.lastDownloaded=(new Date).getTime(),r=g(b),n(a)&&v.storageAdapter.setItem(w,JSON.stringify(r))}function p(a){j().then(b.bind(o,v,a),b.bind(l,v,a))}function q(a,b){var c=(new Date).getTime();return a>c-(b||0)}var r,s=function(a){return!!a},t=function(a){return a},u=a.Deferred,v={},w="me",x=!0,y={id:e,profileId:e,firstName:f,lastName:f,avatarUrl:f,hasConferences:s,upcomingConferences:t,isCommentModerator:s,hasEdActivity:s,isTEDxOrganizer:s,lastDownloaded:e},z=b.keys(y);return v.storageAdapter=d,v.getDetails=function(){var a=new u;return r=r||i(),m()||(r=null),r?(a.resolve(r),x&&!q(18e4,r.lastDownloaded)&&(x=!1,p(new u))):c.get()?p(a):a.reject(),a.promise()},v._check=function(a){var d=864e5;return a&&+a.id===+c.get()&&z.length===b.keys(b.pick(a,z)).length&&q(d,a.lastDownloaded)},v._reset=function(){r=void 0,x=!0},v}),define("lib/browserDetect",["exports"],function(a){"use strict";function b(a){for(var b=0;b<a.length;b++){var c=a[b].string,e=a[b].prop;if(d=a[b].versionSearch||a[b].identity,c){if(-1!==c.indexOf(a[b].subString))return a[b].identity}else if(e)return a[b].identity}}function c(a){var b=a.indexOf(d);if(-1!==b)return parseFloat(a.substring(b+d.length+1))}var d,e=window.navigator,f=[{string:e.userAgent,subString:"Chrome",identity:"Chrome"},{string:e.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:e.userAgent,subString:"Firefox",identity:"Firefox"},{string:e.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:e.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"}];a.browser=b(f)||"Unknown Browser",a.version=c(window.navigator.userAgent)||c(window.navigator.appVersion)||"Unknown Version"}),define("utils/ted",[],function(){"use strict";var a=function(){var a=window.navigator,b=a?a.userAgent.toLowerCase():"";if(-1!==b.indexOf("chrome"))return!1;var c=b.match(/macintosh.*os x.*applewebkit.*version\/([\d]+).*safari/);return c?!(+c[1]<7):!1};return function(b){return window.TED?"playerPath"===b?a()?window.TED.playerPathLocal:window.TED.playerPathRemote:window.TED[b]:""}}),define("lib/errorCollector",["jquery","lodash","lib/browserDetect","lib/currentUserId","utils/ted","exports"],function(a,b,c,d,e,f){"use strict";f.post=b.throttle(function(b){a.post("/error_collector.php",{message:b})},5e3),f.log=function(b,g){f.post(a.extend({message:b,context:"js",uri:window.location.href,client_name:c.browser,client_version:c.version,elapsed_seconds:Math.floor((+new Date-e("startTime"))/1e3),profile_id:d.get()||"N/A",user_agent:window.navigator?window.navigator.userAgent:"Unknown User Agent"},g||{}))}}),define("hbs!templates/authPromptModal",["hbs","hbs/handlebars","templates/helpers/icon"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="auth-prompt__section auth-prompt__header">\n  <h2 class="auth-prompt__header__title">\n    Log in to\n    TED\n  </h2>\n\n  <a href="#" class="modal__close auth-prompt__close">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n</div>\n\n<div class="auth-prompt__section auth-prompt__options">\n  <form class="auth-prompt__option auth-prompt__option--standard">\n    <div class="auth-prompt__message">\n      Your email or password was incorrect.\n    </div>\n\n    <div class="m3">\n      <label class="form-label">Email</label>\n      <input class="form-control auth-prompt__email" name="user[email]" type="email">\n    </div>\n\n    <div class="m3">\n      <label class="form-label">Password</label>\n      <input class="form-control auth-prompt__password" name="user[password]" type="password">\n    </div>\n\n    <div class="m3">\n      <label>\n        <input class="auth-prompt__remember" type="checkbox" checked name="user[remember_me]">\n        <span class="form-label" style="display:inline; margin-left: 2px;">\n          Remember me\n        </span>\n      </label>\n    </div>\n\n    <div>\n      <button class="button button--dark auth-prompt__login">Log in</button>\n      <a class="l3 auth-prompt__halp" href="'+this.escapeExpression((e=null!=(e=b.signInHelpUrl||(null!=a?a.signInHelpUrl:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"signInHelpUrl",hash:{},data:d}):e))+'" target="_blank">Need help logging in?</a>\n    </div>\n  </form>\n\n  <div class="auth-prompt__option auth-prompt__option--social">\n    <button class="button button--wide button--dark button--labeled button--facebook auth-prompt__facebook">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"facebook","","button__icon",{name:"icon",hash:{},data:d}))+'\n      <span class="button__label">Log in with Facebook</span>\n    </button>\n  </div>\n</div>\n\n<div class="auth-prompt__section auth-prompt__footer">\n  <span class="auth-prompt__footer__question">Don\'t have an account yet?</span>\n  <a class="l3" href="'+this.escapeExpression((e=null!=(e=b.signUpUrl||(null!=a?a.signUpUrl:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"signUpUrl",hash:{},data:d}):e))+'" target="_blank">Sign up</a>\n</div>\n\n<div class="auth-prompt__thinking"></div>\n'},useData:!0});return b.registerPartial("templates/authPromptModal",c),c}),define("views/AuthPromptView",["lodash","Modernizr","Backbone","lib/auth","hbs!templates/authPromptModal","utils/ted","spinjs","widgets/modal"],function(a,b,c,d,e,f,g){"use strict";function h(){d||(d=require("lib/auth"))}var i=c.View.extend({template:e,events:{"click button.auth-prompt__facebook":"facebook","click button.auth-prompt__login":"login","submit form.auth-prompt__option--standard":"login"},close:function(){this.$el.modal("close")},open:function(){this.$el.removeClass("auth-prompt--error"),this.$el.modal("open"),this.$email.focus()},login:function(a){a&&a.preventDefault(),this._startThinking(),h(),d.login(this.$email.val(),this.$password.val(),this.$remember.val()).then(this._loginSuccess,this._loginFailure).always(this._stopThinking),this.$password.val("")},facebook:function(a){a&&a.preventDefault(),this._startThinking(),h(),d.facebook().then(this._facebookSuccess,this._facebookFailure).always(this._stopThinking)},initialize:function(){var a=this;this._loginSuccess=function(){a.close(),a.trigger("login.success")},this._facebookSuccess=this._loginSuccess,this._loginFailure=function(b){b&&b.responseJSON&&a.$el.find(".auth-prompt__message").html(b.responseJSON.error),a.$el.addClass("auth-prompt--error"),a.trigger("login.failure")},this._facebookFailure=function(){a.trigger("login.failure")},this._stopThinking=function(){a.$thinkers.prop("disabled",!1),a.$el.removeClass("auth-prompt--thinking"),a._spinner&&a._spinner.stop()}},render:function(){var a=this;return this.$el.addClass("auth-prompt").html(a.template({signInHelpUrl:f("signInHelpUrl"),signUpUrl:f("signUpUrl")})).modal({autoOpen:!1}).on("modalclose",function(){a.trigger("close")}).on("modalopen",function(){a.trigger("open")}),this.$email=this.$el.find("input.auth-prompt__email"),this.$password=this.$el.find("input.auth-prompt__password"),this.$remember=this.$el.find("input.auth-prompt__remember"),this.$thinkers=this.$el.find(["form.auth-prompt__option--standard","button.auth-prompt__login","button.auth-prompt__facebook"].join(", ")).add(this.$email).add(this.$password),this},_startThinking:function(){this.$thinkers.prop("disabled",!0),this.$el.addClass("auth-prompt--thinking"),this._spinner||(this._spinner=new g({className:"spinner spinner--centered"})),this._spinner.spin(this.el)}});return i}),define("hbs!templates/authError",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Error",{name:"t",hash:{},data:d}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Sorry, an error occurred. Please log in and try again.",{name:"t",hash:{},data:d}))+'</p>\n  <p><a class="l3" href="/session/new">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Log in",{name:"t",hash:{},data:d}))+"</a></p>\n</div>\n"},useData:!0});return b.registerPartial("templates/authError",c),c}),define("utils/callback",["lodash"],function(a){"use strict";var b=Number(new Date),c="tedc"+b,d=0;return function(b){var e=c+ ++d,f=this;return window[e]=function(){b.apply(f,a.toArray(arguments)),delete window[e]},e}}),define("utils/iframep",["jquery","utils/callback"],function(a,b){"use strict";return function(c){function d(){"pending"===f.state&&(f.reject(),delete window[g])}function e(){var a=i.contentDocument||i.contentWindow&&i.contentWindow.document;window[g]&&window.setTimeout("complete"===a.readyState?d:e,300)}var f=new a.Deferred,g=b(function(a){f.resolve(a)});c=c.replace("callback=?","callback="+g);var h=a("<iframe></iframe>").css({display:"none",width:0,height:0}).appendTo(document.body),i=h.get(0);return h.ready(e).attr("src",c),f.always(function(){h.remove()}),window.setTimeout(d,5e3),f.promise()}}),define("utils/origin",[],function(){"use strict";return window.location.origin||window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}),define("lib/auth",["jquery","lodash","lib/currentUser","lib/errorCollector","Modernizr","views/AuthPromptView","hbs!templates/authError","utils/callback","utils/iframep","utils/origin","lib/pubSub","utils/ted","exports"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(a){a.done(function(a){k("auth.login").publish(a)})}function o(){v?v.open():a(g()).modal()}function p(){if(!y)throw new Error("lib/auth: please check auth.capable() to ensure client support before using auth methods.");if(!m.capable())throw o(),new Error("lib/auth: this client is not capable of using auth methods.")}function q(a,b){return'<meta name="'+a+'" content="'+b+'">'}function r(b){a("head").append(q("csrf-param",b.csrf.param)+q("csrf-token",b.csrf.token))}function s(){return i("/session/check?callback=?").done(r)}function t(a,b){return function(c){a.reject(c),m._reportError(b)}}function u(){f||(f=require("views/AuthPromptView"))}var v,w,x,y=!1,z=window.console;m._openPrompt=function(){x||(u(),x=new f,x.on("close",function(){b.defer(function(){w&&"pending"!==w.state()&&w.reject()})}).on("login.success",function(){m._resolveDetails(w).fail(o)}).render()),x.open()},m._reportError=function(a){var b="Auth error: "+a;d.log(b),z&&z.log&&z.log(b)},m._reset=function(){y=!1,v=void 0,w=void 0,x=void 0},m._resolveDetails=function(a){return c.getDetails().done(function(b){a.resolve(b)})},m.capable=function(){return y=!0,e.cors},m.facebook=function(){function b(a){a&&a.csrf&&r(a),"pending"===e.state()&&(n(e),m._resolveDetails(e).fail(t(e,"unable to corroborate Facebook authentication")),d&&d.close())}p();var c=h(b),d=window.open("/users/new?facebook=true&referer="+encodeURIComponent(j+"/session/check?callback="+c),"authfb",["scrollbars=1","resizable=1","height=480","width=640"].join(",")),e=new a.Deferred,f=0,g=300,i=1e4,k=window.setInterval(function(){f++,(d&&d.closed||!d&&f*g>i)&&(b(),window[c]&&delete window[c],window.clearInterval(k),k=null)},g);return e.promise()},m.login=function(b,c,d){p();var e=new a.Deferred;return m._resolveDetails(e).then(function(a){e.resolve(a)},function(){a.ajax({url:l("authHost")+"/session/new.json",timeout:3e3,type:"GET",xhrFields:{withCredentials:!0}}).then(function(f){n(e),a.ajax({url:l("authHost")+"/session.json",timeout:3e3,type:"POST",data:{authenticity_token:f.authenticity_token,user:{email:b,password:c,remember_me:d}},xhrFields:{withCredentials:!0}}).then(function(){s().then(function(){m._resolveDetails(e).fail(t(e,"unable to corroborate authentication"))},t(e,"session check timed out"))},t(e,"credentials rejected"))},t(e,"could not obtain token"))}),e.promise()},m.logout=function(){p()},m.prompt=function(){p();var b=new a.Deferred;return w=b,m._resolveDetails(b).fail(m._openPrompt),b.promise()},k("auth.login").subscribe(function(){a(document.documentElement).addClass("loggedin").removeClass("loggedout")}),a(function(){a(document).on("click","a.auth-login",function(a){m.capable()&&(a.preventDefault(),m.prompt())})})}),define("hbs!templates/authRequest",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Please log in",{name:"t",hash:{},data:d}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Please log in or sign up to complete this action.",{name:"t",hash:{},data:d}))+'</p>\n  <p><a class="l3" href="/session/new">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Log in or sign up",{name:"t",hash:{},data:d}))+"</a></p>\n</div>\n"},useData:!0});return b.registerPartial("templates/authRequest",c),c}),define("views/AuthView",["jquery","lodash","Backbone","lib/currentUser","lib/auth","hbs!templates/authRequest","widgets/modal"],function(a,b,c,d,e,f){"use strict";function g(){if(h)h.modal("open");else{var b=a(f());h=b.modal()}}var h,i=b.memoize(function(){return d.getDetails()}),j=c.View.extend({demandAuthFor:function(c){if(arguments.length>1)return void this.demandAuthFor(b.toArray(arguments));if(b.isArray(c))return void b.each(c,function(a){this.demandAuthFor(a)},this);var d=this[c];this[c]=function(){function b(){d.apply(f,c)}var c=arguments,f=this;c[0]instanceof a.Event&&c[0].preventDefault(),i().then(b,function(){e.capable()?e.prompt().done(b):g()})}}});return j}),function(a){function b(a,b){return function(c){return i(a.call(this,c),b)}}function c(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function d(){}function e(a){g(this,a)}function f(a){var b=a.years||a.year||a.y||0,c=a.months||a.month||a.M||0,d=a.weeks||a.week||a.w||0,e=a.days||a.day||a.d||0,f=a.hours||a.hour||a.h||0,g=a.minutes||a.minute||a.m||0,h=a.seconds||a.second||a.s||0,i=a.milliseconds||a.millisecond||a.ms||0;this._input=a,this._milliseconds=i+1e3*h+6e4*g+36e5*f,this._days=e+7*d,this._months=c+12*b,this._data={},this._bubble()}function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function h(a){return 0>a?Math.ceil(a):Math.floor(a)}function i(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function j(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&H.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function l(a,b){var c,d=Math.min(a.length,b.length),e=Math.abs(a.length-b.length),f=0;for(c=0;d>c;c++)~~a[c]!==~~b[c]&&f++;return f+e}function m(a){return a?ea[a]||a.toLowerCase().replace(/(.)s$/,"$1"):a}function n(a,b){return b.abbr=a,L[a]||(L[a]=new d),L[a].set(b),L[a]}function o(a){if(!a)return H.fn._lang;if(!L[a]&&M)try{require("./lang/"+a)}catch(b){return H.fn._lang}return L[a]}function p(a){return a.match(/\[.*\]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function q(a){var b,c,d=a.match(P);for(b=0,c=d.length;c>b;b++)ia[d[b]]?d[b]=ia[d[b]]:d[b]=p(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function r(a,b){function c(b){return a.lang().longDateFormat(b)||b}for(var d=5;d--&&Q.test(b);)b=b.replace(Q,c);return fa[b]||(fa[b]=q(b)),fa[b](a)}function s(a,b){switch(a){case"DDDD":return T;case"YYYY":return U;case"YYYYY":return V;case"S":case"SS":case"SSS":case"DDD":return S;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return W;case"a":case"A":return o(b._l)._meridiemParse;case"X":return Z;case"Z":case"ZZ":return X;case"T":return Y;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return R;default:return new RegExp(a.replace("\\",""))}}function t(a){var b=(X.exec(a)||[])[0],c=(b+"").match(ba)||["-",0,0],d=+(60*c[1])+~~c[2];return"+"===c[0]?-d:d}function u(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":e[1]=null==b?0:~~b-1;break;case"MMM":case"MMMM":d=o(c._l).monthsParse(b),null!=d?e[1]=d:c._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=b&&(e[2]=~~b);break;case"YY":e[0]=~~b+(~~b>68?1900:2e3);break;case"YYYY":case"YYYYY":e[0]=~~b;break;case"a":case"A":c._isPm=o(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[3]=~~b;break;case"m":case"mm":e[4]=~~b;break;case"s":case"ss":e[5]=~~b;break;case"S":case"SS":case"SSS":e[6]=~~(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=t(b)}null==b&&(c._isValid=!1)}function v(a){var b,c,d=[];if(!a._d){for(b=0;7>b;b++)a._a[b]=d[b]=null==a._a[b]?2===b?1:0:a._a[b];d[3]+=~~((a._tzm||0)/60),d[4]+=~~((a._tzm||0)%60),c=new Date(0),a._useUTC?(c.setUTCFullYear(d[0],d[1],d[2]),c.setUTCHours(d[3],d[4],d[5],d[6])):(c.setFullYear(d[0],d[1],d[2]),c.setHours(d[3],d[4],d[5],d[6])),a._d=c}}function w(a){var b,c,d=a._f.match(P),e=a._i;for(a._a=[],b=0;b<d.length;b++)c=(s(d[b],a).exec(e)||[])[0],c&&(e=e.slice(e.indexOf(c)+c.length)),ia[d[b]]&&u(d[b],c,a);e&&(a._il=e),a._isPm&&a._a[3]<12&&(a._a[3]+=12),a._isPm===!1&&12===a._a[3]&&(a._a[3]=0),v(a)}function x(a){var b,c,d,f,h,i=99;for(f=0;f<a._f.length;f++)b=g({},a),b._f=a._f[f],w(b),c=new e(b),h=l(b._a,c.toArray()),c._il&&(h+=c._il.length),i>h&&(i=h,d=c);g(a,d)}function y(a){var b,c=a._i,d=$.exec(c);if(d){for(a._f="YYYY-MM-DD"+(d[2]||" "),b=0;4>b;b++)if(aa[b][1].exec(c)){a._f+=aa[b][0];break}X.exec(c)&&(a._f+=" Z"),w(a)}else a._d=new Date(c)}function z(b){var c=b._i,d=N.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?y(b):k(c)?(b._a=c.slice(0),v(b)):b._d=c instanceof Date?new Date(+c):new Date(c)}function A(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function B(a,b,c){var d=K(Math.abs(a)/1e3),e=K(d/60),f=K(e/60),g=K(f/24),h=K(g/365),i=45>d&&["s",d]||1===e&&["m"]||45>e&&["mm",e]||1===f&&["h"]||22>f&&["hh",f]||1===g&&["d"]||25>=g&&["dd",g]||45>=g&&["M"]||345>g&&["MM",K(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,A.apply({},i)}function C(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=H(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function D(a){var b=a._i,c=a._f;return null===b||""===b?null:("string"==typeof b&&(a._i=b=o().preparse(b)),H.isMoment(b)?(a=g({},b),a._d=new Date(+b._d)):c?k(c)?x(a):w(a):z(a),new e(a))}function E(a,b){H.fn[a]=H.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),H.updateOffset(this),this):this._d["get"+c+b]()}}function F(a){H.duration.fn[a]=function(){return this._data[a]}}function G(a,b){H.duration.fn["as"+a]=function(){return+this/b}}for(var H,I,J="2.1.0",K=Math.round,L={},M="undefined"!=typeof module&&module.exports,N=/^\/?Date\((\-?\d+)/i,O=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,P=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,Q=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,R=/\d\d?/,S=/\d{1,3}/,T=/\d{3}/,U=/\d{1,4}/,V=/[+\-]?\d{1,6}/,W=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,X=/Z|[\+\-]\d\d:?\d\d/i,Y=/T/i,Z=/[\+\-]?\d+(\.\d{1,3})?/,$=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,_="YYYY-MM-DDTHH:mm:ssZ",aa=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],ba=/([\+\-]|\d\d)/gi,ca="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),da={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},ea={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},fa={},ga="DDD w W M D d".split(" "),ha="M D H h m s w W".split(" "),ia={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return i(this.year()%100,2)},YYYY:function(){return i(this.year(),4)},YYYYY:function(){return i(this.year(),5)},gg:function(){return i(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return i(this.weekYear(),5)},GG:function(){return i(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return i(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return i(~~(this.milliseconds()/10),2)},SSS:function(){return i(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(~~(a/60),2)+":"+i(~~a%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(~~(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ga.length;)I=ga.pop(),ia[I+"o"]=c(ia[I],I);for(;ha.length;)I=ha.pop(),ia[I+I]=b(ia[I],2);for(ia.DDDD=b(ia.DDD,3),d.prototype={set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=H([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=H([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",
LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return C(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},H=function(a,b,c){return D({_i:a,_f:b,_l:c,_isUTC:!1})},H.utc=function(a,b,c){return D({_useUTC:!0,_isUTC:!0,_l:c,_i:a,_f:b})},H.unix=function(a){return H(1e3*a)},H.duration=function(a,b){var c,d,e=H.isDuration(a),g="number"==typeof a,h=e?a._input:g?{}:a,i=O.exec(a);return g?b?h[b]=a:h.milliseconds=a:i&&(c="-"===i[1]?-1:1,h={y:0,d:~~i[2]*c,h:~~i[3]*c,m:~~i[4]*c,s:~~i[5]*c,ms:~~i[6]*c}),d=new f(h),e&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},H.version=J,H.defaultFormat=_,H.updateOffset=function(){},H.lang=function(a,b){return a?(b?n(a,b):L[a]||o(a),void(H.duration.fn._lang=H.fn._lang=o(a))):H.fn._lang._abbr},H.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),o(a)},H.isMoment=function(a){return a instanceof e},H.isDuration=function(a){return a instanceof f},H.fn=e.prototype={clone:function(){return H(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return r(H(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return null==this._isValid&&(this._a?this._isValid=!l(this._a,(this._isUTC?H.utc(this._a):H(this._a)).toArray()):this._isValid=!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=r(this,a||H.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?H.duration(+b,a):H.duration(a,b),j(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?H.duration(+b,a):H.duration(a,b),j(this,c,-1),this},diff:function(a,b,c){var d,e,f=this._isUTC?H(a).zone(this._offset||0):H(a).local(),g=6e4*(this.zone()-f.zone());return b=m(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-H(this).startOf("month")-(f-H(f).startOf("month")))/d,e-=6e4*(this.zone()-H(this).startOf("month").zone()-(f.zone()-H(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:h(e)},from:function(a,b){return H.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(H(),a)},calendar:function(){var a=this.diff(H().startOf("day"),"days",!0),b=-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse";return this.format(this.lang().calendar(b,this))},isLeapYear:function(){var a=this.year();return a%4===0&&a%100!==0||a%400===0},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?"string"==typeof a&&(a=this.lang().weekdaysParse(a),"number"!=typeof a)?this:this.add({d:a-b}):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),H.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=m(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),this},endOf:function(a){return this.startOf(a).add(a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+H(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+H(a).startOf(b)},isSame:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)===+H(a).startOf(b)},min:function(a){return a=H.apply(null,arguments),this>a?this:a},max:function(a){return a=H.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=t(a)),Math.abs(a)<16&&(a=60*a),this._offset=a,this._isUTC=!0,b!==a&&j(this,H.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return H.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(a){var b=K((H(this).startOf("day")-H(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},weekYear:function(a){var b=C(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=C(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=C(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},lang:function(b){return b===a?this._lang:(this._lang=o(b),this)}},I=0;I<ca.length;I++)E(ca[I].toLowerCase().replace(/s$/,""),ca[I]);E("year","FullYear"),H.fn.days=H.fn.day,H.fn.months=H.fn.month,H.fn.weeks=H.fn.week,H.fn.isoWeeks=H.fn.isoWeek,H.fn.toJSON=H.fn.toISOString,H.duration.fn=f.prototype={_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,i=this._data;i.milliseconds=e%1e3,a=h(e/1e3),i.seconds=a%60,b=h(a/60),i.minutes=b%60,c=h(b/60),i.hours=c%24,f+=h(c/24),i.days=f%30,g+=h(f/30),i.months=g%12,d=h(g/12),i.years=d},weeks:function(){return h(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*~~(this._months/12)},humanize:function(a){var b=+this,c=B(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=H.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=H.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=m(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=m(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:H.fn.lang};for(I in da)da.hasOwnProperty(I)&&(G(I,da[I]),F(I.toLowerCase()));G("Weeks",6048e5),H.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},H.lang("en",{ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),M&&(module.exports=H),"undefined"==typeof ender&&(this.moment=H),"function"==typeof define&&define.amd&&define("moment",[],function(){return H})}.call(this),define("templates/helpers/timeAgo",["Handlebars","moment"],function(a,b){"use strict";a.registerHelper("timeAgo",function(a){return b(a).fromNow()})}),define("hbs!templates/comment",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/timeAgo","templates/helpers/icon"],function(a,b){var c=b.template({1:function(a,b,c,d){return'        <img src="'+this.escapeExpression(this.lambda(null!=a?a.thumb:a,a))+'" class="comment__image__thumb">\n'},3:function(a,b,c,d){var e;return null!=(e=b["if"].call(a,null!=a?a.monogram:a,{name:"if",hash:{},fn:this.program(4,d,0),inverse:this.program(6,d,0),data:d}))?e:""},4:function(a,b,c,d){var e;return'          <div class="comment__image__thumb comment__image__monogram" style="background:#'+this.escapeExpression((e=null!=(e=b.color||(null!=a?a.color:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"color",hash:{},data:d}):e))+'">'+this.escapeExpression((e=null!=(e=b.monogram||(null!=a?a.monogram:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"monogram",hash:{},data:d}):e))+"</div>\n"},6:function(a,b,c,d){return'          <img src="/temp/noface.png" class="comment__image__thumb">\n'},8:function(a,b,c,d){var e;return'  <div class="comment__parent">\n    '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"In reply to:",{name:"t",hash:{},data:d}))+'\n\n    <figure class="comment__quote">\n      <blockquote class="comment__quote__body">\n        '+this.escapeExpression(this.lambda(null!=(e=null!=a?a.parent:a)?e.message:e,a))+'\n      </blockquote>\n\n      <figcaption class="comment__quote__attribution">\n        '+this.escapeExpression(this.lambda(null!=(e=null!=a?a.parent:a)?e.name:e,a))+"\n      </figcaption>\n    </figure>\n  </div>\n"},10:function(a,b,c,d){var e;return"    <p>\n"+(null!=(e=b.each.call(a,a,{name:"each",hash:{},fn:this.program(11,d,0),inverse:this.noop,data:d}))?e:"")+"    </p>\n"},11:function(a,b,c,d){var e;return"        "+this.escapeExpression(this.lambda(a,a))+"\n        "+(null!=(e=b.unless.call(a,d&&d.last,{name:"unless",hash:{},fn:this.program(12,d,0),inverse:this.noop,data:d}))?e:"")+"\n"},12:function(a,b,c,d){return"<br>"},14:function(a,b,c,d){var e,f;return'    <a class="button button--small comment__link comment__upvote '+(null!=(e=b["if"].call(a,null!=a?a.upvoted:a,{name:"if",hash:{},fn:this.program(15,d,0),inverse:this.noop,data:d}))?e:"")+'" href="#">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"upvote",{name:"icon",hash:{},data:d}))+"\n      "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Upvote",{name:"t",hash:{},data:d}))+'\n\n      <span class="comment__upvote__count" '+(null!=(e=b.unless.call(a,null!=a?a.upvotes:a,{name:"unless",hash:{},fn:this.program(17,d,0),inverse:this.noop,data:d}))?e:"")+">\n        (+"+this.escapeExpression((f=null!=(f=b.upvotes||(null!=a?a.upvotes:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"upvotes",hash:{},data:d}):f))+")\n      </span>\n    </a>\n"},15:function(a,b,c,d){return"comment__upvote--upvoted"},17:function(a,b,c,d){return'style="display:none"'},19:function(a,b,c,d){var e,f;return'    <span class="comment__upvote__count--ro" '+(null!=(e=b.unless.call(a,null!=a?a.upvotes:a,{name:"unless",hash:{},fn:this.program(17,d,0),inverse:this.noop,data:d}))?e:"")+">\n      Upvotes (+"+this.escapeExpression((f=null!=(f=b.upvotes||(null!=a?a.upvotes:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"upvotes",hash:{},data:d}):f))+")\n    </span>\n"},21:function(a,b,c,d){return'    <a class="comment__link comment__edit" href="#">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Edit",{name:"t",hash:{},data:d}))+'</a>\n    <a class="comment__link comment__delete" href="#">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Delete",{name:"t",hash:{},data:d}))+"</a>\n"},23:function(a,b,c,d){return'    <!-- <a class="comment__link comment__move" href="#">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Move",{name:"t",hash:{},data:d}))+"</a> -->\n"},25:function(a,b,c,d){var e;return null!=(e=b["if"].call(a,null!=a?a.reported:a,{name:"if",hash:{},fn:this.program(26,d,0),inverse:this.program(28,d,0),data:d}))?e:""},26:function(a,b,c,d){return'      <span class="comment__report comment__report--reported">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"flag",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Reported. Thank you.",{name:"t",hash:{},data:d}))+"\n      </span>\n"},28:function(a,b,c,d){return'      <a class="comment__link comment__report" href="#">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"flag",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Report",{name:"t",hash:{},data:d}))+"\n      </a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f;return'\n<header class="comment__header">\n  <div class="media">\n    <a href=\'/profiles/'+this.escapeExpression((f=null!=(f=b.profileId||(null!=a?a.profileId:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"profileId",hash:{},data:d}):f))+'\' class="comment__image media__image">\n'+(null!=(e=b["if"].call(a,null!=a?a.thumb:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")+'    </a>\n\n    <div class="media__message">\n      <a class="comment__name" href="/profiles/'+this.escapeExpression((f=null!=(f=b.profileId||(null!=a?a.profileId:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"profileId",hash:{},data:d}):f))+'" target="_blank">'+this.escapeExpression((f=null!=(f=b.name||(null!=a?a.name:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"name",hash:{},data:d}):f))+'</a>\n      <div class="comment__date">\n        <strong>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Posted",{name:"t",hash:{},data:d}))+"</strong>\n        "+this.escapeExpression((b.timeAgo||a&&a.timeAgo||b.helperMissing).call(a,null!=a?a.date:a,{name:"timeAgo",hash:{},data:d}))+"\n      </div>\n    </div>\n  </div>\n</header>\n\n"+(null!=(e=b["if"].call(a,null!=a?a.parent:a,{name:"if",hash:{},fn:this.program(8,d,0),inverse:this.noop,data:d}))?e:"")+'\n<div class="comment__body hyphens">\n'+(null!=(e=b.each.call(a,null!=a?a.paragraphs:a,{name:"each",hash:{},fn:this.program(10,d,0),inverse:this.noop,data:d}))?e:"")+'</div>\n\n<div class="comment__editor">\n  <textarea class="comment__editor__input"></textarea>\n\n  <div class="comment__editor__message"></div>\n\n  <div class="comment__editor__controls">\n    <span class="comment__editor__count">2000</span>\n    '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"characters left",{name:"t",hash:{},data:d}))+'\n\n    <button class="button button-small comment__editor__button comment__editor__submit">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Submit",{name:"t",hash:{},data:d}))+'</button>\n  </div>\n</div>\n\n<footer class="comment__footer">\n  <a class="button button--small comment__link comment__reply" href="#">\n    '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"reply",{name:"icon",hash:{},data:d}))+"\n    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Reply",{name:"t",hash:{},data:d}))+"\n  </a>\n\n"+(null!=(e=b.unless.call(a,null!=a?a.isOwn:a,{name:"unless",hash:{},fn:this.program(14,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=a?a.isOwn:a,{name:"if",hash:{},fn:this.program(19,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=a?a.isEditable:a,{name:"if",hash:{},fn:this.program(21,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=a?a.isModable:a,{name:"if",hash:{},fn:this.program(23,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b.unless.call(a,null!=a?a.isOwn:a,{name:"unless",hash:{},fn:this.program(25,d,0),inverse:this.noop,data:d}))?e:"")+'</footer>\n\n<article class="comment__response">\n  <textarea rows="6" class="comment__response__input"></textarea>\n\n  <div class="comment__response__message"></div>\n\n  <div class="comment__response__buttons">\n    <span class="comment__response__limit">\n      <span class="comment__response__limit__remain">2000</span>\n      '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"characters left",{name:"t",hash:{},data:d}))+'\n    </span>\n\n    <button class="button button--small comment__response__button comment__response__submit">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Submit",{name:"t",hash:{},data:d}))+'</button>\n  </div>\n</article>\n\n<div class="comment__replies"></div>\n'},useData:!0});return b.registerPartial("templates/comment",c),c}),define("lib/thread",["exports","lodash","jquery","lib/currentUser"],function(a,b,c,d){"use strict";function e(a,b,c){return{records:a,metadata:{page:b,pageCount:c}}}function f(a,c){var d=new Date(1e3*(0+a.date));if(!a.deleted){var e=g(a.children,b.extend({parentId:a.comment_id},c)),f=+c.currentUserId===+a.user_id;return{id:a.comment_id,parentId:c.parentId,threadId:c.threadId,isOwn:f,isModable:c.isCommentModerator,isEditable:c.isCommentModerator||f,name:a.name,profileId:a.profile_id,thumb:a.profile_pic,date:d,message:a.comment,replies:e,upvoted:!!a.actor_score_id,scoreId:a.actor_score_id||null,reported:!!a.actor_flag_id,flagId:a.actor_flag_id||null,upvotes:a.score,removed:a.deleted}}}function g(a,c){function d(a){return f(a,c)}return b.isPlainObject(a)?b.filter(b.map(b.values(a),d)):[]}var h={page:1,perPage:10,sort:"rated"},i={};a.get=function(a,f){var i=new c.Deferred;f=b.extend({},h,f);var j="/conversation_forums/"+a,k={page:f.page,per_page:f.perPage,sort:f.sort},l=new c.Deferred;return d.getDetails().then(function(a){l.resolve({currentUserId:a.id,isCommentModerator:a.isCommentModerator})},function(){l.resolve({currentUserId:!1,isCommentModerator:!1})}),c.when(c.getJSON(j,k),l).then(function(a,c){var d,f=a[0],h=c;if(f.attributes&&(f=f.attributes),!f||!f.discussion_thread)return void i.resolve(e([],1,1));d=b.extend({threadId:f.id},h);var j=f.discussion_thread.thread[0],l=g(j,d);i.resolve(e(l,k.page,b.size(j)<k.per_page?k.page:k.page+1))},function(){i.reject()}),i.promise()},a.saveComment=function(a,d){var e=c.Deferred(),f=e.promise();d=b.extend({},i,d);var g="/comments",h={comment:a.message,timestamp:Math.floor(new Date/1e3).toString()},j={};if(a.id)g="/comments/"+a.id,j._method="PUT";else if(a.parentId)h.commentable_type="comment",h.commentable_id=a.parentId;else{if(!a.threadId)return e.reject(new Error("parentId or threadId required.")),f;h.commentable_type="conversation_forum",h.commentable_id=a.threadId}return j.comment=h,c.post(g,j,null,"json").then(function(a){e.resolve(a?{id:a.id}:null)},function(){e.reject()}),f},a.destroyComment=function(a,d){var e=c.Deferred(),f=e.promise(),g="/comments/"+a,h={_method:"DELETE"};return d&&(d.send=d.send?"1":""),b.extend(h,d||{}),c.post(g,h,null,"json").then(function(){e.resolve()},function(){e.reject()}),f},a.saveFlag=function(a){var b=c.Deferred(),d=b.promise(),e="/comment_flags",f={comment_flag:{comment_id:a.commentId}};return a.id&&(e="/comment_flags/"+a.id,f._method="PUT"),c.post(e,f,null,"json").then(function(a){b.resolve({id:a.id})},function(){b.reject()}),d},a.destroyFlag=function(a){var b=c.Deferred(),d=b.promise(),e="/comment_flags/"+a,f={_method:"DELETE"};return c.post(e,f,null,"json").then(function(){b.resolve()},function(){b.reject()}),d},a.saveScore=function(a){var b=c.Deferred(),d=b.promise(),e="/comment_scores",f={comment_score:{comment_id:a.commentId}};return a.id&&(e="/comment_scores/"+a.id,f._method="PUT"),c.post(e,f,null,"json").then(function(a){b.resolve({id:a.id})},function(){b.reject()}),d},a.destroyScore=function(a){var b=c.Deferred(),d=b.promise(),e="/comment_scores/"+a,f={_method:"DELETE"};return c.post(e,f,null,"json").then(function(){b.resolve()},function(){b.reject()}),d}}),define("utils/monogram",["jquery"],function(a){"use strict";return function(b){return(b=a.trim(b))?(b=b.split(",")[0],b=b.replace(/\s[a-z]\w+\s/g," "),b=b.replace(/\s\w+\.$/,""),b=b.replace(/\s[A-Z]+$/,""),b=b.replace(/[^\s\w]+([\w])/g,"$1"),b=a.trim(b).toUpperCase().split(/\s+/),b[0][0]+(b.length>1?b[b.length-1][0]:"")):""}}),define("collections/Comments",["Backbone","models/Comment"],function(a,b){"use strict";var c=a.Collection.extend({constructor:function(){this.model||(this.model=require("models/Comment")),a.Collection.apply(this,arguments)},model:b,parent:null});return c}),define("models/Comment",["jquery","lodash","Backbone","lib/pubSub","lib/thread","lib/currentUser","utils/monogram","collections/Comments"],function(a,b,c,d,e,f,g,h){"use strict";function i(){h||(h=require("collections/Comments"))}var j=c.Model.extend({defaults:{isOwn:!0,isEditable:!0,upvotes:0,upvoted:!1},maxMessageLength:2e3,constructor:function(){i(),this.replies=new h,this.replies.parent=this,c.Model.apply(this,arguments)},initialize:function(a){this.replies.reset(a.replies)},monogram:function(){return g(this.get("name"))},parse:function(a){return this.replies.reset(a.replies),b.omit(a,"replies")},remove:function(a){var b=this,c=e.destroyComment(b.get("id"),a);return b.trigger("request",b,c),c.done(function(){b.set("removed",!0)}),c},report:function(){var a=this,b=e.saveFlag({commentId:a.get("id")});return b.done(function(b){a.set({reported:!0,flagId:b.id}),d("comment.report").publish(a.toJSON())}),b},unreport:function(){var a=this,b=e.destroyFlag(a.get("flagId"));return b.done(function(){a.set("reported",!1)}),b},sync:function(b,c){var g;return g="delete"===b?e.destroyComment(c.get("id")):"create"===b?a.when(e.saveComment(c.toJSON()).done(function(a){c.set(a)}),f.getDetails().done(function(a){c.set({name:a.firstName+" "+a.lastName,thumb:a.avatarUrl})})).done(function(){c.get("profileId")||c.set("profileId","me"),d("comment.create").publish(c.toJSON())}):e.saveComment(c.toJSON()),c.trigger("request",c,g),g},toggleUpvote:function(){var a,b=this,c=b.get("upvotes"),f=b.get("upvoted");return f?(c-=1,a=e.destroyScore(b.get("scoreId"))):(c+=1,a=e.saveScore({commentId:b.get("id")})),a.done(function(a){b.set({upvoted:!f,upvotes:c,scoreId:a?a.id||null:null}),d("comment.upvote").publish(b.toJSON())}),a},validate:function(a){return a.message?a.message.length>this.maxMessageLength?"Comments must container fewer than "+this.maxMessageLength+" characters.":a.id||a.threadId||a.parentId?void 0:"Your comment is not associated with any thread.":"Please enter a comment."}});return j}),define("hbs!templates/commentReportModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Report this comment?",{name:"t",hash:{},data:d}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Reporting a comment or conversation sends a notification to our moderation team. They will review the message and take the appropriate action.",{name:"t",hash:{},data:d}))+"</p>\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"This action cannot be undone.",{name:"t",hash:{},data:d}))+'</p>\n\n  <p>\n    <label>\n      <input class="comment-report__reason" type="radio" name="reason" data-reason="spam">\n      '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Flag as spam",{name:"t",hash:{},data:d}))+'\n    </label>\n  </p>\n\n  <p>\n    <label>\n      <input class="comment-report__reason" type="radio" name="reason" data-reason="abuse">\n      '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Flag as inappropriate",{name:"t",hash:{},data:d}))+'\n    </label>\n  </p>\n\n  <p class="comment-report__message" style="display:none">\n    <strong>Please select a reason for reporting this comment.</strong>\n  </p>\n\n  <button class="comment-report__submit button">Flag</button>\n  <button class="comment-report__cancel button">Cancel</button>\n</div>\n'},useData:!0});return b.registerPartial("templates/commentReportModal",c),c}),define("views/CommentReportView",["lodash","Backbone","hbs!templates/commentReportModal","widgets/modal"],function(a,b,c){"use strict";var d=b.View.extend({tagName:"div",className:"comment-report",events:{"click .comment-report__submit":"submit","click .comment-report__cancel":"cancel"},render:function(){return this.$el.html(c()).modal({close:a.bind(this.remove,this)}),this},cancel:function(){this.$el.modal("close")},submit:function(){var a=this.$el.find("input.comment-report__reason:checked").data("reason");return a?(this.disable(!0),this.model.report(a),void this.$el.modal("close")):void this.$el.find("p.comment-report__message").slideDown("fast")},disable:function(a){this.$el[a?"addClass":"removeClass"]("comment-report--disabled"),this.$el.find("button, input, textarea").prop("disabled",a)}});return d}),define("hbs!templates/commentRemoveOwnModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Remove your comment?",{name:"t",hash:{},data:d}))+"</h3>\n  </div>\n\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Are you sure you want to delete your comment?",{name:"t",hash:{},data:d}))+"</p>\n  <p>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"This action cannot be undone.",{name:"t",hash:{},data:d}))+'</p>\n\n  <button class="comment-remove__submit button">Yes, delete it</button>\n  <button class="comment-remove__cancel button">Cancel</button>\n</div>\n'},useData:!0});return b.registerPartial("templates/commentRemoveOwnModal",c),c}),define("hbs!templates/commentRemoveModModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'        <option value="'+this.escapeExpression((e=null!=(e=b.value||(null!=a?a.value:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"value",hash:{},data:d}):e))+'">'+this.escapeExpression((e=null!=(e=b.label||(null!=a?a.label:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"label",hash:{},data:d}):e))+"</option>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div>\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Remove this comment?",{name:"t",hash:{},data:d}))+'</h3>\n  </div>\n\n  <div class="form-group">\n    <select class="form-control form-control--dropdown comment-remove__reason">\n      <option value="">Reason for deletion</option>\n'+(null!=(e=b.each.call(a,null!=a?a.reasons:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'    </select>\n  </div>\n\n  <div class="form-group">\n    <label class="checkbox">\n      <input class="checkbox__input comment-remove__send" type="checkbox">\n      <span class="form-label">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Send an email notifying the commenter.",{name:"t",hash:{},data:d}))+'</span>\n    </label>\n  </div>\n\n  <div class="form-group">\n    <input class="form-control comment-remove__subject" type="text" value="Your TED.com comment">\n  </div>\n\n  <div class="form-group">\n    <textarea class="form-control comment-remove__email" rows="5"></textarea>\n  </div>\n\n  <button class="comment-remove__submit button">Delete it</button>\n  <button class="comment-remove__cancel button">Cancel</button>\n</div>\n'},useData:!0});return b.registerPartial("templates/commentRemoveModModal",c),c}),define("hbs!templates/emails/commentRemoveNone",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+",\n\nThank you for your post, but I'm afraid the right folks won't see it in these comments. Would you mind sending this in via our contact form?\n\nhttp://www.ted.com/contact\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemoveNone",c),c}),define("hbs!templates/emails/commentRemoveCollateral",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+",\n\nWe're sorry, but your comment (included below) has been removed, as a comment it was in response to was deleted. Please feel free to start a new discussion with your comment (included below).\n\n"+this.escapeExpression((e=null!=(e=b.url||(null!=a?a.url:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"url",hash:{},data:d}):e))+"\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemoveCollateral",c),c}),define("hbs!templates/emails/commentRemoveInappropriate",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+",\n\nWe're sorry. Your comment has been removed according to the TED.com Terms of Use:\n\nhttp://www.ted.com/termsofuse\n\nWant to rephrase your comment?\n\nRejoin the conversation:\n\n"+this.escapeExpression((e=null!=(e=b.url||(null!=a?a.url:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"url",hash:{},data:d}):e))+"\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemoveInappropriate",c),c}),define("hbs!templates/emails/commentRemoveGeneral",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{
name:"name",hash:{},data:d}):e))+",\n\nTED comment threads are a welcoming place for differing opinions, but we ask that you write all comments in a way that is thoughtful and constructive. The goal of our message boards is to host productive conversation and debate. Comments that are insulting or belittling do not make for constructive conversation -- they tend to stifle debate, not promote it.\n\nWith this in mind, we'd ask you to re-write your comment as though the other party were sitting across from you at a dinner table. How could you engage them in constructive and respectful debate?\n\nThe full text of the comment is below; please let us know if you have any questions. For more information on our approach to comments on TED.com, check out our community How-To Guide:\n\nhttp://www.ted.com/pages/conversations_howto\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemoveGeneral",c),c}),define("hbs!templates/emails/commentRemoveOffTopic",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+",\n\nWe're sorry, but we need you to stay on topic as you chime in on conversations, or consider starting a new topic of your own. The full text of your comment is included below, please let us know if you have any questions.\n\nWant to rephrase your comment? Rejoin the conversation:\n\n"+this.escapeExpression((e=null!=(e=b.url||(null!=a?a.url:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"url",hash:{},data:d}):e))+"\n\nStart a new Conversation:\n\nhttp://www.ted.com/conversations\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemoveOffTopic",c),c}),define("hbs!templates/emails/commentRemovePoorlyWritten",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+",\n\nWe're sorry. We have removed your comment (included below) from TED.com, because the writing was difficult to understand. Want to clarify and re-post your comment?\n\nRejoin the conversation:\n\n"+this.escapeExpression((e=null!=(e=b.url||(null!=a?a.url:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"url",hash:{},data:d}):e))+"\n\nSincerely,\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemovePoorlyWritten",c),c}),define("hbs!templates/emails/commentRemoveRude",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"Dear "+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+",\n\nTED comment threads are a welcoming place for critical comment and debate, but we ask that you write all comments in a way that is thoughtful and constructive. The goal of our message boards is to host productive conversation and debate. Comments that are insulting or belittling, especially those that are aggressive towards a speaker personally, do not make for constructive conversation -- they tend to stifle debate, not promote it.\n\nWith this in mind, we'd ask you to re-write your comment as though the speaker were sitting across from you at a dinner table. Our speakers do read and respond to comments. How could you engage the speaker in constructive and respectful debate?\n\nThe full text of the comment is below; please let us know if you have any questions. For more information on our approach to comments on TED.com, check out our community How-To Guide:\n\nhttp://www.ted.com/pages/conversations_howto\n\nThank you!\n\nThe TED Conversations Team\n\nFull text of your comment:\n\n"+this.escapeExpression((e=null!=(e=b.comment||(null!=a?a.comment:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"comment",hash:{},data:d}):e))+"\n"},useData:!0});return b.registerPartial("templates/emails/commentRemoveRude",c),c}),define("views/CommentRemoveView",["lodash","Backbone","hbs!templates/commentRemoveOwnModal","hbs!templates/commentRemoveModModal","hbs!templates/emails/commentRemoveNone","hbs!templates/emails/commentRemoveCollateral","hbs!templates/emails/commentRemoveInappropriate","hbs!templates/emails/commentRemoveGeneral","hbs!templates/emails/commentRemoveOffTopic","hbs!templates/emails/commentRemovePoorlyWritten","hbs!templates/emails/commentRemoveRude","widgets/modal"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";var l=b.View.extend({tagName:"div",className:"comment-remove",events:{"change .comment-remove__reason":"reason","click .comment-remove__submit":"submit","click .comment-remove__cancel":"cancel"},reasons:[{value:"comment_none",label:"None",email:e},{value:"comment_collateral",label:"Collateral damage",email:f},{value:"comment_inappropriate",label:"Inappropriate",email:g},{value:"comment_general",label:"General",email:h},{value:"comment_off_topic",label:"Off-topic",email:i},{value:"comment_poorly_written",label:"Poorly written",email:j},{value:"comment_rude",label:"Rude critique",email:k}],reason:function(){var b=a.find(this.reasons,{value:this.$reason.val()}),c={name:this.model.get("name"),comment:this.model.get("message"),url:window.location.href};this.$email.val(b?b.email(c):"")},render:function(){var b=this.model.get("isOwn");return this.$el.html(b?c():d({reasons:this.reasons})),this.$el.modal({close:a.bind(this.remove,this)}),b||(this.$email=this.$el.find("textarea.comment-remove__email"),this.$reason=this.$el.find("select.comment-remove__reason"),this.$subject=this.$el.find("input.comment-remove__subject")),this},cancel:function(){this.$el.modal("close")},submit:function(){this.disable(!0),this.model.get("isOwn")?this.model.remove():this.model.remove({reason:this.$reason.val(),email:this.$email.val(),subject:this.$subject.val(),send:this.$el.find("input.comment-remove__send:checked").length>0}),this.$el.modal("close")},disable:function(a){this.$el[a?"addClass":"removeClass"]("comment-remove--disabled"),this.$el.find("button, input, textarea").prop("disabled",a)}});return l}),define("utils/paragraphs",[],function(){"use strict";var a="\n";return function(b){var c,d;if(!b)return[[]];for(c=b.replace(/\r\n/g,a).replace(/\r/g,a).split(a+a),d=c.length;d--;)c[d]=c[d].split(a);return c}}),define("views/CommentView",["jquery","lodash","views/AuthView","views/CommentsView","hbs!templates/comment","models/Comment","spinjs","hbs!templates/commentApologyModal","views/CommentReportView","views/CommentRemoveView","utils/paragraphs","widgets/modal"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(){d||(d=require("views/CommentsView"))}var m=["ADD1D6","B0C4CC","778390","4B6375"],n={},o=b.once(function(){n.$apology=null,n.$body=a("body, html"),n.reportView=null}),p="comment__upvote--upvoted",q=c.extend({tagName:"article",className:"comment",events:{"click a.comment__reply":"toggleReply","click a.comment__upvote":"upvote","click a.comment__report":"report","click a.comment__edit":"toggleEdit","click a.comment__delete":"remove","click a.comment__move":"move","click button.comment__response__submit":"submit","input textarea.comment__response__input":"recountResponse","click button.comment__editor__submit":"submitEdit","input textarea.comment__editor__input":"recountEdit"},initialize:function(){this.listenTo(this.model,"change:upvotes",this.refreshUpvotes),this.listenTo(this.model,"change:reported",this.refreshReported),this.listenTo(this.model,"change:removed",this.refreshRemoved),this.listenTo(this.model,"change:message",this.refreshMessage),this.listenTo(this.model,"request",this._request),this.demandAuthFor("toggleReply","upvote","report","toggleEdit","remove","move"),this.$el.data("view",this)},recountResponse:function(a){this._checkEventRecipient("recountResponse",a)&&this.$responseCount.text(this.model.maxMessageLength-this.$responseText.val().length)},render:function(){o();var a=this.model.collection.parent,c=this.model.toJSON();return c.monogram=this.model.monogram(),c.color=b.shuffle(m)[0],c.paragraphs=k(c.message),this.$el.attr("id","comment-"+c.id).html(e(b.extend({parent:a?a.toJSON():!1},c))),this.$body=this.$el.find("div.comment__body"),this.$editLink=this.$el.find("a.comment__edit"),this.$edit=this.$el.find("div.comment__editor"),this.$editText=this.$edit.find("textarea.comment__editor__input"),this.$editMessage=this.$edit.find("div.comment__editor__message"),this.$editCount=this.$edit.find("span.comment__editor__count"),this.$response=this.$el.find("article.comment__response"),this.$responseText=this.$response.find("textarea"),this.$responseMessage=this.$response.find("div.comment__response__message"),this.$responseCount=this.$response.find("span.comment__response__limit__remain"),this.$replyLink=this.$el.find("a.comment__reply"),this.$upvote=this.$el.find("a.comment__upvote"),this.$upvoteCount=this.$el.find("span.comment__upvote__count"),this._renderReplies(),this},refreshMessage:function(){this.$body.text(this.model.get("message"))},refreshRemoved:function(){this.$el.slideUp("fast")},toggleEdit:function(a){if(this._checkEventRecipient("toggleEdit",a)){a.preventDefault();var c="none"===this.$edit.css("display"),d=this;this.$editLink[c?"addClass":"removeClass"]("comment__link--active"),c?(d.$editText.val(d.model.get("message")),d.recountEdit(a),d.$body.slideUp("fast"),d.$edit.slideDown("fast"),b.delay(function(){d.$editText.focus()},100)):(this.$edit.slideUp("fast"),this.$body.slideDown("fast"))}},remove:function(a){this._checkEventRecipient("remove",a)&&(a.preventDefault(),new j({model:this.model}).render())},move:function(a){this._checkEventRecipient("move",a)&&a.preventDefault()},submitEdit:function(a){var b=this;if(b._checkEventRecipient("submitEdit",a)){a.preventDefault();var c=b.model.get("message");b.model.set("message",b.$editText.val());var d=b.model.save();d?(b.$editMessage.slideUp("fast"),this._getSpinner().spin(b.$edit.get(0)),this.disableEdit(!0),d.then(function(){b.$edit.slideUp("fast"),b.$body.slideDown("fast")},function(){b.apologize(),b.model.set("message",c)}).always(function(){b._spinner.stop(),b.disableEdit(!1)})):(b.model.set("message",c),b.$editMessage.text(b.model.validationError).slideDown("fast"))}},disableEdit:function(a){this.$edit.find("button, input, textarea").prop("disabled",a)},recountEdit:function(a){this._checkEventRecipient("recountEdit",a)&&(a.preventDefault(),this.$editCount.text(this.model.maxMessageLength-this.$editText.val().length))},toggleReply:function(a){if(this._checkEventRecipient("toggleReply",a)){a.preventDefault();var b="none"===this.$response.css("display"),c=this;this.$replyLink[b?"addClass":"removeClass"]("comment__link--active"),b?this.$response.slideDown(400,function(){c.$responseText.focus()}):this.$response.slideUp("fast")}},upvote:function(a){this._checkEventRecipient("upvote",a)&&(a.preventDefault(),this.model.toggleUpvote())},report:function(a){this._checkEventRecipient("report",a)&&(a.preventDefault(),this.model.get("reported")?this.model.unreport():new i({model:this.model}).render())},submit:function(a){var b=this;if(b._checkEventRecipient("submit",a)){a.preventDefault();var c=new f({parentId:b.model.get("id"),message:b.$responseText.val()}),d=c.save();d?(b.$responseMessage.slideUp("fast"),this._getSpinner().spin(b.$response.get(0)),this.disableResponse(!0),d.then(function(){b.model.replies.add(c,{at:0}),b.$responseText.val(""),b.$response.slideUp("fast")},function(){b.apologize(),c=null}).always(function(){b._spinner.stop(),b.disableResponse(!1)})):(b.$responseMessage.text(c.validationError).slideDown("fast"),c=null)}},disableResponse:function(a){this.$response[a?"addClass":"removeClass"]("comment__response--disabled"),this.$response.find("button, input, textarea").prop("disabled",a)},apologize:function(){n.$apology?n.$apology.modal("open"):n.$apology=a(h()).modal()},refreshUpvotes:function(){var a=this.model.get("upvotes"),b=a&&a>0;b&&this.$upvoteCount.text("("+a+")"),this.$upvoteCount[b?"fadeIn":"fadeOut"]("fast"),this.$upvote[this.model.get("upvoted")?"addClass":"removeClass"](p)},refreshReported:function(){var b=a(e(this.model.toJSON())).find(".comment__report");this.$el.find(".comment__report").replaceWith(b)},_checkEventRecipient:function(b,c){var d=a(c.target).closest("article.comment"),e=d.data("view"),f=e===this;return f||e[b].call(e,c),f},_getSpinner:function(){return this._spinner||(this._spinner=new g),this._spinner},_renderReplies:function(){l(),this._repliesView=new d({events:{},collection:this.model.replies}),this._repliesView.render(),this._repliesView.$el.appendTo(this.$el.find("div.comment__replies"))},_pendingRequests:0,_request:function(a,b){var c=this;c._requestSpinner||(c._requestSpinner=new g),c.$body.is(":visible")&&c._requestSpinner.spin(c.$body.get(0)),c._pendingRequests++,b.always(function(){c._pendingRequests--,c._pendingRequests<=0&&c._requestSpinner.stop()})}});return q}),define("views/CommentsView",["jquery","lodash","Backbone","views/CommentView"],function(a,b,c,d){"use strict";function e(b,c){var d=a(c.target).closest("article.comment"),e=d.data("view");e[b].call(e,c)}var f=c.View.extend({tagName:"section",className:"comments",events:{"click a.comment__reply":"commentToggleReply","click a.comment__upvote":"commentUpvote","click a.comment__report":"commentReport","click a.comment__edit":"commentToggleEdit","click a.comment__delete":"commentRemove","click a.comment__move":"commentMove","click button.comment__response__submit":"commentSubmit","input textarea.comment__response__input":"commentRecountResponse","click button.comment__editor__submit":"commentSubmitEdit","input textarea.comment__editor__input":"commentRecountEdit"},initialize:function(){this.listenTo(this.collection,"add",this._addComment),this.listenTo(this.collection,"reset",this.render)},render:function(){var a=this;return a.$el.empty(),a.collection.length?a.collection.each(function(b){a._addComment(b)}):a.$el.hide(),a._rendered=!0,a},commentToggleReply:function(a){e("toggleReply",a)},commentUpvote:function(a){e("upvote",a)},commentToggleEdit:function(a){e("toggleEdit",a)},commentRemove:function(a){e("remove",a)},commentMove:function(a){e("move",a)},commentRecountResponse:function(a){e("recountResponse",a)},commentReport:function(a){e("report",a)},commentSubmit:function(a){e("submit",a)},commentSubmitEdit:function(a){e("submitEdit",a)},commentRecountEdit:function(a){e("recountEdit",a)},_addComment:function(a,b,c){var e=new d({events:{},model:a}),f=e.render().$el;this._rendered&&f.hide(),this.$el[c&&0===c.at?"prepend":"append"](f),this._rendered&&(this.$el.show(),f.slideDown("fast"))}});return f}),define("autosize",["jquery"],function(a){return function(a){var b,c={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},d='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',e=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],f=a(d).data("autosize",!0)[0];f.style.lineHeight="99px","99px"===a(f).css("lineHeight")&&e.push("lineHeight"),f.style.lineHeight="",a.fn.autosize=function(d){return this.length?(d=a.extend({},c,d||{}),f.parentNode!==document.body&&a(document.body).append(f),this.each(function(){function c(){var b,c=window.getComputedStyle?window.getComputedStyle(m,null):!1;c?(b=m.getBoundingClientRect().width,0!==b&&"number"==typeof b||(b=parseInt(c.width,10)),a.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(a,d){b-=parseInt(c[d],10)})):b=n.width(),f.style.width=Math.max(b,0)+"px"}function g(){var g={};if(b=m,f.className=d.className,f.id=d.id,j=parseInt(n.css("maxHeight"),10),a.each(e,function(a,b){g[b]=n.css(b)}),a(f).css(g).attr("wrap",n.attr("wrap")),c(),window.chrome){var h=m.style.width;m.style.width="0px";m.offsetWidth;m.style.width=h}}function h(){var a,e;b!==m?g():c(),!m.value&&d.placeholder?f.value=(n.attr("placeholder")||"")+d.append:f.value=m.value+d.append,f.style.overflowY=m.style.overflowY,e=parseInt(m.style.height,10),f.scrollTop=0,f.scrollTop=9e4,a=f.scrollTop,j&&a>j?(m.style.overflowY="scroll",a=j):(m.style.overflowY="hidden",k>a&&(a=k)),a+=o,e!==a&&(m.style.height=a+"px",p&&d.callback.call(m,m))}function i(){clearTimeout(l),l=setTimeout(function(){var a=n.width();a!==r&&(r=a,h())},parseInt(d.resizeDelay,10))}var j,k,l,m=this,n=a(m),o=0,p=a.isFunction(d.callback),q={height:m.style.height,overflow:m.style.overflow,overflowY:m.style.overflowY,wordWrap:m.style.wordWrap,resize:m.style.resize},r=n.width(),s=n.css("resize");n.data("autosize")||(n.data("autosize",!0),"border-box"!==n.css("box-sizing")&&"border-box"!==n.css("-moz-box-sizing")&&"border-box"!==n.css("-webkit-box-sizing")||(o=n.outerHeight()-n.height()),k=Math.max(parseInt(n.css("minHeight"),10)-o||0,n.height()),n.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===s?n.css("resize","none"):"both"===s&&n.css("resize","horizontal"),"onpropertychange"in m?"oninput"in m?n.on("input.autosize keyup.autosize",h):n.on("propertychange.autosize",function(){"value"===event.propertyName&&h()}):n.on("input.autosize",h),d.resizeDelay!==!1&&a(window).on("resize.autosize",i),n.on("autosize.resize",h),n.on("autosize.resizeIncludeStyle",function(){b=null,h()}),n.on("autosize.destroy",function(){b=null,clearTimeout(l),a(window).off("resize",i),n.off("autosize").off(".autosize").css(q).removeData("autosize")}),h())})):this}}(window.jQuery||window.$),a}),define("views/ThreadView",["jquery","lodash","Backbone","spinjs","hbs!templates/commentApologyModal","views/CommentsView","models/Comment","widgets/modal","autosize"],function(a,b,c,d,e,f,g){"use strict";function h(){if(i)i.modal("open");else{var b=a(e());i=b.modal()}}var i,j=c.View.extend({events:{"click button.thread__new__button":"submitNew","input textarea.thread__new__input":"recountNew","focus textarea":"enableAutoresize","click a.thread__more":"more","click input.thread__sorts__option__input":"sort"},$els:{newArea:"div.thread__new",newAlert:"div.thread__new__alert",newCount:"span.thread__new__count",newText:"textarea.thread__new__input",comments:"div.thread__comments",sorts:"input.thread__sorts__option__input",more:"a.thread__more",loading:null},disableNew:function(a){this.init$el("newArea")&&this.$els.newArea.find("button, input, textarea").prop("disabled",a)},getSort:function(){return this.init$el("sorts")?this.$els.sorts.filter(":checked").val():null},initialize:function(){this.listenTo(this.model,"request",this._loadingMore),this.listenTo(this.model.comments,"add",this._recountComments),this.listenTo(this.model.comments,"remove",this._recountComments),this.listenTo(this.model.comments,"reset",this._recountComments)},more:function(a){a&&a.preventDefault(),this.model.more()},recountNew:function(){var a,b=g.prototype.maxMessageLength,c=this.init$el("newCount")&&this.init$el("newText"),d=this.$els;c&&(a=d.newText.val(),d.newCount.text(b-a.length))},render:function(){this.commentsView||(this.commentsView=new f({collection:this.model.comments})),this.init$el("comments")&&(this.commentsView.render().$el.appendTo(this.$els.comments),this.$els.loading=a("<div></div>").addClass("thread__loading").hide().appendTo(this.$els.comments),this._recountComments())},enableAutoresize:function(b){a(b.target).autosize()},sort:function(){this.model.sort(this.getSort())},submitNew:function(a){var b=this;if(b.init$el("newAlert")&&b.init$el("newArea")&&b.init$el("newText")){a&&a.preventDefault();var c=new g({threadId:b.model.get("id"),message:b.$els.newText.val()}),d=c.save();d?(b.$els.newAlert.slideUp("fast"),this._getSpinner().spin(b.$els.newArea.get(0)),b.disableNew(!0),d.then(function(){b.model.comments.add(c,{at:0}),b.$els.newText.val("")},function(){h(),c=null}).always(function(){b._spinner.stop(),b.disableNew(!1)})):(b.$els.newAlert.text(c.validationError).slideDown("fast"),c=null)}},init$el:function(a){var c=this.$els[a];return c&&b.isString(c)?(c=this.$el.find(c),c.length||(c=!1),this.$els[a]=c,c):c},_getSpinner:function(){return this._spinner||(this._spinner=new d),this._spinner},_loadingMore:function(a,b){var c=this;c.$els.loading&&(c._getSpinner().spin(c.$els.loading.show().get(0)),c.$el.addClass("thread--loading"),b.always(function(){c._spinner.stop(),c.$els.loading.slideUp("fast"),c.$el.removeClass("thread--loading")}).done(function(a){a&&a.metadata.pageCount<=a.metadata.page?c.init$el("more").fadeOut("fast"):c.init$el("more").show()}))},_recountCommentsLast:null,_recountComments:function(){var a=this.model.comments.length>0;a!==this._recountCommentsLast&&(this.$el[a?"removeClass":"addClass"]("thread--no-comments")[a?"addClass":"removeClass"]("thread--with-comments"),this._recountCommentsLast=a)}});return j}),define("models/Thread",["Backbone","collections/Comments","lib/thread"],function(a,b,c){"use strict";var d=a.Model.extend({defaults:{id:null,sort:"rated"},_loadingMore:!1,nextPage:1,constructor:function(){this.comments=new b,a.Model.apply(this,arguments)},more:function(){var a=this;if(!a._loadingMore){a._loadingMore=!0;var b=a.get("id"),d={page:a.nextPage,sort:a.get("sort")},e=c.get(b,d).then(function(b){var c=b.records;return c&&c.length&&(a.comments[1===a.nextPage?"reset":"add"](c),a.nextPage++),b}).always(function(){a._loadingMore=!1});a.trigger("request",a,e)}},sort:function(a){this.set("sort",a),this.nextPage=1,this.more()}});return d}),define("hbs!templates/subtitle-help-modal",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">Close</i>\n  </a>\n\n  <h3 class="modal__head__title">Help with subtitles</h3>\n</div>\n\n<p><strong>Desktop / laptop users:</strong> please make sure you have the most updated versions of your browser and Flash player, and that Flash is enabled when you visit TED.com.</p>\n\n<p><strong>iOS users:</strong> to access subtitles, start playing the video, then tap the speech bubble icon that appears in the bottom row of video controls.</p>\n\n<p><strong>Android users:</strong> although Android devices do not support subtitles, you can <a href="https://play.google.com/store/apps/details?id=com.ted.android" target="_blank">download the TED app from the Google Play store</a>.</p>\n'},useData:!0});return b.registerPartial("templates/subtitle-help-modal",c),c}),define("hbs!templates/playerHeroHiccup",["hbs","hbs/handlebars"],function(a,b){var c=b.template({1:function(a,b,c,d){return"        Sorry:\n        we can't play video on this browser.\n        Please make sure it's up to date\n        and that Flash 11.1 or higher is installed.\n"},3:function(a,b,c,d){return"        We're sorry:\n        video playback cannot be initialized\n        at this time.\n"},5:function(a,b,c,d){return"        We're sorry:\n        video playback has been interrupted.\n        You may need to refresh the page\n        to resume.\n"},7:function(a,b,c,d){return"        We are experiencing a small hiccup.\n        Video playback may be slow or choppy.\n        Please be patient.\n        We're working on it!\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="player-hero__hiccup">\n  <div class="player-hero__inner">\n    <div class="container">\n'+(null!=(e=b["if"].call(a,null!=a?a.isClient:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=a?a.isInit:a,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=a?a.isFatal:a,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=a?a.isHiccup:a,{name:"if",hash:{},fn:this.program(7,d,0),inverse:this.noop,data:d}))?e:"")+"\n      You can always\n      download this talk\n      or save it to watch later.\n    </div>\n  </div>\n</div>\n"},useData:!0});return b.registerPartial("templates/playerHeroHiccup",c),c}),define("hbs!templates/controlsMaxi",["hbs","hbs/handlebars","templates/helpers/icon","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){return'        <a class="controls__button controls__skip" href="#" tabindex="1" role="button">\n          '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-skip","","controls__icon",{name:"icon",hash:{},data:d}))+"\n          "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Skip",{name:"t",hash:{},data:d}))+"\n        </a>\n"},3:function(a,b,c,d){return'        <a class="controls__button controls__button--right controls__transcript" href="#" tabindex="1" role="button">\n          '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"transcript","","controls__icon",{name:"icon",hash:{},data:d}))+"\n          "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Transcript",{name:"t",hash:{},data:d}))+"\n        </a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="controls controls--maxi controls--active">\n  <div class="controls__postbar">\n    <div class="controls__postbar__progress"></div>\n  </div>\n\n  <div class="controls__scrubber scrubber">\n    <span class="controls__time controls__time--elapsed">0:00</span>\n    <span class="controls__time controls__time--duration">0:00</span>\n  </div>\n\n  <div class="controls__toolbar">\n    <div class="controls__adtime">\n      <div class="controls__adtime__inner">\n        <div class="controls__adtime__content">\n          <span class="controls__adtime__value">0:00</span>\n        </div>\n      </div>\n    </div>\n\n    <div class="controls__toolbar__container">\n      <a class="controls__button controls__play" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-play","","controls__icon",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Play",{name:"t",hash:{},data:d}))+'\n      </a>\n\n      <a class="controls__button controls__pause" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-pause","","controls__icon",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Pause",{name:"t",hash:{},data:d}))+"\n      </a>\n\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.options:a)?e.isSkip:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'\n      <a class="controls__button controls__volume" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-volume","","controls__icon",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Volume",{name:"t",hash:{},data:d}))+'\n      </a>\n\n      <a class="controls__button controls__button--right controls__fullscreen" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-fullscreen","","controls__icon",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"FullScreen",{name:"t",hash:{},data:d}))+'\n      </a>\n\n      <a class="controls__button controls__button--right controls__options" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-cog","","controls__icon",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Options",{name:"t",hash:{},data:d}))+"\n      </a>\n\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.options:a)?e.isTranscript:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+'\n      <a class="controls__button controls__button--right controls__subtitles" href="#" tabindex="1" role="button">\n        '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"subtitle","","controls__icon",{name:"icon",hash:{},data:d}))+"\n        "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Subtitles",{name:"t",hash:{},data:d}))+'\n      </a>\n\n      <div class="controls__meta">\n        <div class="controls__detail"></div>\n\n        <div class="controls__meta__credits"></div>\n      </div>\n    </div>\n  </div>\n</div>\n'},useData:!0});return b.registerPartial("templates/controlsMaxi",c),c}),define("hbs!templates/controlsMini",["hbs","hbs/handlebars","templates/helpers/icon"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div class="controls controls--mini">\n  <div class="controls__toolbar">\n    <a class="controls__button controls__play" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-play","Play","controls__icon",{name:"icon",hash:{},data:d}))+'\n    </a>\n\n    <a class="controls__button controls__pause" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-pause","Pause","controls__icon",{name:"icon",hash:{},data:d}))+'\n    </a>\n\n    <a class="controls__button controls__volume" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-volume","Volume","controls__icon",{name:"icon",hash:{},data:d}))+'\n    </a>\n\n    <a class="controls__button controls__button--right controls__fullscreen" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-fullscreen","Toggle full screen","controls__icon",{name:"icon",hash:{},data:d}))+'\n    </a>\n\n    <a class="controls__button controls__button--right controls__options" href="#" tabindex="1" role="button">\n      '+this.escapeExpression((b.icon||a&&a.icon||b.helperMissing).call(a,"control-cog","Options","controls__icon",{name:"icon",hash:{},data:d}))+'\n    </a>\n\n    <span class="controls__time controls__time--elapsed">0:00</span>\n    <span class="controls__time controls__time--duration">0:00</span>\n\n    <div class="controls__scrub-wrapper">\n      <div class="controls__scrubber scrubber"></div>\n    </div>\n  </div>\n</div>\n'},useData:!0});return b.registerPartial("templates/controlsMini",c),c}),define("templates/helpers/formatDate",["Handlebars","moment"],function(a,b){"use strict";function c(a,c,d){return d&&d.hash&&d.hash.forceUTC?b(c||void 0).utc().format(a):b(c||void 0).format(a)}return a.registerHelper("formatDate",c),c}),define("hbs!templates/controlsMaxiDetail",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/formatDate"],function(a,b){
var c=b.template({1:function(a,b,c,d){var e;return"    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Playlist:",{name:"t",hash:{},data:d}))+"\n    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"playing",{name:"t",hash:{},data:d}))+"\n    "+this.escapeExpression((e=null!=(e=b.index||(null!=a?a.index:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"index",hash:{},data:d}):e))+"\n    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"of",{name:"t",hash:{},data:d}))+"\n    "+this.escapeExpression((e=null!=(e=b.talksCount||(null!=a?a.talksCount:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"talksCount",hash:{},data:d}):e))+"\n"},3:function(a,b,c,d){var e;return"    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Filmed",{name:"t",hash:{},data:d}))+"\n    "+this.escapeExpression((b.formatDate||a&&a.formatDate||b.helperMissing).call(a,"MMMM YYYY",null!=a?a.filmed:a,{name:"formatDate",hash:{forceUTC:!0},data:d}))+"\n    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"at",{name:"t",hash:{},data:d}))+"\n    "+this.escapeExpression((e=null!=(e=b.event||(null!=a?a.event:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"event",hash:{},data:d}):e))+"\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f;return'<div class="controls__meta__details">\n'+(null!=(e=b["if"].call(a,null!=a?a.isPlaylist:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")+'</div>\n<h3 class="controls__meta__title">'+this.escapeExpression((f=null!=(f=b.name||(null!=a?a.name:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"name",hash:{},data:d}):f))+"</h3>\n"},useData:!0});return b.registerPartial("templates/controlsMaxiDetail",c),c}),define("jqueryui/mouse",["jquery"],function(a){return function(a,b){var c=!1;a(document).mouseup(function(){c=!1}),a.widget("ui.mouse",{version:"@VERSION",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=1===b.which,f="string"==typeof this.options.cancel&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(b)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(b)!==!1,!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(a),a}),define("touchPunch",["jquery","jqueryui/mouse"],function(a,b){return function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind("touchstart",a.proxy(b,"_touchStart")).bind("touchmove",a.proxy(b,"_touchMove")).bind("touchend",a.proxy(b,"_touchEnd")),e.call(b)}}}(a),a}),define("widgets/slider",["jquery","jqueryui/widget","jqueryui/mouse","touchPunch"],function(a){"use strict";return a.widget("ted.slider",a.ui.mouse,{options:{distance:0,orientation:"horizontal",value:0,change:null,slide:null,start:null,stop:null},value:function(a){return arguments.length&&(this.options.value=a,this._refreshValue()),this.options.value},_change:function(a){this._trigger("change",a,this._getData({value:this.value()}))},_create:function(){this._detectOrientation(),this._mouseInit();var b=a("<div class=slider__progress></div>");this.progressElement=b,this.cursorElement=a("<div class=slider__cursor></div>").appendTo(this.progressElement),this.element.addClass("slider slider--"+this.orientation).append(this.progressElement)},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_getData:function(a){return a},_mouseCapture:function(a){var b,c;return this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),b={x:a.pageX,y:a.pageY},c=this._valueFromPosition(b),this._start(a),this._slide(a,c),!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._valueFromPosition(b);return this._slide(a,c),!1},_mouseStart:function(){return!0},_mouseStop:function(a){return this._mouseDrag(a),this._stop(a),this._change(a),!1},_refreshValue:function(){var a=this.value();this.progressElement.css("vertical"===this.orientation?"height":"width",100*a+"%")},_slide:function(a,b){this._trigger("slide",a,this._getData({value:b})),this.value(b)},_start:function(a){this.element.addClass("slider--active"),this._trigger("start",a)},_stop:function(a){this.element.removeClass("slider--active"),this._trigger("stop",a)},_valueFromPosition:function(a){var b,c,d;return"vertical"===this.orientation?(d=this.elementSize.height,c=a.y-this.elementOffset.top):(d=this.elementSize.width,c=a.x-this.elementOffset.left),b=c/d,b>1&&(b=1),0>b&&(b=0),"vertical"===this.orientation&&(b=1-b),b}}),function(b,c){return a(b).slider(c)}}),define("widgets/scrubber",["jquery","lib/ga","widgets/slider"],function(a,b){"use strict";var c="scrubber",d=c+"--active",e=c+"--hover",f=c+"__cursor",g=c+"__playhead",h=c+"__progress";return a.widget("ted.scrubber",a.ted.slider,{options:{duration:null,player:null},_isScrubbing:!1,_isSeeking:!1,_progress:0,_create:function(){this.options.player&&this._setPlayer(),this.playheadElement=a("<div class="+g+"></div>").prependTo(this.element),this._super(),this.element.addClass(c),this.cursorElement.addClass(f),this.progressElement.addClass(h),this._on(this._handleEvents)},_getData:function(b){return a.extend({cursor:b.value*this.options.duration,playhead:this._progress*this.options.duration,progress:this._progress,duration:this.options.duration},b)},_handleEvents:{mouseover:function(){this.element.addClass(e)},mouseout:function(){this.element.removeClass(e)},scrubberstart:function(){this.element.addClass(d),this._isScrubbing=!0},scrubberstop:function(){this.element.removeClass(d),this._isScrubbing=!1}},_setOption:function(a,b){this._super(a,b),"duration"===a&&this.progress(this._getData({value:this._progress}).playhead/b)},_setPlayer:function(){var c=this,d=a(this.options.player),e=d.player("talk");this.option("duration",e.duration),this._on({scrubberchange:function(a,c){d.player("seek",c.cursor),b.sendEvent("player","seek","scrubber",Math.round(c.cursor))}}),d.on("playertalk",function(a,b){c.option("duration",b.duration),c.progress(0)}).on("playerduration",function(a,b){c.option("duration",b.duration)}).on("playerseeking",function(){c._isSeeking=!0}).on("playerseeked",function(){c._isSeeking=!1}).on("playerprogress",function(a,b){c.progress(b.progress)})},isSeeking:function(a){return arguments.length&&(this._isSeeking=!!a),this._isScrubbing||this._isSeeking},progress:function(a){if(arguments.length){var b=100*a+"%";this.progressElement&&!this.isSeeking()&&this.progressElement.width(b),this.playheadElement&&this.playheadElement.width(b),this._progress=a,this._trigger("progress",null,this._getData({value:a}))}return this._progress}}),function(b,c){return a(b).scrubber(c)}}),define("jqueryui/position",["jquery"],function(a){return function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]),e=!!c[0]&&9===c[0].nodeType;return{element:c,isWindow:d,isDocument:e,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:0>d?"left":c>0?"right":"center",vertical:0>f?"top":e>0?"bottom":"middle"};l>n&&h(c+d)<n&&(i.horizontal="center"),m>p&&h(e+f)<p&&(i.vertical="middle"),g(h(c),h(d))>g(h(e),h(f))?i.important="horizontal":i.important="vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):j>0&&0>=i?a.left=e:i>j?a.left=e+f-b.collisionWidth:a.left=e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):j>0&&0>=i?a.top=e:i>j?a.top=e+f-b.collisionHeight:a.top=e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||c<h(k))&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||h(d)<l)&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(a),a}),define("widgets/popup",["jquery","lodash","jqueryui/widget","jqueryui/position"],function(a,b){"use strict";function c(a,b){this.element.removeClass(g).css(a).addClass(e+b.horizontal+" "+e+("center"===b.vertical?"middle":b.vertical))}for(var d=300,e="popup--tailed--",f=["center","left","middle","right","bottom","top"],g="",h=f.length;h--;)g+=e+f[h]+" ";return a.widget("ted.popup",{options:{position:{my:"center bottom-20",at:"center top",of:window,collision:"fit flip"},inverse:!1,tail:!0},_create:function(){this.options.position.using||(this.options.position.using=b.bind(c,this)),this.element.addClass("popup"+(this.options.tail?" popup--tailed":"")+(this.options.inverse?" popup--inverse":" inverse"))},_isOpen:!1,open:function(a){var b=this;b._trigger("beforeOpen",a)!==!1&&(b.position(),b._isOpen=!0,b.element.removeClass("popup--hide").addClass("popup--show"),b._trigger("open"))},close:function(a){var b=this,c=b.element;b._trigger("beforeClose",a)!==!1&&(b._isOpen=!1,c.addClass("popup--hide"),setTimeout(function(){b._isOpen||c.removeClass("popup--show")},d),b._trigger("close"))},position:function(){this.element.addClass("popup--positioning").position(this.options.position).removeClass("popup--positioning")}}),function(b,c){return a(b).popup(c)}}),define("widgets/tooltip",["jquery","lodash","jqueryui/widget","widgets/popup"],function(a){"use strict";var b;return a.widget("ted.tooltip",{options:{content:"",interactive:!1,interactiveTolerance:350,position:{},openDelay:0,supportTouch:!0,allowClick:!1},_create:function(){var c;b||(b=a(document.body)),this.element.addClass("tooltip"),this.options.position.of=this.element,this.popupObject=a("<div class=tooltip__popup>").append(this.options.content).popup(this.options).insertAfter(this.element),c=this.element,this.options.interactive&&(c=c.add(this.popupObject)),this._on(c,this._handleEvents),this._on(a("#shoji"),{click:function(b){!this._isOpened||this.options.interactive&&a(b.target).closest(this.popupObject).length||(this._isOpened=!1,this.popupObject.popup("close"))}})},_isHoverClickEnabled:!1,_isFirstTouch:!1,_isTouched:!1,_isMousedOver:!1,_handleEvents:{touchstart:function(){this._isTouched=!0,this._isHoverClickEnabled||(this._isFirstTouch=!0)},mouseover:function(a){var b=this,c=b.options.openDelay||0;!this.options.supportTouch&&this._isTouched||(this._isMousedOver=!0,this._isOpened&&(c=0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){b._isMousedOver&&b.openPopup(a)},c))},mouseout:function(a){var b=this,c=this.options.interactiveTolerance||0;this._isMousedOver=!1,this._isOpened||(c=0),clearTimeout(this.timeout),this.timeout=setTimeout(function(){b._isMousedOver||b.closePopup(a)},c)},click:function(b){a(b.target).closest(this.element).length&&(!this.options.supportTouch&&this._isTouched||(this.openPopup(b),!this._isFirstTouch&&this._isHoverClickEnabled&&this._trigger("hoverclick",b),this._isFirstTouch=!1),this.options.allowClick||(b.preventDefault(),b.stopPropagation()))},popupopen:function(){this._isHoverClickEnabled=!0},popupclose:function(){this._isHoverClickEnabled=!1}},_setOption:function(a,b){"content"===a&&this.popupObject.html(b)},openPopup:function(a){this._isOpened=!0,this.popupObject.popup("open",a)},closePopup:function(a){this.popupObject.popup("close",a),this._off(b,"click"),this._isOpened=!1},popup:function(){return this.popupObject}}),function(b,c){return a(b).tooltip(c)}}),define("widgets/volume",["jquery","widgets/slider","widgets/tooltip"],function(a){"use strict";var b="volume",c=b+"--muted",d=b+"-slider",e=d+"--muted",f=d+"__progress";return a.widget("ted.volume",a.ted.tooltip,{options:{content:"<div class="+d+">",interactive:!0,inverse:!0,interactiveTolerance:1e3,player:null,value:0},sliderElement:null,_create:function(){this._super(),this.element.addClass(b),this.sliderElement=this.popupObject.find("div."+d),this.sliderElement.slider({orientation:"vertical"}),this.options.player&&this._setPlayer(),this._on(this.sliderElement,this._handleSliderEvents),this.sliderElement.find("div.slider__progress").addClass(f)},_handleEvents:{volumehoverclick:function(){this.mute(!this.mute())}},_handleSliderEvents:{sliderchange:function(a,b){this.closePopup(a),this._trigger("change",a,b)},sliderslide:function(a,b){this.openPopup(a),this._trigger("slide",a,b)}},_setPlayer:function(){var b=this,c=a(this.options.player);this._on({volumemute:function(a,b){c.player("mute",b.mute)},volumechange:function(a,b){c.player("volume",b.value)},volumeslide:function(a,b){c.player("volume",b.value)}}),c.on("playermuted",function(a,c){b.mute(c.muted)}).on("playervolume",function(a,c){b.value(c.volume)}),b.mute(c.player("mute")),b.value(c.player("volume"))},_isMuted:!1,mute:function(a){if(arguments.length){if(a=!!a,a===this._isMuted)return;this._isMuted=a;var b=a?"addClass":"removeClass";this.element[b](c),this.sliderElement[b](e),this._trigger("mute",null,{mute:a})}return this._isMuted},value:function(a){return arguments.length&&this.sliderElement.slider("value",a),this.sliderElement.slider("value")}}),function(b,c){return a(b).volume(c)}}),define("hbs!templates/playerOptions",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="Player-options__rate">\n  <h4 class="h10 m5" style="width:200px">Playback rate:</h4>\n\n  <ul class="sl p4">\n    <li class="Player-options__rate__item">\n      <label>\n        <input class="Player-options__rate__input" type=radio name="'+this.escapeExpression((e=null!=(e=b.id||(null!=a?a.id:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"id",hash:{},data:d}):e))+'-rate" value=1 checked>\n        &nbsp;\n        Normal\n      </label>\n    </li>\n\n    <li class="Player-options__rate__item">\n      <label>\n        <input class="Player-options__rate__input" type=radio name="'+this.escapeExpression((e=null!=(e=b.id||(null!=a?a.id:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"id",hash:{},data:d}):e))+'-rate" value=1.5>\n        &nbsp;\n        1.5x\n        <em>(faster)</em>\n      </label>\n    </li>\n\n    <li class="Player-options__rate__item">\n      <label>\n        <input class="Player-options__rate__input" type=radio name="'+this.escapeExpression((e=null!=(e=b.id||(null!=a?a.id:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"id",hash:{},data:d}):e))+'-rate" value=2>\n        &nbsp;\n        2x\n        <em>(fastest)</em>\n      </label>\n    </li>\n  </ul>\n</div>\n'},useData:!0});return b.registerPartial("templates/playerOptions",c),c}),define("widgets/playerOptions",["jquery","hbs!templates/playerOptions","widgets/tooltip"],function(a,b){"use strict";var c=0,d="Player-options";a.widget("ted.playerOptions",a.ted.tooltip,{options:{interactive:!0,inverse:!0,player:null},_create:function(){this.options.content=b({id:"player-options-"+ ++c}),this._super(),this.element.addClass(d),this._on(this.popupObject,{"click input.Player-options__rate__input":function(b){this._trigger("playbackRate",b,{playbackRate:+a(b.target).val()})}}),this.options.player&&this._setPlayer()},_setPlayer:function(){var b=this,c=a(b.options.player);b._on({playeroptionsplaybackrate:function(a,b){c.player("playbackRate",b.playbackRate)}}),c.on("playerplaybackrate",function(a,c){b._setPlaybackRate(c.playbackRate)}),b._setPlaybackRate(c.player("playbackRate"))},_setPlaybackRate:function(a){this.popupObject.find('input.Player-options__rate__input[value="'+a+'"]').prop("checked",!0)}})}),define("hbs!templates/subtitleCredits",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){return"    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"transcript",{name:"t",hash:{},data:d}))+"\n"},3:function(a,b,c,d){return"    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"translation",{name:"t",hash:{},data:d}))+"\n"},5:function(a,b,c,d){var e;return"    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"by",{name:"t",hash:{},data:d}))+'\n    <a href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.translator:a)?e.uri:e,a))+'" target="_blank">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.translator:a)?e.name:e,a))+"</a>"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.reviewer:a)?e.name:e,{name:"if",hash:{},fn:this.program(6,d,0),inverse:this.noop,data:d}))?e:"")+"\n"},6:function(a,b,c,d){return","},8:function(a,b,c,d){var e;return"    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"reviewed by",{name:"t",hash:{},data:d}))+'\n    <a href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.reviewer:a)?e.uri:e,a))+'" target="_blank">'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.reviewer:a)?e.name:e,a))+"</a>.\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return"<div>\n  "+this.escapeExpression(this.lambda(null!=(e=null!=a?a.language:a)?e.name:e,a))+"\n\n"+(null!=(e=b["if"].call(a,null!=a?a.isTranscript:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.program(3,d,0),data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.translator:a)?e.name:e,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.reviewer:a)?e.name:e,{name:"if",hash:{},fn:this.program(8,d,0),inverse:this.noop,data:d}))?e:"")+'\n  <a class="l3" href="/talks?language='+this.escapeExpression(this.lambda(null!=(e=null!=a?a.language:a)?e.code:e,a))+'" target="_blank">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"More talks in",{name:"t",hash:{},data:d}))+" "+this.escapeExpression(this.lambda(null!=(e=null!=a?a.language:a)?e.name:e,a))+"</a>\n</div>\n"},useData:!0});return b.registerPartial("templates/subtitleCredits",c),c}),define("widgets/subtitleCredits",["jquery","lodash","hbs!templates/subtitleCredits"],function(a,b,c){"use strict";var d="subtitle-credits",e=d+"--visible";return a.widget("ted.subtitleCredits",{options:{activeLanguage:!1,player:null,talkSlug:null},_create:function(){this.element.addClass(d),this.options.player&&this._setPlayer()},_setPlayer:function(){var a=this,b=a.options.player;this._on(a.options.player,{playersubtitle:function(b,c){a.activateLanguage(c.subtitle?c.subtitle.languageCode:!1)},playertalk:function(b,c){a.option("talkSlug",c.slug)}}),a._setOption("talkSlug",b.player("talk").slug);var c=b.player("subtitle");a.activateLanguage(c?c.languageCode:!1)},_setOption:function(a,b){this._super(a,b),"talkSlug"!==a&&"activeLanguage"!==a||this.activateLanguage(this.options.activeLanguage)},activateLanguage:function(c){c&&this.options.talkSlug?(this.options.activeLanguage=c,a.getJSON("/talks/"+this.options.talkSlug+"/caption_credits",{language:c}).then(b.bind(this.setSubtitleData,this),b.bind(this.hide,this))):this.hide(),this._trigger("activateLanguage",null,{languageCode:c})},setSubtitleData:function(a){return a.translator&&a.translator.name||a.reviewer&&a.reviewer.name?(a.isTranscript=a.languageCode===this.options.player.player("talk").nativeLanguage,this.element.html(c(a)),void this.show()):this.hide()},hide:function(){this._trigger("hide"),this.element.removeClass(e)},show:function(){this._trigger("show"),this.element.addClass(e)}}),function(b,c){return a(b).subtitleCredits(c)}}),define("widgets/hover",["jquery","lodash","jqueryui/widget"],function(a,b){"use strict";function c(a,b,c){return Math.abs(a[0]-b[0])>c||Math.abs(a[1]-b[1])>c}function d(a){a._hoverIsTouchTriggered=!1}var e=a(document);a.widget("ted.hover",{options:{hoverIdleDelay:4e3,hoverStartDelay:200,hoverStopDelay:400,hoverSwipeTolerance:5},hoverState:function(a){return b.isUndefined(a)||this._hoverChangeState(null,!!a),this._hoverIsOn},_hoverIsClicking:!1,_hoverIsOn:!1,_hoverIsTouchTriggered:!1,_hoverLastCoords:null,_hoverStartTimeout:null,_hoverIdleTimeout:null,_hoverStopTimeout:null,_hoverChangeStateBound:null,_hoverMoveChangeBound:null,_hoverMouseMoveThrottled:null,_hoverTouchOutBound:null,_create:function(){this._hoverInit()},_hoverEvents:function(){return{mouseenter:this._hoverMouseMoveThrottled,mousemove:this._hoverMouseMoveThrottled,mouseleave:this._hoverOut,touchstart:this._hoverTouchStart,touchend:this._hoverTouchEnd,touchmove:this._hoverTouchMove,touchcancel:this._hoverTouchCancel,mousedown:this._hoverMouseDown,mouseup:this._hoverMouseUp,click:this._hoverMouseClick}},_hoverMove:function(a){this._hoverIsOn?this._hoverMoveChange(a):this._hoverStartSetTimeout(a)},_hoverMoveChange:function(a){var b={x:a.pageX||null,y:a.pageY||null};"mousedown"!==a.type&&"touchstart"!==a.type&&this._hoverLastCoords&&b.x&&b.x===this._hoverLastCoords.x&&b.y===this._hoverLastCoords.y||(this._hoverLastCoords=b,this._hoverChangeState(a,!0),this._hoverIdleSetTimeout(a))},_hoverOut:function(a){this._hoverStartClearTimeout(),this._hoverStopSetTimeout(a)},_hoverMouseClick:function(a){this._hoverIsTouchTriggered||this._hoverIsOn&&this._trigger("tap",a)},_hoverMouseDown:function(){this._hoverIsTouchTriggered||(this._hoverIsClicking=!0,this._hoverIdleClearTimeout())},_hoverMouseMove:function(a){this._hoverIsTouchTriggered||this._hoverMove(a)},_hoverMouseUp:function(a){this._hoverIsTouchTriggered||(this._hoverIsClicking=!1,this._hoverIdleSetTimeout(a))},_hoverTouchStart:function(){this._hoverIsTouchTriggered=!0,this._hoverTouchStartCoords=null,this._hoverTouchEndCoords=null},_hoverTouchEnd:function(a){this._hoverTouchSafetyTimeout&&window.clearTimeout(this._hoverTouchSafetyTimeout),this._hoverTouchSafetyTimeout=b.delay(d,600,this),this._hoverTouchEndCoords&&c(this._hoverTouchStartCoords,this._hoverTouchEndCoords,this.options.hoverSwipeTolerance)||(this._hoverIsOn&&this._trigger("tap",a),this._hoverMoveChange(a))},_hoverTouchCancel:function(a){a.preventDefault()},_hoverTouchMove:function(a){var b=a.originalEvent.touches[0],c=[b.pageX,b.pageY];null===this._hoverTouchStartCoords?this._hoverTouchStartCoords=c:this._hoverTouchEndCoords=c,this._hoverIsOn&&this._hoverMove(a)},_hoverTouchOut:function(b){a(b.target).closest(this.element).length||this._hoverChangeState(b,!1)},_hoverChangeState:function(a,b){b=!!b,this._hoverIdleClearTimeout(),this._hoverStartClearTimeout(),this._hoverStopClearTimeout(),!b&&this._hoverIsClicking||b!==this._hoverIsOn&&(this._hoverIsOn=b,this[b?"_hoverStart":"_hoverStop"](a),b?this._on(e,{touchstart:this._hoverTouchOutBound}):this._off(e,"touchstart"))},_hoverStartSetTimeout:function(a){this._hoverStartTimeout||(this._hoverStartTimeout=b.delay(this._hoverMoveChangeBound,this.options.hoverStartDelay,a))},_hoverStartClearTimeout:function(){this._hoverStartTimeout&&(window.clearTimeout(this._hoverStartTimeout),this._hoverStartTimeout=null)},_hoverStopSetTimeout:function(a){this._hoverStopClearTimeout(),this._hoverStopTimeout=b.delay(this._hoverChangeStateBound,this.options.hoverStopDelay,a,!1)},_hoverStopClearTimeout:function(){this._hoverStopTimeout&&(window.clearTimeout(this._hoverStopTimeout),this._hoverStopTimeout=null)},_hoverIdleSetTimeout:function(a){this._hoverIdleClearTimeout(),!this._hoverIsClicking&&this.options.hoverIdleDelay&&(this._hoverIdleTimeout=b.delay(this._hoverChangeStateBound,this.options.hoverIdleDelay,a,!1))},_hoverIdleClearTimeout:function(){this._hoverIdleTimeout&&(window.clearTimeout(this._hoverIdleTimeout),this._hoverIdleTimeout=null)},_hoverInit:function(){this._hoverChangeStateBound=b.bind(this._hoverChangeState,this),this._hoverMoveChangeBound=b.bind(this._hoverMoveChange,this),this._hoverTouchOutBound=b.bind(this._hoverTouchOut,this),this._hoverMouseMoveThrottled=b.throttle(b.bind(this._hoverMouseMove,this),100,{leading:!0,trailing:!1}),this._on(this._hoverEvents())},_hoverDestroy:function(){this._off(this._hoverEvents())},_hoverStart:function(a){this._trigger("start",a)},_hoverStop:function(a){this._trigger("stop",a)}})}),define("widgets/controls",["jquery","lodash","utils/formatDuration","utils/is_mobile","views/subtitle-modal","hbs!templates/controlsMaxi","hbs!templates/controlsMini","hbs!templates/controlsMaxiDetail","widgets/scrubber","widgets/volume","widgets/playerOptions","widgets/subtitleCredits","widgets/hover"],function(a,b,c,d,e,f,g,h){
"use strict";function i(a,b){return function(c){a.call(b,c)!==!1&&c.preventDefault()}}function j(a){return a=b.clone(a),a.filmed&&(a.filmed*=1e3),(a.index||0===a.index)&&(a.index+=1),a}var k="controls",l=k+"--fullscreen",m=k+"--with-credits",n=k+"--no-languages",o=k+"--hover",p=k+"--playing",q=k+"--paused",r=k+"--postrolling",s=k+"--unskipable",t=k+"__detail",u={maxi:f,mini:g};return a.widget("ted.controls",a.ted.hover,{options:{hover:!0,hoverStopDelay:3e3,player:null,postrollDuration:null,template:"maxi"},_create:function(){var e=this,f=this.options.template;f=this.options.template=u[f]||f;var g=a(f({options:this.options})).filter("div."+k);this.element.addClass(g.attr("class")).html(g.html());var h={};b.forOwn(this._buttonHandlers,function(a,b){h["click a."+k+"__"+b]=i(a,e)}),this._on(h);var j=this.element.find("span.controls__time--elapsed"),l=this.element.find("span.controls__time--duration");e.scrubber=this.element.find("div.controls__scrubber").scrubber({player:this.options.player,progress:function(a,b){e.scrubber&&!e.scrubber.scrubber("isSeeking")&&j.text(c(b.playhead)),l.text(c(b.duration))},slide:function(a,b){e.scrubber&&e.scrubber.scrubber("isSeeking")&&j.text(c(b.cursor))}}),this.volume=this.element.find("a.controls__volume").volume({player:this.options.player}),this._initSubtitles(),this.credits=this.element.find("div.controls__meta__credits"),this.credits.length&&this.credits.subtitleCredits({player:this.options.player}),this.playerOptions=this.element.find("a.controls__options").playerOptions({player:this.options.player}),this.details=this.element.find("div."+t),this._on(this.credits,{subtitlecreditsshow:function(){e.element.addClass(m)},subtitlecreditshide:function(){e.element.removeClass(m)}}),this.options.player.on("playerplay",b.bind(this._onPlay,this)),this.options.player.on("playerpause",b.bind(this._onPause,this)),this.options.player.on("playercomplete",b.bind(this._onPause,this)),this.options.player.on("playertalk",b.bind(this._onTalk,this)),this.options.player.on("playerenterfullscreen",b.bind(this._onEnterFullScreen,this)),this.options.player.on("playerexitfullscreen",b.bind(this._onExitFullScreen,this)),this.options.player.on("playerpostrollduration",b.bind(this._onTakeoverPostrollDuration,this)),this.options.player.on("playerpostrollremaining",b.bind(this._onPostrollRemaining,this)),this.options.player.on("playerpostrollcomplete",b.bind(this._onTakeoverPostrollComplete,this)),this._onTalk(),this.options.player.player("canFullScreen")&&this.element.addClass(k+"--can-fullscreen"),this.options.player.player("canPlaybackRate")&&this.element.addClass(k+"--can-options"),this.options.player.player("canSubtitle")&&this.element.addClass(k+"--can-subtitle"),d()||this.element.addClass(k+"--can-volume"),this.options.player.on("touchstart",function(a){e._hoverMove(a)}),this.options.hover&&this._hoverInit()},_buttonHandlers:{play:function(){this.options.player.player("play")},pause:function(){this.options.player.player("pause")},fullscreen:function(){this.options.player.player("toggleFullScreen")},skip:function(){this.options.player.player("playNext")}},_hoverStart:function(){this.element.addClass(o)},_hoverStop:function(){this.element.removeClass(o)},_onEnterFullScreen:function(){this.element.addClass(l)},_onExitFullScreen:function(){this.element.removeClass(l)},_onPlay:function(){this.element.addClass(p).removeClass(q)},_onPause:function(){this.element.addClass(q).removeClass(p)},_onTalk:function(){var a=this.options.player.player("talk"),c=this.options.player.player("talks").length,d=a.index>=c-1;this.element[a.languages.length?"removeClass":"addClass"](n),this.details.length&&this.details.html(h(b.extend(j(a),{isPlaylist:c>1,talksCount:c}))),this.element[d?"addClass":"removeClass"](s)},_onTakeoverPostrollDuration:function(a,b){this.options.postrollDuration=b.postrollDuration,this.element.addClass(r)},_onTakeoverPostrollComplete:function(){this.$postrollProgress.width("100%"),this.element.removeClass(r)},_onPostrollRemaining:function(a,b){this.$postrollProgress||(this.$postrollProgress=this.element.find("div.controls__postbar__progress"),this.$postrollTime=this.element.find("span.controls__adtime__value")),this.$postrollProgress.width(100*(1-b.postrollRemaining/this.options.postrollDuration)+"%"),this.$postrollTime.text(c(b.postrollRemaining))},_initSubtitles:function(){var a=this.element.find("a.controls__subtitles"),b=this.options.player;if(a.length&&b.player("canSubtitle")){var c=new e;this.subtitles=c;var d;b.on({playersubtitle:function(a,b){d=b&&b.subtitle&&b.subtitle.languageCode?b.subtitle.languageCode:!1,c.state.set("selected",d)},playertalk:function(a,b){c.state.set("languages",b.languages)}});var f=b.player("subtitle");c.state.set("selected",f&&f.languageCode),c.state.set("languages",b.player("talk").languages),c.render(),c.state.on("change:selected",function(a,e){var f=String(d);e=String(e);var g=e!==f,h=!!e&&g;g&&(b.player("subtitle",e),c.close()),h&&b.player("play")}),a.on("click",function(a){a.preventDefault(),c.open()})}}}),function(b,c){return a(b).controls(c)}}),define("widgets/player/ga-tracker",["lodash","Modernizr","lib/ga"],function(a,b,c){"use strict";function d(a){this._data={currentPlayerTime:null,hasPlayed:!1,lastPlayedTalkId:null,lastChangedTalkId:null,lastLanguageCode:null,marks:null,markableProgress:[25,50,75,95],markableTimes:[],postRolling:!1},this._widget=a,this._resetMarks(),this._addHandlers()}return d.prototype._resetMarkableTimes=function(b){this._data.markableTimes=a.union([10,30,60,90],a.range(120,b+1,120))},d.prototype._resetMarks=function(){this._data.marks={times:{},progress:{},ads:{}}},d.prototype._incrementTalkViews=function(){var a=require("Cookies").get("__utma");if(a&&b.localstorage){var d=+a.split(".").pop(),e=window.localStorage,f="talkViews",g=(e.getItem(f)||"").split("|");2===g.length&&+g[0]===d?g[1]=+g[1]+1:g=[d,1],e.setItem(f,g.join("|")),c.set("metric1",g[1])}},d.prototype._onTalkChange=function(){this._data.postRolling=!1,this._resetMarks(),this._incrementTalkViews()},d.prototype._addHandlers=function(){var a=this,b={playererror:function(a,b){var d=b.error,e="abortive"===d.severity;(e||"fatal"===d.severity)&&c.sendEvent("player",e?"error.abort":"error.fatal",d.message)},playerenterfullscreen:function(){c.sendEvent("player","enterFullScreen")},playerexitfullscreen:function(){c.sendEvent("player","exitFullScreen")},playerplay:function(){var b=a._widget.options.currentTalk.id;c.sendEvent("player","start",a._data.hasPlayed?"subsequent":"initial"),a._data.hasPlayed=!0,a._data.lastPlayedTalkId!==b&&(c.sendEvent("player.talk","start",b),a._data.lastPlayedTalkId=b)},playerpause:function(){c.sendEvent("player","pause",Math.round(a._data.currentPlayerTime))},playerready:function(){var b=a._widget.mode();c.sendEvent("player","initialize",b,{nonInteraction:1})},playerrequestnext:function(){c.sendEvent("player","next",a._data.postRolling?"postroll":"talk")},playerrequestplay:function(){c.sendEvent("player","request",a._data.hasPlayed?"subsequent":"initial")},playerprogress:function(b,d){var e=100*d.progress,f=0,g=-1,h=a._data.markableProgress.length;if(!a._widget.player.postrolling)for(;a._data.marks&&++g<h&&e>f;)f=a._data.markableProgress[g],e>=f&&!a._data.marks.progress[f]&&(a._data.currentPlayerTime>a._widget.options.startTrackingAt&&c.sendEvent("player","progressPct",f+"%"),a._data.marks.progress[f]=!0)},playertalkcomplete:function(){a._data.marks&&!a._data.marks.progress[100]&&(c.sendEvent("player","progressPct","100%"),a._data.marks.progress[100]=!0,c.sendEvent("player.talk","complete",a._widget.options.currentTalk.id))},playercurrenttime:function(b,d){var e=d.currentTime,f=0,g=-1,h=a._data.markableTimes.length;if(a._data.currentPlayerTime=e,!a._widget.player.postrolling)for(;a._data.marks&&++g<h&&e>f;)f=a._data.markableTimes[g],e>=f&&!a._data.marks.times[f]&&(f>a._widget.options.startTrackingAt&&c.sendEvent("player","progressTime",f+" seconds"),a._data.marks.times[f]=!0)},playerprerollstart:function(){a._data.marks&&!a._data.marks.ads.prerollStart&&(c.sendEvent("player.preRoll","cardStart"),a._data.marks.ads.prerollStart=!0)},playerprerollblock:function(){a._data.marks&&!a._data.marks.ads.prerollBlock&&(c.sendEvent("player.preRoll","cardBlock"),a._data.marks.ads.prerollBlock=!0)},playerpostrollstart:function(){a._data.postRolling=!0,a._data.marks&&!a._data.marks.ads.postrollStart&&(c.sendEvent("player.postRoll","adStart"),a._data.marks.ads.postrollStart=!0)},playerpostrollcomplete:function(){a._data.postRolling=!1,a._data.marks&&!a._data.marks.ads.postrollComplete&&(c.sendEvent("player.postRoll","adComplete"),a._data.marks.ads.postrollStart=!0)},playeradblock:function(){c.sendEvent("player","adBlock")},playerduration:function(b,c){a._widget.player.postrolling||a._resetMarkableTimes(c.duration)},playersubtitle:function(b,d){var e=String(d.subtitle&&d.subtitle.languageCode);e!==a._data.lastLanguageCode&&(e?c.sendEvent("player.subtitle","setLanguage",e):c.sendEvent("player.subtitle","disable")),a._data.lastLanguageCode=e},playertalk:function(b,c){var d=c.id;a._data.lastChangedTalkId!==d&&(a._onTalkChange(),a._data.lastChangedTalkId=d)}};this._handlers=b,this._widget._on(b)},d}),define("widgets/player/ted-tracker",["jquery","lodash","lib/currentUserId","utils/ted"],function(a,b,c,d){"use strict";function e(a){var b=d("zone")||{};this._data={lastMetaTalkId:null,lastPlayTalkId:null,vmAPIKey:b.api_key||"unknown"},this._widget=a,this._addHandlers()}return e.prototype._sendVM=function(c){var d=b.extend({},c,{share_token:this._widget.options.shareToken});a.post("/talks/"+this._widget.talk().id+"/views",{view:d},null,"json")},e.prototype._recordViewID=function(){this._widget.options.recordInIdentity&&c.get()&&a.post("/talks/"+this._widget.talk().id+"/user_views",{},null,"json")},e.prototype._recordViewVM=function(){var a=this._widget.mode();if("hls"===a&&this._sendVM({apikey:this._data.vmAPIKey,format:"hls",quality:"variant",service:"ted_player_html5_hls"}),"flash"===a&&this._sendVM({apikey:this._data.vmAPIKey,format:"hls",quality:"variant",service:"ted_player_flash_hls"}),"h264"===a){var b=this._widget.options.currentTalk.resources.h264[0].bitrate;this._sendVM({apikey:this._data.vmAPIKey,format:"mp4",quality:b?b+"k":"variant",service:"ted_player_html5_mp4"})}},e.prototype._onTalkPlay=function(){this._recordViewID(),this._recordViewVM()},e.prototype._addHandlers=function(){var a=this,b={playerrequestplay:function(){a._widget._ytPlayer&&a._widget._ytPlayer.playVideo&&a._sendVM({apikey:"botw",service:"botw"})},playerplay:function(){var b=a._widget.options.currentTalk.id;a._data.lastPlayTalkId!==b&&(a._onTalkPlay(),a._data.lastPlayTalkId=b)}};this._handlers=b,this._widget._on(b)},e});var ns_=window.ns_=window.ns_||{};ns_.StreamSense=ns_.StreamSense||function(){function a(a,b){var d=a||"",e="undefined",f=k.comScore||k.sitestat||function(a){var b,d,f,g,h,j="comScore=",m=l.cookie,n="",o="indexOf",p="substring",r="length",s=c.browserAcceptsLargeURLs()?q.URL_LENGTH_LIMIT:q.RESTRICTED_URL_LENGTH_LIMIT,t="&ns_",u="&",v=k.encodeURIComponent||escape;if(m[o](j)+1)for(g=0,f=m.split(";"),h=f[r];h>g;g++)d=f[g][o](j),d+1&&(n=u+unescape(f[g][p](d+j[r])));a+=t+"_t="+ +new Date+t+"c="+(l.characterSet||l.defaultCharset||"")+n,a.length>s&&a.indexOf(u)>0&&(b=a.substr(0,s-8).lastIndexOf(u),a=(a.substring(0,b)+t+"cut="+v(a.substring(b+1))).substr(0,s)),i.httpGet(a),typeof ns_p===e&&(ns_p={src:a}),ns_p.lastMeasurement=a};if(typeof b!==e){var g=[],h=k.encodeURIComponent||escape;for(var j in b)b.hasOwnProperty(j)&&g.push(h(j)+"="+h(b[j]));/[\?\&]$/.test(d)||(d+="&"),d+=g.join("&")}return f(d)}function b(a,b){for(var d,e=k.encodeURIComponent||escape,f=[],g=q.LABELS_ORDER,h=a.split("?"),i=h[0],j=h[1],m=j.split("&"),n=0,o=m.length;o>n;n++){var p=m[n].split("="),r=unescape(p[0]),s=unescape(p[1]);r&&(b[r]=s)}for(var t={},n=0,o=g.length;o>n;n++){var u=g[n];if(b.hasOwnProperty(u)){var v=b[u];"undefined"!=typeof v&&null!=v&&(t[u]=!0,f.push(e(u)+"="+e(b[u])))}}for(var u in b)if(!t[u]&&b.hasOwnProperty(u)){var v=b[u];"undefined"!=typeof v&&null!=v&&f.push(e(u)+"="+e(b[u]))}d=i+"?"+f.join("&"),d=d+(d.indexOf("&c8=")<0?"&c8="+e(l.title):"")+(d.indexOf("&c7=")<0?"&c7="+e(l.URL):"")+(d.indexOf("&c9=")<0?"&c9="+e(l.referrer):"");var w=c.browserAcceptsLargeURLs()?q.URL_LENGTH_LIMIT:q.RESTRICTED_URL_LENGTH_LIMIT;if(d.length>w&&d.indexOf("&")>0){var x=d.substr(0,w-8).lastIndexOf("&");d=(d.substring(0,x)+"&ns_cut="+e(d.substring(x+1))).substr(0,w)}return d}var c=function(){var a={uid:function(){var a=1;return function(){return+new Date+"_"+a++}}(),filter:function(a,b){var c={};for(var d in b)b.hasOwnProperty(d)&&a(b[d])&&(c[d]=b[d]);return c},extend:function(a){var b,c=arguments.length;a=a||{};for(var d=1;c>d;d++)if(b=arguments[d])for(var e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);return a},getString:function(a,b){var c=String(a);return null==a?b||"na":c},getLong:function(a,b){var c=Number(a);return null==a||isNaN(c)?b||0:c},getInteger:function(a,b){var c=Number(a);return null==a||isNaN(c)?b||0:c},getBoolean:function(a,b){var c="true"==String(a).toLowerCase();return null==a?b||!1:c},isNotEmpty:function(a){return"undefined"!=typeof a&&null!=a&&"undefined"!=typeof a.length&&a.length>0},indexOf:function(b,c){var d=-1;return a.forEach(c,function(a,c){a==b&&(d=c)}),d},forEach:function(a,b,c){try{if("function"==typeof b)if(c="undefined"!=typeof c?c:null,"number"!=typeof a.length||"undefined"==typeof a[0]){var d="undefined"!=typeof a.__proto__;for(var e in a)(!d||d&&"undefined"==typeof a.__proto__[e])&&"function"!=typeof a[e]&&b.call(c,a[e],e)}else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e)}catch(g){}},regionMatches:function(a,b,c,d,e){if(0>b||0>d||b+e>a.length||d+e>c.length)return!1;for(;--e>=0;){var f=a.charAt(b++),g=c.charAt(d++);if(f!=g)return!1}return!0},size:function(a){var b,c=0;for(var b in a)a.hasOwnProperty(b)&&c++;return c},log:function(a,b){if("undefined"!=typeof b&&b){var c=new Date,d=c.getHours()+":"+c.getMinutes()+":"+c.getSeconds();console.log(d,a)}},isTrue:function(a){return"undefined"==typeof a?!1:"string"==typeof a?(a=a.toLowerCase(),"true"===a||"1"===a||"on"===a):!!a},toString:function(b){if("undefined"==typeof b)return"undefined";if("string"==typeof b)return b;if("[object Array]"===Object.prototype.toString.call(b))return b.join(",");if(a.size(b)>0){var c="";for(var d in b)b.hasOwnProperty(d)&&(c+=d+":"+b[d]+";");return c}return b.toString()},exists:function(a){return"undefined"!=typeof a&&null!=a},firstGreaterThan0:function(){for(var a=0,b=arguments.length;b>a;a++){var c=arguments[a];if(c>0)return c}return 0},cloneObject:function(a){if(null==a||"object"!=typeof a)return a;var b=a.constructor();for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b},safeGet:function(b,c){return c=a.exists(c)?c:"",a.exists(b)?b:c},getBrowserName:function(){var a,b,c=navigator.userAgent,d=navigator.appName;return-1!=(b=c.indexOf("Opera"))||-1!=(b=c.indexOf("OPR/"))?d="Opera":-1!=(b=c.indexOf("Android"))?d="Android":-1!=(b=c.indexOf("Chrome"))?d="Chrome":-1!=(b=c.indexOf("Safari"))?d="Safari":-1!=(b=c.indexOf("Firefox"))?d="Firefox":-1!=(b=c.indexOf("IEMobile"))?d="Internet Explorer Mobile":"Microsoft Internet Explorer"==d||"Netscape"==d?d="Internet Explorer":(a=c.lastIndexOf(" ")+1)<(b=c.lastIndexOf("/"))&&(d=c.substring(a,b),d.toLowerCase()==d.toUpperCase()&&(d=navigator.appName)),d},getBrowserFullVersion:function(){var a,b,c,d,e,f=navigator.userAgent,g=navigator.appName,h=""+parseFloat(navigator.appVersion);return-1!=(c=f.indexOf("Opera"))?(h=f.substring(c+6),-1!=(c=f.indexOf("Version"))&&(h=f.substring(c+8))):-1!=(c=f.indexOf("OPR/"))?h=f.substring(c+4):-1!=(c=f.indexOf("Android"))?h=f.substring(c+11):-1!=(c=f.indexOf("Chrome"))?h=f.substring(c+7):-1!=(c=f.indexOf("Safari"))?(h=f.substring(c+7),-1!=(c=f.indexOf("Version"))&&(h=f.substring(c+8))):-1!=(c=f.indexOf("Firefox"))?h=f.substring(c+8):"Microsoft Internet Explorer"==g?(e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!=e.exec(f)&&(h=parseFloat(RegExp.$1))):"Netscape"==g?(e=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!=e.exec(f)&&(h=parseFloat(RegExp.$1))):(b=f.lastIndexOf(" ")+1)<(c=f.lastIndexOf("/"))&&(h=f.substring(c+1)),h=h.toString(),-1!=(d=h.indexOf(";"))&&(h=h.substring(0,d)),-1!=(d=h.indexOf(" "))&&(h=h.substring(0,d)),-1!=(d=h.indexOf(")"))&&(h=h.substring(0,d)),a=parseInt(""+h,10),isNaN(a)&&(h=""+parseFloat(navigator.appVersion)),h},browserAcceptsLargeURLs:function(){return null===window.ActiveXObject||!0}};return a}(),d=function(){var a="cs_",b=function(){var b="undefined"!=typeof localStorage?localStorage:{};c.extend(this,{get:function(c){return b[a+c]},set:function(c,d){b[a+c]=d},has:function(c){return a+c in b},remove:function(c){delete b[a+c]},clear:function(){for(var a in b)b.hasOwnProperty(a)&&delete b[a]}})};return b}(),e=function(a,b){var c=new Image;c.onload=function(){b&&b(200)},c.onerror=function(){b&&b()},c.src=a},f=function(a,b,c){c&&setTimeout(c,0)},g=function(){return{dir:function(a){return null},append:function(a,b,c){},write:function(a,b,c){},deleteFile:function(a,b){return!1},read:function(a,b){return null}}}(),h=function(a,b){"undefined"!=typeof engine&&b&&setTimeout(b,0);var c=engine.createHttpClient(),d=c.createRequest("GET",a,null);d.start(),b&&setTimeout(b,0)},i=function(){var a={PLATFORM:"generic",httpGet:e,httpPost:f,Storage:d,IO:g,getCrossPublisherId:function(){return null},getAppName:function(){return Constants.UNKNOWN_VALUE},getAppVersion:function(a){return Constants.UNKNOWN_VALUE},getVisitorId:function(){return this.getDeviceName()+ +new Date+~~(1e3*Math.random())},getVisitorIdSuffix:function(){return"72"},getDeviceName:function(){return""},getPlatformVersion:function(){return""},getPlatformName:function(){return"js"},getRuntimeName:function(){return""},getRuntimeVersion:function(){return""},getResolution:function(){return""},getLanguage:function(){return""},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},isCompatible:function(){return!0},autoSelect:function(){},isCrossPublisherIdChanged:function(){return!1}};return a}(),j=function(){function a(){return"undefined"!=typeof engine&&"undefined"!=typeof engine.stats}function b(){return c.isNotEmpty(engine.stats.device.id)?engine.stats.device.id:c.isNotEmpty(engine.stats.network.mac)?engine.stats.network.mac:null}function e(){if(null==i){var a=b();null!=a?(i=a,j="31",k=a):(i=+new Date+~~(1e3*Math.random()),j="72",k=null)}}var i=null,j=null,k=null;return{PLATFORM:"trilithium",httpGet:h,httpPost:f,Storage:d,IO:g,getCrossPublisherId:function(){return e(),k},getAppName:function(){return c.isNotEmpty(engine.stats.application.name)?engine.stats.application.name:Constants.UNKNOWN_VALUE},getAppVersion:function(a){return c.isNotEmpty(engine.stats.application.version)?engine.stats.application.version:Constants.UNKNOWN_VALUE},getVisitorId:function(){return e(),i},getVisitorIdSuffix:function(){return j},getDeviceName:function(){return c.safeGet(engine.stats.device.platform,"")},getPlatformVersion:function(){return c.safeGet(engine.stats.device.version,"")},getPlatformName:function(){return"js"},getRuntimeName:function(){return"trilithium"},getRuntimeVersion:function(){return""},getResolution:function(){return"undefined"!=typeof screen&&"undefined"!=typeof screen.height&&"undefined"!=typeof screen.width?screen.height+"x"+screen.width:""},getLanguage:function(){return""},getPackageName:function(){return""},isConnectionAvailable:function(){return!0},isCompatible:a}}();i.autoSelect=function(){j.isCompatible()&&c.extend(i,j)};var k,l,m="undefined"!=typeof window&&"undefined"!=typeof document;m?(k=window,l=document):(k={},l={location:{href:""},title:"",URL:"",referrer:"",cookie:""});var c=c||{};c.filterMap=function(a,b){for(var d in a)-1==c.indexOf(d,b)&&delete a[d]},c.getKeys=function(a,b){var c,d=[];for(c in a)(!b||b.test(c))&&a.hasOwnProperty(c)&&(d[d.length]=c);return d};var n=function(){var a=["play","pause","end","buffer","keep-alive","hb","custom","ad_play","ad_pause","ad_end","ad_click"];return{PLAY:0,PAUSE:1,END:2,BUFFER:3,KEEP_ALIVE:4,HEART_BEAT:5,CUSTOM:6,AD_PLAY:7,AD_PAUSE:8,AD_END:9,AD_CLICK:10,toString:function(b){return a[b]}}}(),o=function(){var a=[n.END,n.PLAY,n.PAUSE,n.BUFFER];return{IDLE:0,PLAYING:1,PAUSED:2,BUFFERING:3,toEventType:function(b){return a[b]}}}(),p={ADPLAY:n.AD_PLAY,ADPAUSE:n.AD_PAUSE,ADEND:n.AD_END,ADCLICK:n.AD_CLICK},q={STREAMSENSE_VERSION:"4.1412.05",DEFAULT_PLAYERNAME:"streamsense",DEFAULT_HEARTBEAT_INTERVAL:[{playingtime:6e4,interval:1e4},{playingtime:null,interval:6e4}],DEFAULT_KEEP_ALIVE_INTERVAL:12e5,DEFAULT_PAUSED_ON_BUFFERING_INTERVAL:500,C1_VALUE:"19",C10_VALUE:"js",NS_AP_C12M_VALUE:"1",NS_NC_VALUE:"1",PAGE_NAME_LABEL:"name",RESTRICTED_URL_LENGTH_LIMIT:2048,URL_LENGTH_LIMIT:4096,LABELS_ORDER:["c1","c2","ca2","cb2","cc2","cd2","ns_site","ca_ns_site","cb_ns_site","cc_ns_site","cd_ns_site","ns_vsite","ca_ns_vsite","cb_ns_vsite","cc_ns_vsite","cd_ns_vsite","ns_ap_an","ca_ns_ap_an","cb_ns_ap_an","cc_ns_ap_an","cd_ns_ap_an","ns_ap_pn","ns_ap_pv","c12","ca12","cb12","cc12","cd12","ns_ak","ns_ns_ap_hw","name","ns_ap_ni","ns_ap_ec","ns_ap_ev","ns_ap_device","ns_ap_id","ns_ap_csf","ns_ap_bi","ns_ap_pfm","ns_ap_pfv","ns_ap_ver","ca_ns_ap_ver","cb_ns_ap_ver","cc_ns_ap_ver","cd_ns_ap_ver","ns_ap_sv","ns_ap_cv","ns_type","ca_ns_type","cb_ns_type","cc_ns_type","cd_ns_type","ns_radio","ns_nc","ns_ap_ui","ca_ns_ap_ui","cb_ns_ap_ui","cc_ns_ap_ui","cd_ns_ap_ui","ns_ap_gs","ns_st_sv","ns_st_pv","ns_st_it","ns_st_id","ns_st_ec","ns_st_sp","ns_st_sq","ns_st_cn","ns_st_ev","ns_st_po","ns_st_cl","ns_st_el","ns_st_pb","ns_st_hc","ns_st_mp","ca_ns_st_mp","cb_ns_st_mp","cc_ns_st_mp","cd_ns_st_mp","ns_st_mv","ca_ns_st_mv","cb_ns_st_mv","cc_ns_st_mv","cd_ns_st_mv","ns_st_pn","ns_st_tp","ns_st_pt","ns_st_pa","ns_st_ad","ns_st_li","ns_st_ci","ns_ap_jb","ns_ap_res","ns_ap_c12m","ns_ap_install","ns_ap_updated","ns_ap_lastrun","ns_ap_cs","ns_ap_runs","ns_ap_usage","ns_ap_fg","ns_ap_ft","ns_ap_dft","ns_ap_bt","ns_ap_dbt","ns_ap_dit","ns_ap_as","ns_ap_das","ns_ap_it","ns_ap_uc","ns_ap_aus","ns_ap_daus","ns_ap_us","ns_ap_dus","ns_ap_ut","ns_ap_oc","ns_ap_uxc","ns_ap_uxs","ns_ap_lang","ns_ap_ar","ns_ap_miss","ns_ts","ns_st_ca","ns_st_cp","ns_st_er","ca_ns_st_er","cb_ns_st_er","cc_ns_st_er","cd_ns_st_er","ns_st_pe","ns_st_ui","ca_ns_st_ui","cb_ns_st_ui","cc_ns_st_ui","cd_ns_st_ui","ns_st_bc","ns_st_bt","ns_st_bp","ns_st_pc","ns_st_pp","ns_st_br","ns_st_ub","ns_st_vo","ns_st_ws","ns_st_pl","ns_st_pr","ns_st_ep","ns_st_ty","ns_st_ct","ns_st_cs","ns_st_ge","ns_st_st","ns_st_dt","ns_st_de","ns_st_pu","ns_st_cu","ns_st_fee","ns_ap_i1","ns_ap_i2","ns_ap_i3","ns_ap_i4","ns_ap_i5","ns_ap_i6","c3","ca3","cb3","cc3","cd3","c4","ca4","cb4","cc4","cd4","c5","ca5","cb5","cc5","cd5","c6","ca6","cb6","cc6","cd6","c10","c11","c13","c14","c15","c16","c7","c8","c9"]},r=function(){var a=function(){function a(a,b){var c=b[a];null!=c&&(d[a]=c)}var b,d,e=this,f=0,g=0,h=0,i=0,j=0,k=0;c.extend(this,{reset:function(a){null!=a&&a.length>0?c.filterMap(d,a):d={},d.hasOwnProperty("ns_st_cl")||(d.ns_st_cl="0"),d.hasOwnProperty("ns_st_pn")||(d.ns_st_pn="1"),d.hasOwnProperty("ns_st_tp")||(d.ns_st_tp="1"),e.setPauses(0),e.setStarts(0),e.setBufferingTime(0),e.setBufferingTimestamp(-1),e.setPlaybackTime(0),e.setPlaybackTimestamp(-1)},setLabels:function(a,b){null!=a&&c.extend(d,a),e.setRegisters(d,b)},getLabels:function(){return d},setLabel:function(a,b){var c={};c[a]=b,e.setLabels(c,null)},getLabel:function(a){return d[a]},getClipId:function(){return("undefined"==typeof b||null==b)&&e.setClipId("1"),b},setClipId:function(a){b=a},setRegisters:function(b,c){var d=b.ns_st_cn;null!=d&&(e.setClipId(d),delete b.ns_st_cn),d=b.ns_st_bt,null!=d&&(h=Number(d),delete b.ns_st_bt),a("ns_st_cl",b),a("ns_st_pn",b),a("ns_st_tp",b),a("ns_st_ub",b),a("ns_st_br",b),c!=o.PLAYING&&null!=c||(d=b.ns_st_sq,null!=d&&(g=Number(d),delete b.ns_st_sq)),c!=o.BUFFERING&&(d=b.ns_st_pt,null!=d&&(j=Number(d),delete b.ns_st_pt)),c!=o.PAUSED&&c!=o.IDLE&&null!=c||(d=b.ns_st_pc,null!=d&&(f=Number(d),delete b.ns_st_pc))},createLabels:function(a,b){var d=b||{};return d.ns_st_cn=e.getClipId(),d.ns_st_bt=String(e.getBufferingTime()),a!=n.PLAY&&null!=a||(d.ns_st_sq=String(g)),a!=n.PAUSE&&a!=n.END&&a!=n.KEEP_ALIVE&&a!=n.HEART_BEAT&&null!=a||(d.ns_st_pt=String(e.getPlaybackTime()),d.ns_st_pc=String(f)),c.extend(d,e.getLabels()),d},incrementPauses:function(){f++},incrementStarts:function(){g++},getBufferingTime:function(){var a=h;return i>=0&&(a+=+new Date-i),a},setBufferingTime:function(a){h=a},getPlaybackTime:function(){var a=j;return k>=0&&(a+=+new Date-k),a},setPlaybackTime:function(a){j=a},getPlaybackTimestamp:function(){return k},setPlaybackTimestamp:function(a){k=a},getBufferingTimestamp:function(){return i},setBufferingTimestamp:function(a){i=a},getPauses:function(){return f},setPauses:function(a){f=a},getStarts:function(){return g},setStarts:function(a){g=a}}),d={},e.reset()};return a}(),s=function(){var a=function(){var a,b,d=this,e=null,f=0,g=0,h=0,i=0,j=0,k=0,l=!1;c.extend(this,{reset:function(a){null!=a&&a.length>0?c.filterMap(b,a):b={},d.setPlaylistId(+new Date+"_"+k),d.setBufferingTime(0),d.setPlaybackTime(0),d.setPauses(0),d.setStarts(0),d.setRebufferCount(0),l=!1},setLabels:function(a,e){null!=a&&c.extend(b,a),d.setRegisters(b,e)},getLabels:function(){return b},setLabel:function(a,b){var c={};c[a]=b,d.setLabels(c,null)},getLabel:function(a){return b[a]},getClip:function(){return e},getPlaylistId:function(){return a},setPlaylistId:function(b){a=b},setRegisters:function(b,c){var d=b.ns_st_sp;null!=d&&(f=Number(d),delete b.ns_st_sp),d=b.ns_st_bc,null!=d&&(h=Number(d),delete b.ns_st_bc),d=b.ns_st_bp,null!=d&&(i=Number(d),delete b.ns_st_bp),d=b.ns_st_id,null!=d&&(a=d,delete b.ns_st_id),c!=o.BUFFERING&&(d=b.ns_st_pa,null!=d&&(j=Number(d),delete b.ns_st_pa)),c!=o.PAUSED&&c!=o.IDLE&&null!=c||(d=b.ns_st_pp,null!=d&&(g=Number(d),delete b.ns_st_pp))},createLabels:function(b,e){var i=e||{};return i.ns_st_bp=String(d.getBufferingTime()),i.ns_st_sp=String(f),i.ns_st_id=String(a),h>0&&(i.ns_st_bc=String(h)),b!=n.PAUSE&&b!=n.END&&b!=n.KEEP_ALIVE&&b!=n.HEART_BEAT&&null!=b||(i.ns_st_pa=String(d.getPlaybackTime()),i.ns_st_pp=String(g)),b!=n.PLAY&&null!=b||d.didFirstPlayOccurred()||(i.ns_st_pb="1",d.setFirstPlayOccurred(!0)),c.extend(i,d.getLabels()),i},incrementStarts:function(){f++},incrementPauses:function(){g++,e.incrementPauses()},setPlaylistCounter:function(a){k=a},incrementPlaylistCounter:function(){k++},addPlaybackTime:function(a){if(e.getPlaybackTimestamp()>=0){var b=a-e.getPlaybackTimestamp();e.setPlaybackTimestamp(-1),e.setPlaybackTime(e.getPlaybackTime()+b),d.setPlaybackTime(d.getPlaybackTime()+b)}},addBufferingTime:function(a){if(e.getBufferingTimestamp()>=0){var b=a-e.getBufferingTimestamp();e.setBufferingTimestamp(-1),e.setBufferingTime(e.getBufferingTime()+b),d.setBufferingTime(d.getBufferingTime()+b)}},getBufferingTime:function(){var a=i;return e.getBufferingTimestamp()>=0&&(a+=+new Date-e.getBufferingTimestamp()),a},setBufferingTime:function(a){i=a},getPlaybackTime:function(){var a=j;return e.getPlaybackTimestamp()>=0&&(a+=+new Date-e.getPlaybackTimestamp()),a},setPlaybackTime:function(a){j=a},getStarts:function(){return f},setStarts:function(a){f=a},getPauses:function(){return g},setPauses:function(a){g=a},getRebufferCount:function(){return h},incrementRebufferCount:function(){h++},setRebufferCount:function(a){h=a},didFirstPlayOccurred:function(){return l},setFirstPlayOccurred:function(a){l=a}}),e=new r,b={},d.reset()};return a}(),t=function(){var d=function(d,e){function f(a){var b=0;if(null!=ma)for(var c=0;c<ma.length;c++){var d=ma[c],e=d.playingtime;if(!e||e>a){b=d.interval;break}}return b}function g(){l();var a=f(ja.getClip().getPlaybackTime());if(a>0){var b=pa>0?pa:a;Z=setTimeout(k,b)}pa=0}function h(){l();var a=f(ja.getClip().getPlaybackTime());pa=a-ja.getClip().getPlaybackTime()%a,null!=Z&&l()}function j(){pa=0,ra=0,qa=0}function k(){qa++;var a=N(n.HEART_BEAT,null);B(a),pa=0,g()}function l(){null!=Z&&(clearTimeout(Z),Z=null)}function m(){r(),Y=setTimeout(p,na)}function p(){var a=N(n.KEEP_ALIVE,null);B(a),ia++,m()}function r(){null!=Y&&(clearTimeout(Y),Y=null)}function t(){v(),da.isPauseOnBufferingEnabled()&&G(o.PAUSED)&&(X=setTimeout(u,oa))}function u(){if($==o.PLAYING){ja.incrementRebufferCount(),ja.incrementPauses();var a=N(n.PAUSE,null);B(a),ia++,$=o.PAUSED}}function v(){null!=X&&(clearTimeout(X),X=null)}function w(a){return a==o.PLAYING||a==o.PAUSED}function x(){T&&(clearTimeout(T),T=null)}function y(a){return a==n.PLAY?o.PLAYING:a==n.PAUSE?o.PAUSED:a==n.BUFFER?o.BUFFERING:a==n.END?o.IDLE:null}function z(a,b,d){if(x(),d)T=setTimeout(function(a,b){return function(){z(a,b)}}(a,b),d);else if(J(a)){var e=L(),f=ga,g=I(b),h=f>=0?g-f:0;E(L(),b),F(a,b),M(L()),K(a);for(var i=0,j=ca.length;j>i;i++)ca[i](e,a,b,h);A(b),ja.setRegisters(b,a),ja.getClip().setRegisters(b,a);var k=N(o.toEventType(a),b);c.extend(k,b),G(V)&&(B(k),$=V,ia++)}}function A(a){var b=a.ns_st_mp;null!=b&&(_=b,delete a.ns_st_mp),b=a.ns_st_mv,null!=b&&(aa=b,delete a.ns_st_mv),b=a.ns_st_ec,null!=b&&(ia=Number(b),delete a.ns_st_ec)}function B(a,c){void 0===c&&(c=!0),c&&D(a);var d=da.getPixelURL();if(W){if(!C()){var e=ta.am,f=ta.et,g=e.newApplicationMeasurement(W,f.HIDDEN,a,d);W.getQueue().offer(g)}}else d&&i.httpGet(b(d,a))}function C(){var a=W.getAppContext(),b=W.getSalt(),c=W.getPixelURL();return null==a||null==b||0==b.length||null==c||0==c.length}function D(a){ba=N(null),c.extend(ba,a)}function E(a,b){var d=I(b);if(a==o.PLAYING)ja.addPlaybackTime(d),h(),r();else if(a==o.BUFFERING)ja.addBufferingTime(d),v();else if(a==o.IDLE){var e=c.getKeys(ja.getClip().getLabels());ja.getClip().reset(e)}}function F(a,b){var c=I(b),d=H(b);ha=d,a==o.PLAYING?(g(),m(),ja.getClip().setPlaybackTimestamp(c),G(a)&&(ja.getClip().incrementStarts(),ja.getStarts()<1&&ja.setStarts(1))):a==o.PAUSED?G(a)&&ja.incrementPauses():a==o.BUFFERING?(ja.getClip().setBufferingTimestamp(c),la&&t()):a==o.IDLE&&j()}function G(a){return a!=o.PAUSED&&a!=o.IDLE||$!=o.IDLE&&null!=$?a!=o.BUFFERING&&$!=a:!1}function H(a){var b=-1;return a.hasOwnProperty("ns_st_po")&&(b=c.getInteger(a.ns_st_po)),b}function I(a){var b=-1;return a.hasOwnProperty("ns_ts")&&(b=Number(a.ns_ts)),b}function J(a){return null!=a&&L()!=a}function K(a){V=a,ga=+new Date}function L(){return V}function M(a){U=a}function N(){var a,b;1==arguments.length?(a=o.toEventType(V),b=arguments[0]):(a=arguments[0],b=arguments[1]);var d={};if("undefined"!=typeof document){var e=document;d.c7=e.URL,d.c8=e.title,d.c9=e.referrer}return null!=b&&c.extend(d,b),d.hasOwnProperty("ns_ts")||(d.ns_ts=String(+new Date)),null!=a&&!d.hasOwnProperty("ns_st_ev")&&(d.ns_st_ev=n.toString(a)),da.isPersistentLabelsShared()&&W&&c.extend(d,W.getLabels()),c.extend(d,da.getLabels()),O(a,d),ja.createLabels(a,d),ja.getClip().createLabels(a,d),d.hasOwnProperty("ns_st_mp")||(d.ns_st_mp=_),d.hasOwnProperty("ns_st_mv")||(d.ns_st_mv=aa),d.hasOwnProperty("ns_st_ub")||(d.ns_st_ub="0"),d.hasOwnProperty("ns_st_br")||(d.ns_st_br="0"),d.hasOwnProperty("ns_st_pn")||(d.ns_st_pn="1"),d.hasOwnProperty("ns_st_tp")||(d.ns_st_tp="1"),d.hasOwnProperty("ns_st_it")||(d.ns_st_it="c"),d.ns_st_sv=q.STREAMSENSE_VERSION,d.ns_type="hidden",d}function O(a,b){var d=b||{};if(d.ns_st_ec=String(ia),!d.hasOwnProperty("ns_st_po")){var e=ha,f=I(d);(a==n.PLAY||a==n.KEEP_ALIVE||a==n.HEART_BEAT||null==a&&V==o.PLAYING)&&(e+=f-ja.getClip().getPlaybackTimestamp()),d.ns_st_po=c.getInteger(e)}return a==n.HEART_BEAT&&(d.ns_st_hc=String(qa)),d}function P(a){var b=I(a);0>b&&(a.ns_ts=String(+new Date))}function Q(a,b,c){b=b||{},b.ns_st_ad=1,a>=n.AD_PLAY&&a<=n.AD_CLICK&&da.notify(a,b,c)}function R(a,b){da.notify(n.CUSTOM,a,b)}var S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da=this,ea=500,fa=null,ga=0,ha=0,ia=0,ja=null,ka=!0,la=!0,ma=q.DEFAULT_HEARTBEAT_INTERVAL,na=q.DEFAULT_KEEP_ALIVE_INTERVAL,oa=q.DEFAULT_PAUSED_ON_BUFFERING_INTERVAL,pa=0,qa=0,ra=0,sa=!1,ta={};i.autoSelect(),c.extend(this,{
reset:function(a){ja.reset(a),ja.setPlaylistCounter(0),ja.setPlaylistId(+new Date+"_1"),ja.getClip().reset(a),null==a||a.isEmpty()?S={}:c.filterMap(S,a),ia=1,qa=0,h(),j(),r(),v(),x(),V=o.IDLE,U=null,ga=-1,$=null,_=q.DEFAULT_PLAYERNAME,aa=q.STREAMSENSE_VERSION,ba=null},setPauseOnBufferingInterval:function(a){oa=a},getPauseOnBufferingInterval:function(){return oa},setKeepAliveInterval:function(a){na=a},getKeepAliveInterval:function(){return na},setHeartbeatIntervals:function(a){ma=a},notify:function(){var a,b,d,e;b=arguments[0],3==arguments.length?(d=arguments[1],e=arguments[2]):(d={},e=arguments[1]),a=y(b);var f=c.extend({},d);if(P(f),f.hasOwnProperty("ns_st_po")||(f.ns_st_po=c.getInteger(e).toString()),b==n.PLAY||b==n.PAUSE||b==n.BUFFER||b==n.END)da.isPausePlaySwitchDelayEnabled()&&w(V)&&w(a)&&(V!=o.PLAYING||a!=o.PAUSED||T)?z(a,f,ea):z(a,f);else{var g=N(b,f);c.extend(g,f),B(g,!1),ia++}},getLabels:function(){return S},getState:function(){return V},setLabels:function(a){null!=a&&(null==S?S=a:c.extend(S,a))},getLabel:function(a){return S[a]},setLabel:function(a,b){null==b?delete S[a]:S[a]=b},setPixelURL:function(a){if(null==a||0==a.length)return null;var b=decodeURIComponent||unescape,c=a.indexOf("?");if(c>=0){if(c<a.length-1){for(var d=a.substring(c+1).split("&"),e=0,f=d.length;f>e;e++){var g=d[e],h=g.split("=");2==h.length?da.setLabel(h[0],b(h[1])):1==h.length&&da.setLabel(q.PAGE_NAME_LABEL,b(h[0]))}a=a.substring(0,c+1)}}else a+="?";return fa=a},getPixelURL:function(){return fa?fa:"undefined"!=typeof ns_p&&"string"==typeof ns_p.src?fa=ns_p.src.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):"string"==typeof ns_pixelUrl?fa=ns_pixelUrl.replace(/&amp;/,"&").replace(/&ns__t=\d+/,""):null},isPersistentLabelsShared:function(){return ka},setPersistentLabelsShared:function(a){ka=a},isPauseOnBufferingEnabled:function(){return la},setPauseOnBufferingEnabled:function(a){la=a},isPausePlaySwitchDelayEnabled:function(){return sa},setPausePlaySwitchDelayEnabled:function(a){sa=a},setPausePlaySwitchDelay:function(a){a&&a>0&&(ea=a)},getPausePlaySwitchDelay:function(){return ea},setClip:function(a,b){var c=!1;return V==o.IDLE&&(ja.getClip().reset(),ja.getClip().setLabels(a,null),b&&ja.incrementStarts(),c=!0),c},setPlaylist:function(a){var b=!1;return V==o.IDLE&&(ja.incrementPlaylistCounter(),ja.reset(),ja.getClip().reset(),ja.setLabels(a,null),b=!0),b},importState:function(a){reset();var b=c.extend({},a);ja.setRegisters(b,null),ja.getClip().setRegisters(b,null),A(b),ia++},exportState:function(){return ba},getVersion:function(){return q.STREAMSENSE_VERSION},addListener:function(a){ca.push(a)},removeListener:function(a){ca.splice(c.indexOf(a,ca),1)},getClip:function(){return ja.getClip()},getPlaylist:function(){return ja}}),c.extend(this,{adNotify:Q,customNotify:R,viewNotify:function(b,c){b=b||da.getPixelURL(),b&&a(b,c)}}),ns_.comScore&&(ta=ns_.comScore.exports,W=ta.c()),S={},ia=1,V=o.IDLE,ja=new s,X=null,la=!0,Z=null,qa=0,j(),Y=null,T=null,sa=!1,$=null,ha=0,ca=[],da.reset(),d&&da.setLabels(d),e&&da.setPixelURL(e)};return function(a){function b(a,b){return w[y]||e(a,b)}function d(){y=-1;for(var a=0;x>=a;a++)if(w.hasOwnProperty(a)){y=a;break}return ns_.StreamSense.activeIndex=y,y}function e(a,b){return a=a||null,b=b||null,a&&"object"==typeof a&&(b=a,a=null),w[++x]=new ns_.StreamSense(b,a),d(),w[x]}function f(){var a=!1,b=y;if("number"==typeof arguments[0]&&isFinite(arguments[0]))b=arguments[0];else if(arguments[0]instanceof ns_.StreamSense)for(var c in w)if(w[c]===arguments[0]){b=c;break}return w.hasOwnProperty(b)&&(a=w[b],delete w[b],a.reset(),d()),a}function g(a){return a=a||{},b().setPlaylist(a),b().getPlaylist()}function h(a,c,d){return a=a||{},"number"==typeof c&&(a.ns_st_cn=c),b().setClip(a,d),b().getClip()}function i(a,c,d){return"undefined"==typeof a?!1:(d=d||null,c=c||{},b().notify(a,c,d))}function j(a){"undefined"!=typeof a&&b().setLabels(a)}function k(){return b().getLabels()}function l(a){"undefined"!=typeof a&&b().getPlaylist().setLabels(a)}function m(){return b().getPlaylist().getLabels()}function n(a){"undefined"!=typeof a&&b().getClip().setLabels(a)}function o(){return b().getClip().getLabels()}function p(a){return b().reset(a||{})}function q(a){return b().getPlaylist().reset(a||{})}function r(a){return b().getClip().reset(a||{})}function s(a){return a=a||{},b().viewNotify(null,a)}function t(a,c){return arguments.length>2&&(a=arguments[1],c=arguments[2]),a=a||{},"number"==typeof c&&(a.ns_st_po=c),b().customNotify(a,c)}function u(){return b().exportState()}function v(a){b().importState(a)}var w={},x=-1,y=-1;c.extend(a,{activeIndex:y,newInstance:e,"new":e,destroyInstance:f,destroy:f,newPlaylist:g,newClip:h,notify:i,setLabels:j,getLabels:k,setPlaylistLabels:l,getPlaylistLabels:m,setClipLabels:n,getClipLabels:o,resetInstance:p,resetPlaylist:q,resetClip:r,viewEvent:s,customEvent:t,exportState:u,importState:v})}(d),d}();return t.AdEvents=p,t.PlayerEvents=n,ns_.StreamingTag=ns_.StreamingTag||function(){var a=function(){var a=function(a){function b(){if(!ns_.comScore&&c.exists(a))if(u=c.isTrue(a.debug),c.exists(a.customerC2)){var b=a.secure?"https://sb":"http"+("s"==document.location.href.charAt(4)?"s://sb":"://b");s.setPixelURL(b+".scorecardresearch.com/p?c1=2"),s.setLabel("c2",a.customerC2)}else s.setPixelURL(""),u&&console.log("Warning: customerC2 is not provided (or incorrect) in the StreamingTag configuration.");s.setLabel("ns_st_it","r")}function d(a){return c.exists(a)||(a={}),c.exists(a.ns_st_ci)||(a.ns_st_ci="0"),c.exists(a.c3)||(a.c3="*null"),c.exists(a.c4)||(a.c4="*null"),c.exists(a.c6)||(a.c6="*null"),a}function e(a){return m>0&&a>=m?p+=a-m:p=0,p}function f(a){s.getState()!=o.IDLE&&s.getState()!=o.PAUSED?s.notify(n.END,e(a)):s.getState()==o.PAUSED&&s.notify(n.END,p)}function g(a){return h("ns_st_ci",q,a)&&h("c3",q,a)&&h("c4",q,a)&&h("c6",q,a)}function h(a,b,d){if(c.exists(a)&&c.exists(b)&&c.exists(d)){var e=b[a],f=d[a];return c.exists(e)&&c.exists(f)&&e===f}return!1}function i(a,b){f(a),l++;var d={ns_st_cn:l,ns_st_pn:"1",ns_st_tp:"0"};c.extend(d,b),s.setClip(d),q=b,m=a,p=0,s.notify(n.PLAY,p)}function j(a){var b=+new Date;f(b),l++,a=d(a);var e={ns_st_cn:l,ns_st_pn:"1",ns_st_tp:"1",ns_st_ad:"1"};c.extend(e,a),s.setClip(e),p=0,s.notify(n.PLAY,p),m=b,r=!1}function k(a,b){var c=+new Date;a=d(a),w==v.None&&(w=b),r&&w==b&&g(a)?(s.getClip().setLabels(a),s.getState()!=o.PLAYING&&(m=c,s.notify(n.PLAY,p))):i(c,a),r=!0,w=b}var l=0,m=0,p=0,q=null,r=!1,s=new t,u=!1,v={None:0,AudioContent:1,VideoContent:2},w=v.None;c.extend(this,{playAdvertisement:function(){u&&console&&console.warn("Calling deprecated function 'playAdvertisement'. Please call 'playVideoAdvertisement' or 'playAudioAdvertisement' functions instead.");var a={ns_st_ct:"va"};j(a)},playVideoAdvertisement:function(a){var b={ns_st_ct:"va"};a&&c.extend(b,a),j(b)},playAudioAdvertisement:function(a){var b={ns_st_ct:"aa"};a&&c.extend(b,a),j(b)},playContentPart:function(a){u&&console&&console.warn("Calling deprecated function 'playContentPart'. Please call 'playVideoContentPart' or 'playAudioContentPart' functions instead.");var b={ns_st_ct:"vc"};a&&c.extend(b,a),k(b,v.VideoContent)},playVideoContentPart:function(a){var b={ns_st_ct:"vc"};a&&c.extend(b,a),k(b,v.VideoContent)},playAudioContentPart:function(a){var b={ns_st_ct:"ac"};a&&c.extend(b,a),k(b,v.AudioContent)},stop:function(){var a=+new Date;s.notify(n.PAUSE,e(a))}}),b()};return function(a){}(a),a}();return a}(),t}(),define("vendor/stream_sense",[],function(){"use strict";return window.ns_}),define("lib/videoMetrix",["lodash","utils/ted","vendor/stream_sense","exports"],function(a,b,c,d){"use strict";d.init=function(a){this._init(),this._setContext(a)},d.start=function(){this._play()},d.stop=function(){this._tag&&this._tag.stop()},d.startAd=function(){this._asset.isInAd=!0,this._play()},d.stopAd=function(){this._asset.isInAd=!1,this._play()},d._meta=null,d._asset=null,d._tag=null,d._init=a.once(function(){d._tag=new c.StreamingTag({customerC2:b("csClientId")})}),d._setContext=function(a){var b={};a.talkId&&(b.ns_st_ci=a.talkId),this._meta=b,this._asset={isInAd:!1,isVideo:!0}},d._reset=function(){d._meta=null,d._asset=null,d._tag=null},d._play=function(){this._tag&&(this._asset.isInAd?this._asset.isVideo?this._tag.playVideoAdvertisement():this._tag.playAudioAdvertisement():this._asset.isVideo?this._tag.playVideoContentPart(this._meta):this._tag.playAudioContentPart(this._meta))}}),define("widgets/player/cs-tracker",["jquery","utils/ted","lib/videoMetrix"],function(a,b,c){"use strict";function d(b){b._isInternal&&(this._data={lastMetaTalkId:null,lastPlayTalkId:null},this._widget=b,this._addHandlers(),a(window).unload(function(){c.stop()}))}return d.prototype._sendViewBeacon=function(a){var c=window.COMSCORE;c&&c.beacon&&c.beacon({c1:"1",c2:b("csClientId"),c5:"02",c6:a})},d.prototype._sendPostrollBeacon=function(){var a=window.COMSCORE;a&&a.beacon&&a.beacon({c1:"1",c2:b("csClientId"),c5:"10"})},d.prototype._onTalkPlay=function(a){this._sendViewBeacon(a)},d.prototype._addHandlers=function(){var a=this,b={playertalk:function(a,b){c.init({talkId:b.id})},playerplay:function(){var b=a._widget.options.currentTalk.id;a._data.lastPlayTalkId!==b&&(a._onTalkPlay(b),a._data.lastPlayTalkId=b),c.start()},playerpause:function(){c.stop()},playercomplete:function(){c.stop()},playerprerollstart:function(){c.startAd()},playerprerollcomplete:function(){c.stopAd()},playerpostrollstart:function(){a._sendPostrollBeacon(),c.startAd()},playerpostrollcomplete:function(){c.stopAd()}};this._handlers=b,this._widget._on(b)},d}),define("utils/f",[],function(){"use strict";var a=function(a,b){var c=Array.prototype.slice.call(arguments,2);return function(){return a[b].apply(a,c)}};return a.create=function(a){return function(){var b=arguments,c=function(){return a.apply(this,b)};return c.prototype=a.prototype,new c}},a.get=function(a){return function(b){return b.get&&"function"==typeof b.get?b.get(a):b[a]&&"function"==typeof b[a]?b[a].call(b):b[a]}},a.splat=function(){var b=Array.prototype.slice.call(arguments);return function(c){for(var d=[],e=0;e<b.length;e++)d.push(a.get(b[e]).call(c));return d}},a.send=function(a){var b=Array.prototype.slice.call(arguments,1);return function(c){return c[a].apply(c,b)}},a.and=function(){var a=Array.prototype.slice.call(arguments);return function(b){for(var c=!0,d=0;d<a.length;d++)c=c&&a[d].call(null,b);return c}},a.not=function(a){return function(){return!a.apply(null,arguments)}},a.ascending=function(a,b){return a-b},a.descending=function(a,b){return b-a},a.truthy=function(a){return!!a},a.falsey=a.not(a.truthy),a}),define("player/topicFactory",["jquery"],function(a){"use strict";function b(c,d,e){var f,g;for(f=0,g=d.length;g>f;f++)a.isArray(d[f])?b(c,d[f],e):d[f].apply(c,e)}return function(c){var d={};return function(e){var f,g=e&&d[e];if(!g){f=a.Callbacks(c&&c.hasOwnProperty(e)?c[e]:"memory"),g={publish:f.fire,subscribe:f.add,unsubscribe:f.remove,once:function(){function a(){b(f,c,arguments),f.remove(a)}var c=arguments;return f.add(a)},publishUnique:function(){var a;return window.JSON?function(){var b=Array.prototype.slice.call(arguments,0),c=JSON.stringify(b);c!==a&&(f.fire.apply(f,b),a=c)}:!1}()};var h=null;f.add(function(a){h=a}),g.read=function(){return h},e&&(d[e]=g)}return g}}}),define("player/getFlashVars",["jquery"],function(a){"use strict";function b(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")}return function(a){a.options;return b({serviceHost:"https://www.ted.com",volume:a.config.get("volume"),autoplay:0,fullscreenEnabled:a.canFullScreen?0:1})}}),define("player/handleError",["jquery"],function(a){"use strict";var b=window.console;return function(c){b&&b.log&&b.log("Player error:\n"+(c?c.stack||c.message||"unknown":"unknown")),a.post("//www.ted.com/error_collector.php",{message:c})}}),define("player/hlsVastParser",["jquery","./topicFactory","./handleError"],function(a,b,c){"use strict";function d(a){this.vast=a,this.topic=b({companion:void 0}),this.loadCompanions()}function e(a){this.vastData=a,this.url=this.vastData.find("IFrameResource").text()}a.extend(d.prototype,{loadCompanions:function(){var a=this;this.preroll=new e(this.vast.find("Companion[width=6][height=7]")),this.companion=new e(this.vast.find("Companion[width=6][height=8]")),this.companion.load(function(b){b&&a.topic("companion").publish(b)})},sponsor:function(){var a={},b=this.vast.find("AdParameters").text().split("=");return a[b[0]]=b[1],a},prerollUrl:function(){return[this.preroll.url]},impressionUrl:function(){return[this.vast.find("Impression").text()]},clickUrl:function(){return this.vast.find("ClickThrough").text()}});var f=["start","firstQuartile","midpoint","thirdQuartile","complete","mute","unmute","rewind","pause","resume","fullscreen","creativeView"];return f.forEach&&f.forEach(function(b){d.prototype[b+"Url"]=function(){return a.makeArray(this.vast.find("Linear Tracking[event="+b+"]").map(function(b,c){return a(c).text()}))}}),a.extend(e.prototype,{load:function(b){var d=this;return""==this.url?b():void a.getJSON(this.url).done(function(a){d.ad=a.companion?{type:"companion-mobile",dimensions:{width:320,height:50},hasDisplay:!0,houseAd:!1,creative:[{density:1,url:a.companion.creative.standard},{density:2,url:a.companion.creative.standard_2x}],impression:null,thirdPartyImpressions:a.companion.impression,click:a.companion.click,lineItemId:null,creativeId:null}:a.ad,b(d.ad)}).fail(function(a,b,e){c({context:"hls",error:"Error retrieving companion ad",status:b,url:d.url})})}}),d}),define("player/hlsInitTalk",["jquery","./hlsVastParser","./handleError"],function(a,b,c){"use strict";function d(c){var d=new a.Deferred,e=d.promise();return c=c.replace("%5Bcorrelator%5D",Math.random().toFixed(12).substr(2)),a.ajax({url:c,timeout:2e3}).then(function(c){d.resolve(new b(a(c)))},function(a,b,c){d.reject(b,c)}),e}return function(b,e){var f,g,h=new a.Deferred,i=h.promise(),j={};try{g=b.currentTalk.resources.hls.stream,f=b.currentTalk.resources.hls.adUrl}catch(k){return b.throwError({type:"init",message:"Missing HLS stream resource.",severity:"fatal"}),h.reject(),i}return d(f).done(function(c){b.vastAd=c,a.extend(j,c.sponsor())}).fail(function(a,d){c({context:"hls",error:"Error retrieving VAST ad",status:a,url:b.currentTalk.resources.hls.adUrl})}).always(function(){e.attr("src",g+(-1===g.indexOf("?")?"?":"&")+a.param(j)),h.resolve()}),i}}),define("player/replaceElement",["jquery","./getFlashVars","./hlsVastParser","./hlsInitTalk","swfobject"],function(a,b,c,d){"use strict";function e(a){return a.id||(a.id="ted-player-"+i++),a.id}function f(a){var c={bgcolor:"#000000",quality:"high",wmode:"opaque",allowscriptaccess:"always",allowfullscreen:"true"},d=a.options,f=e(d.el);if("OBJECT"!==d.el.nodeName){var g=b(a),h=d.attrs;c.flashvars=g,h.data=d.swf,swfobject.createSWF(h,c,f)}a.el=document.getElementById(f),a.topic("ready.dom").publish()}function g(b){var c,d=b.options,f=a("<video>"),g=e(d.el);b.currentTalk=d.talks[0],c=b.currentTalk.resources.h264[0].file,f.attr(d.attrs),b.options.shareToken&&(c=c+"&share_token="+b.options.shareToken),f.attr("preload","none"),f.attr("src",c),f.attr("id",g),a(d.el).replaceWith(f),b.el=f[0],b.topic("ready.dom").publish()}function h(b){var c=b.options,f=a("<video>"),g=e(c.el);b.currentTalk=c.talks[0],f.attr(c.attrs),f.attr("id",g),d(b,f).always(function(){a(c.el).replaceWith(f),b.el=f[0],b.topic("ready.dom").publish()})}var i=Math.floor(9999*Math.random()),j={flash:f,h264:g,hls:h};return function(a){return j[a.mode]?j[a.mode](a):void a.throwError({type:"init",message:"Cannot replace element for unrecognized player mode: "+a.mode,severity:"fatal"})}}),define("player/getSupportedMode",["jquery","swfobject"],function(a){"use strict";function b(a){return c.canPlayType(a).replace(/^no$/,"")}var c=document.createElement("video"),d=["flash","h264","hls"];return function(e){var f=navigator.userAgent.toLowerCase(),g=f.indexOf("windows nt")>-1&&f.indexOf("; arm;")>-1;if(e.mode&&-1!==a.inArray(e.mode,d))return e.mode;if(!g&&-1===f.indexOf("android")&&swfobject.hasFlashPlayerVersion(e.flashVersion))return"flash";try{if(!c.canPlayType)return!1;if(-1===f.indexOf("android")&&-1===f.indexOf("googletv")&&(b("application/vnd.apple.mpegURL")||b("application/x-mpegURL")))return"hls";if(b('video/mp4; codecs="avc1.42E01E"'))return"h264"}catch(h){}return!1}}),define("player/checkRequiredParams",[],function(){"use strict";var a=["el","talks"];return function(b,c){for(var d=!0,e=a.length;e--;)b[a[e]]||(c({type:"init",message:"Required option property is missing: "+a[e],severity:"fatal"}),d=!1);return d}}),define("player/throttle",["jquery"],function(a){"use strict";return function(b,c,d,e){var f,g=0;"boolean"!=typeof c&&(e=d,d=c,c=void 0);var h=function(){function a(){g=+new Date,d.apply(i,k)}function h(){f=void 0}var i=this,j=+new Date-g,k=arguments;e&&!f&&a(),f&&clearTimeout(f),void 0===e&&j>b?a():c!==!0&&(f=setTimeout(e?h:a,void 0===e?b-j:b))};return a.guid&&(h.guid=d.guid=d.guid||a.guid++),h}}),define("player/flashifySource",[],function(){"use strict";return function(a){return a+(-1===a.indexOf("?")?"?":"&")+"preroll=Blank&qr&network=tv"}}),define("player/getTalk",[],function(){"use strict";return function(a,b,c){var d,e=a.options.talks,f=e.length;for(c||(c=0);f--;)if(d=e[f],d.id==b)return e[f+c]}}),define("player/getLanguage",[],function(){"use strict";return function(a,b){if(!a.languages||!b)return!1;for(var c=a.languages.length;c--;)if(a.languages[c].languageCode===b)return a.languages[c];return!1}}),define("player/addHandlersFlash",["jquery","./flashifySource","./throttle","./getTalk","./getLanguage"],function(a,b,c,d,e){"use strict";var f=c(100,function(a,b){a("currentTime").publishUnique(b)}),g=c(100,function(a,b){a("postrollRemaining").publishUnique(b)});return function(c){function h(b,h){switch(b){case"player.error":c.throwError(a.extend({},h,{type:"flash"}));break;case"player.pause":m=!1,i("pause").publish();break;case"player.seeked":c._isFirstPlaying||i("seeked").publish();break;case"player.seeking":c._isFirstPlaying||(i("seeking").publish(),m&&(n=!0));break;case"player.play":c._isFirstPlaying=!1,i("ready.seekable").publish(),j&&(i("bufferPlayable").publish(),j=!1),m=!0,!c._isRequestedPlay&&n||i("play").publish(),n=!1,c._isRequestedPlay=!1;break;case"player.complete":m=!1,i("complete").publish(c.currentTalk);break;case"player.talk.complete":m=!1,i("talkComplete").publish(c.currentTalk);break;case"player.ready":i("ready.flashInterface").publish();break;case"player.loaded":i("ready.flashTalk").publish();var o=d(c,h.talkId),p=c.config.get("languageCode"),q=e(o,p);c.currentTalk=o,i("talk").publishUnique(o),q||!o.isSubtitleRequired&&o.nativeLanguage===c.options.nativeLanguage||(q=e(o,c.options.nativeLanguage)),q?(c.el.setLanguage(q.languageCode,q.isRtl),i("subtitle").publishUnique(q)):c.el.setLanguage(null,null),l&&c.el.playVideo(),l=!0;break;case"player.metadata":i("duration").publishUnique(h.duration);break;case"player.timeupdate":f(i,h.time);break;case"player.volumechange":var r=Math.round(1e3*+h.volume)/1e3;(r>0||!k)&&i("volume").publishUnique(r);break;case"player.ad.preroll.block":i("adBlock").publish(),i("prerollBlock").publish();break;case"player.ad.preroll.start":i("prerollStart").publish();break;case"player.ad.preroll.end":i("prerollComplete").publish();break;case"player.ad.postroll.start":i("postrollStart").publish();break;case"player.ad.postroll.end":i("postrollComplete").publish();break;case"player.ad.postroll.duration":i("postrollDuration").publish(h.duration);break;case"player.ad.postroll.remaining":g(i,h.time);break;case"player.buffer.empty":j||(j=!0,i("bufferUnplayable").publish());break;case"player.mouse.down":c.postrolling?i("postrollClick").publish():c.toggle();break;case"player.metrics":i("metricsData").publish(h);break;case"player.metrics.toggle":i("metricsToggle").publish()}}var i=c.topic,j=!1,k=c.config.get("muted");i("muted").subscribe(function(a){k=a}),i("ready.flashInterface").once(function(){var a=c.currentTalk||c.options.talks[0];c.currentTalk=a,c.el.load(a.id,b(a.resources.hls.stream),a.introDuration,a.adDuration,a.postAdDuration)}),i("ready.flashTalk").once(function(){i("ready.handlers").publish()});var l,m,n;window.onPlayerEvent=function(a,b){try{h(a,b)}catch(d){if(!d)return;c.throwError({message:d.message,stack:d.stack})}};var o=c.options.history,p=[];if(o&&o.length)for(var q=-1,r=o.length;++q<r;)window.onPlayerEvent.apply(p.slice.apply(o[q]))}}),define("player/isLastTalk",[],function(){"use strict";return function(a){return a.currentTalk.id===a.options.talks[a.options.talks.length-1].id}}),define("player/addHandlersH264",["jquery","./throttle","./isLastTalk"],function(a,b,c){"use strict";function d(a){var b=a.topic,c={};b("play").subscribe(function(){c={}}),b("talkComplete.unnormalized").subscribe(function(){var d=a.currentTalk||{};c.id&&d.id==c.id||b("talkComplete").publish(d),c=d})}return function(c){var e=c.topic,f=c.el,g=a(f);d(c),a.each(["play","pause","seeked","seeking"],function(a,b){g.on(b,function(){e(b).publish()})}),g.on("canplay",function(){var a;return function(){a&&f.play(),a=!0}}()),g.on("timeupdate",b(100,function(){e("currentTime").publishUnique(f.currentTime)})),g.on("durationchange",function(){e("duration").publishUnique(f.duration)}),g.on("ended",function(){e("talkComplete.unnormalized").publish(),e("complete").publish(c.currentTalk)}),g.on("volumechange",function(){e("volume").publishUnique(Math.round(1e3*+f.volume)/1e3),e("muted").publishUnique(f.muted)}),g.on("loadedmetadata",function(){e("ready.seekable").publish()})}}),define("player/addHandlersHls",["jquery","./handleError"],function(a,b){"use strict";function c(d){var f=d.el,g=d.topic;a(f).on("error",function(a){b({context:"hls",error:"Error playing video",currentTime:f.currentTime,src:f.src,code:f.error?f.error.code:void 0})});var h;g("talk").subscribe(function(a){h!==a.id&&(e(d),h=a.id)}),g("currentTime").subscribe(c.checkAdEvents)}function d(a){var b=new Image;b.src=a}function e(e){function f(a){k.push(c.createAdEvent(a))}var g,h=e.topic,i=e.vastAd;c.adEvents=[];try{g=e.currentTalk.resources.hls.metadata}catch(j){return void e.throwError({type:"init",message:"Missing HLS metadata for current talk.",severity:"fatal"})}if(!i)return void e.throwError({type:"hls",message:"Error retrieving VAST ad on talk change."});i.topic("companion").subscribe(function(a){h("ad").publish(a)});var k=[];a.getJSON(g,i.sponsor()).then(function(a){var b=a.timing;f({startsAt:Math.floor(b.outro.end)-1,onFirstStart:function(){i.impressionUrl().forEach(d)}}),f({startsAt:8,endsAt:12,onFirstStart:function(){i.prerollUrl().forEach(d)},onEveryStart:function(){h("prerollStart").publish()},onEveryEnd:function(){h("prerollComplete").publish()}}),b.ad&&(f({startsAt:Math.floor(b.ad.start),endsAt:Math.floor(b.ad.end),onFirstStart:function(){i.startUrl().forEach(d),i.creativeViewUrl().forEach(d)},onEveryStart:function(){h("talkComplete.unnormalized").publish(),h("postrollStart").publish()},onEveryEnd:function(){h("postrollComplete").publish()}}),f({startsAt:Math.floor(b.ad.start+(b.ad.end-b.ad.start)/4),endsAt:Math.floor(b.ad.end),onFirstStart:function(){i.firstQuartileUrl().forEach(d)}}),f({startsAt:Math.floor(b.ad.start+(b.ad.end-b.ad.start)/2),endsAt:Math.floor(b.ad.end),onFirstStart:function(){i.midpointUrl().forEach(d)}}),f({startsAt:Math.floor(b.ad.start+3*(b.ad.end-b.ad.start)/4),endsAt:Math.floor(b.ad.end),onFirstStart:function(){i.thirdQuartileUrl().forEach(d)}}),f({startsAt:Math.floor(b.ad.end)-1,endsAt:Math.floor(b.ad.end),onFirstStart:function(){i.completeUrl().forEach(d)}})),c.adEvents=k}).fail(function(a,c,d){b({context:"hls",error:"Error retrieving HLS metadata",status:c,uri:g,query:i.sponsor()})})}function f(a){a.isCurrent||(a.onEveryStart(),a.hasEverStarted||(a.onFirstStart(),a.hasEverStarted=!0),a.isCurrent=!0)}function g(a){a.isCurrent&&(a.onEveryEnd(),a.hasEverEnded||(a.onFirstEnd(),a.hasEverEnded=!0),a.isCurrent=!1)}return c.adEvents=[],c.createAdEvent=function(b){return a.extend({startsAt:0,endsAt:-1,onFirstStart:a.noop,onFirstEnd:a.noop,onEveryStart:a.noop,onEveryEnd:a.noop},b,{isCurrent:!1,hasEverStarted:!1,hasEverEnded:!1})},c.checkAdEvents=function(a){for(var b,d=c.adEvents,e=d.length,h=0;e>h;h++)b=d[h],a>=b.startsAt&&(a<b.endsAt||-1===b.endsAt)?f(b):b.isCurrent&&g(b)},c}),define("player/addHandlers",["./throttle","./addHandlersFlash","./addHandlersH264","./addHandlersHls","./isLastTalk"],function(a,b,c,d,e){"use strict";function f(b){var c,d,e=a(100,function(){c&&d&&b("progress").publishUnique(c/d)});b("currentTime").subscribe(function(a){c=a,e()}),b("duration").subscribe(function(a){d=a,c=0,e()}),b("progress").publish(0)}return function(a){var g=a.mode,h=a.topic;switch(g){case"flash":b(a);break;case"h264":c(a);break;case"hls":c(a),d(a);break;default:return void a.throwError({type:"init",message:"No handlers found for unrecognized player mode: "+g,severity:"fatal"})}"flash"!==g&&h("ready.handlers").publish(),a.options.talks[0]&&h("duration").publish(a.options.talks[0].duration),h("duration").subscribe(function(b){a.currentTalk?a.currentTalk.duration=b:a.options.talks[0].duration=b}),h("complete").subscribe(function(){e(a)?h("ended").publish(a.currentTalk):a.playNext()}),f(h),h("postrollStart").subscribe(function(){a.postrolling=!0}),h("postrollComplete").subscribe(function(){a.postrolling=!1}),h("talk").subscribe(function(){a.postrolling=!1})}}),define("player/actionsFlash",["jquery","./flashifySource","./getTalk","./getLanguage"],function(a,b,c,d){"use strict";var e={};return a.each({pause:"pauseVideo",seek:"seek",sendAds:"sendAds",capQualityToStage:"capQualityToStage"},function(a,b){e[a]=function(){var a=this.el[b];a&&a.apply(this.el,[].slice.call(arguments))}}),e.play=function(){this._isRequestedPlay=!0,this.lastPlayedTalkId==(this.currentTalk&&this.currentTalk.id)?this.el.resumeVideo():(this._isFirstPlaying=!0,this.el.playVideo())},e.playTalk=function(a){var d=c(this,a);d&&this.currentTalk!=d?(this._isFirstPlaying=!0,this.currentTalk=d,this.el.load(d.id,b(d.resources.hls.stream),d.introDuration,d.adDuration,d.postAdDuration)):this.play()},e.mute=function(a){this.el.volume(a?0:this.config.get("volume"))},e.subtitle=function(a){var b=d(this.currentTalk,a);b?this.el.setLanguage(b.languageCode,b.isRtl):this.el.setLanguage(null,null),this.config.set("languageCode",b?b.languageCode:!1),this.topic("subtitle").publishUnique(b)},e.volume=function(a){this.el.volume(a)},e._playbackRate=function(){},e}),define("player/actionsH264",["jquery","./getTalk"],function(a,b){"use strict";var c={};return c.play=function(){this.topic("talk").publishUnique(this.currentTalk),this.el.play()},c.pause=function(){this.el.pause()},c.playTalk=function(a){var c=b(this,a);c&&(this.currentTalk=c,this.topic("talk").publishUnique(c),this.el.src=c.resources.h264[0].file)},c.mute=function(a){this.el.muted=a},c.seek=function(a){this.el.currentTime=a},c.volume=function(a){this.el.volume=a},c._playbackRate=function(a){this.el.playbackRate=a},c}),define("player/actionsHls",["jquery","./getTalk","./hlsInitTalk"],function(a,b,c){"use strict";var d={};return d.play=function(){this.topic("talk").publishUnique(this.currentTalk),this.el.play()},d.pause=function(){this.el.pause()},d.playTalk=function(d){var e=b(this,d),f=this.topic;e&&this.currentTalk!=e?(this.currentTalk=e,c(this,a(this.el)).always(function(){f("talk").publishUnique(e)})):this.play()},d.playNext=function(){var a=b(this,this.currentTalk.id,1);a&&this.playTalk(a.id)},d.playPrev=function(){var a=b(this,this.currentTalk.id,-1);a&&this.playTalk(a.id)},d.mute=function(a){this.el.muted=a},d.seek=function(a){this.el.currentTime=a},d.volume=function(a){this.el.volume=a},d._playbackRate=function(a){this.el.playbackRate=a},d}),define("player/getFullScreenActions",["jquery"],function(a){"use strict";function b(b){function c(){b.topic("enterFullScreen").publish(),b.isFullScreen=!0}function d(){b.topic("exitFullScreen").publish(),b.isFullScreen=!1}var e=document,g=b.fullScreenMode,h=f[g];"webkitVideo"===g?(a(b.el).on("webkitbeginfullscreen",c),a(b.el).on("webkitendfullscreen",d)):h&&a(e).on(h.change,function(){e[h.element]===b.fullScreenElement?c():!e[h.element]&&b.isFullScreen&&d()})}function c(a){function b(){c.webkitEnterFullscreen()}var c=a.el;c.readyState>=1?b(a):(c.addEventListener("loadedmetadata",b,!1),a.play())}function d(a){var b=a.fullScreenMode,c=window.document;"webkitVideo"===b?a.el.webkitExitFullscreen():f[b]&&c[f[b].cancel]()}function e(a){var b=a.fullScreenMode;"webkitVideo"===b?c(a):f[b]?a.fullScreenElement[f[b].request]():a.throwError({type:"client",message:"Full screen mode not supported",severity:"warning"})}var f={standard:{cancel:"cancelFullScreen",change:"fullscreenchange",enabled:"fullscreenEnabled",error:"fullscreenerror",element:"fullscreenElement",request:"requestFullScreen"},moz:{cancel:"mozCancelFullScreen",change:"mozfullscreenchange",enabled:"mozFullScreenEnabled",error:"mozfullscreenerror",element:"mozFullScreenElement",request:"mozRequestFullScreen"},ms:{cancel:"msExitFullscreen",change:"MSFullscreenChange",enabled:"msFullscreenEnabled",error:"MSFullscreenError",element:"msFullscreenElement",request:"msRequestFullscreen"},webkit:{cancel:"webkitCancelFullScreen",change:"webkitfullscreenchange",enabled:"webkitFullscreenEnabled",error:"webkitfullscreenerror",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullScreen"}};return function(a){return b(a),{requestFullScreen:function(b){a.fullScreenElement||(a.fullScreenElement=b||a.el),e(a)},cancelFullScreen:function(){d(a)}}}}),define("player/addActions",["jquery","./actionsFlash","./actionsH264","./actionsHls","./getTalk","./getFullScreenActions"],function(a,b,c,d,e,f){"use strict";var g={flash:b,h264:c,hls:d};return function(a){function b(b){for(var c=-1,d=b.length;++c<d;)b[c].callback.apply(a,b[c].args)}function c(b){return function(){var c=[].slice.call(arguments);return j?b.apply(a,c):i.push({callback:b,args:c}),a}}var d=a.mode,h=g[d],i=[],j=!1;if(!h)return void a.throwError({type:"init",message:"No actions found for unrecognized player mode: "+d,severity:"fatal"});a.topic("ready").once(function(){j=!0,b(i)}),a.topic("play").subscribe(function(){a.lastPlayedTalkId=a.currentTalk&&a.currentTalk.id}),h.play=function(){var b=h.play,c=!1;return a.topic("ended").subscribe(function(){c=!0}),a.topic("play").subscribe(function(){c=!1}),function(){c&&h.seek(0),b.call(a)}}(),h.playNext=function(){var b=e(a,a.currentTalk.id,1);b&&a.playTalk(b.id)},h.playPrev=function(){var b=e(a,a.currentTalk.id,-1);b&&a.playTalk(b.id)},h.playbackRate=function(b){a.topic("playbackRate").publish(b)},h.volume=function(){var b=h.volume;return function(c){c=Math.round(1e3*+c)/1e3,0>c&&(c=0),c>1&&(c=1),b.call(a,c),a.topic("volume").publishUnique(c)}}(),h.mute=function(){var b=h.mute;return function(c){c=!!c,b.call(a,c),a.topic("muted").publishUnique(c)}}(),h.seek=function(){var b=h.seek,c=0;return a.topic("duration").subscribe(function(a){c=a}),function(d){d=+d,0>d&&(d=0),d>c&&(d=c),b.call(a,d)}}(),h.seek=function(){var b=h.seek,c=!1,d=!1;return a.topic("ready.seekable").once(function(){c!==!1&&b.call(a,c),d=!0}),function(e){d?b.call(a,e):c=e}}(),h.toggle=function(){a.paused?a.play():a.pause()};var k=f(a);h.requestFullScreen=k.requestFullScreen,h.cancelFullScreen=k.cancelFullScreen;for(var l in h)h.hasOwnProperty(l)&&(a[l]=c(h[l]))}}),define("player/addProperties",[],function(){"use strict";function a(){return d.requestFullScreen?!!c.fullscreenEnabled&&"standard":d.mozRequestFullScreen?!!c.mozFullScreenEnabled&&"moz":d.webkitRequestFullScreen?!!c.webkitFullscreenEnabled&&"webkit":d.webkitEnterFullscreen?"webkitVideo":d.msRequestFullscreen?!!c.msFullscreenEnabled&&"ms":!1}function b(){return!(!d.playbackRate||d.playbackRate!==d.defaultPlaybackRate)}var c=document,d=c.createElement("video");return function(c){c.fullScreenMode=a(),c.canFullScreen=c.fullScreenMode!==!1,c.mode=c.options.mode,
c.talks=c.options.talks,c.canPlaybackRate="hls"===c.mode||"h264"===c.mode?b():!1,c.postrolling=!1,c.paused=!0,c.on("play",function(){c.paused=!1}).on("pause",function(){c.paused=!0})}}),define("player/addPlaybackRate",[],function(){"use strict";var a=1;return function(b){function c(){return b.config.get("playbackRate")}function d(){g?b._playbackRate(a):b._playbackRate(c())}function e(){g=!1,d()}function f(){g=!0,d()}var g=!1;b.on("ready",function(){b.playbackRate(c())}),b.on("play",d),b.on("prerollStart",f),b.on("postrollStart",f),b.on("prerollComplete",e),b.on("postrollComplete",e),b.on("playbackRate",function(a){b.config.set("playbackRate",a),d()})}}),define("player/addVolume",[],function(){"use strict";return function(a){var b=!1;a.on("ready",function(){a.volume(a.config.get("volume")),a.mute(a.config.get("muted"))}).on("muted",function(c){b=c,a.config.set("muted",c)}).on("volume",function(c){a.config.set("volume",c),c>0&&b&&a.mute(!1)})}}),define("player/augmentTalks",[],function(){"use strict";return function(a){if(!a||!a.length)return[];for(var b,c=a.length,d=c;d--;)b=a[d],b.index=d;return a}}),define("player/addInitPromise",["jquery"],function(a){"use strict";return function(b){var c=new a.Deferred;b.on("error",function(a){c.rejectWith(b,[a])}),b.on("ready",function(){"pending"===c.state()&&c.resolveWith(b,[b])}),a.extend(b,c.promise())}}),define("player/addThrower",["jquery","./handleError"],function(a,b){"use strict";return function(c){var d=!0;c.one("play",function(){d=!1}),c.throwError=function(e){e=a.extend({type:"unknown",message:null,severity:"warning"},e||{}),d&&"fatal"===e.severity&&(e.severity="abortive"),b(a.extend({context:"ted_player_wrapper"},e)),c.topic("error").publish(e)}}}),define("player/Config",["jquery"],function(a){"use strict";function b(a){return!!(a&&a.getItem&&a.setItem&&window.JSON&&JSON.parse&&JSON.stringify)}function c(c,d){if(b(c)){var e=c.getItem(d);if("string"===a.type(e)&&(e=JSON.parse(e),"object"===a.type(e)))return e}return{}}function d(c,d,e){b(c)&&"object"===a.type(e)&&c.setItem(d,JSON.stringify(e))}function e(a){this._options=a,this._inited=!1}return a.extend(e.prototype,{_init:function(){this._inited||(this.internal=a.extend({},this._options.defaults,c(this._options.storageAdapter,this._options.storageProperty)),this._inited=!0)},get:function(a){return this._init(),this.internal[a]},set:function(a,b){this._init(),this.internal[a]=b,d(this._options.storageAdapter,this._options.storageProperty,this.internal)}}),e}),define("player/Player",["jquery","./topicFactory","./replaceElement","./getSupportedMode","./checkRequiredParams","./addHandlers","./addActions","./addProperties","./addPlaybackRate","./addVolume","./augmentTalks","./isLastTalk","./addInitPromise","./addThrower","./Config"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function p(l){var p=this;this.topic=b({bufferPlayable:void 0,bufferUnplayable:void 0,play:void 0,pause:void 0,prerollStart:void 0,prerollBlock:void 0,postrollStart:void 0,postrollEnd:void 0,adBlock:void 0,seeked:void 0,seeking:void 0}),n(p);var q=!1;this.topic("error").subscribe(function(a){"abortive"===a.severity&&(q=!0)}),m(p),l=a.extend({},t,l),e(l,p.throwError),l.mode=d(l),l.mode||p.throwError({type:"client",message:"Client does not support any player mode.",severity:"fatal"}),l.talks=k(l.talks),l.talks.length||p.throwError({type:"init",message:"No talks sent to player.",severity:"fatal"}),this.options=l,this.config=new o(a.extend({defaults:{languageCode:!1,muted:!1,volume:l.defaultVolume,playbackRate:l.defaultPlaybackRate}},l)),h(this),g(p),j(p),i(p),q||(this.topic("ready.dom").once(function(){window.setTimeout(function(){f(p),p.topic("ready.handlers").once(function(){q||p.topic("ready").publish()})},10)}),c(this))}var q,r=function(){var a=document.createElement("video");return a&&a.defaultPlaybackRate?a.defaultPlaybackRate:1}();try{q=window.localStorage}catch(s){}var t={attrs:{},defaultPlaybackRate:r,defaultVolume:.5,el:null,flashVersion:"11.1.0",nativeLanguage:"en",storageAdapter:q,storageProperty:"playerconfig",swf:"assets/player.swf"};a.extend(p.prototype,{on:function(a,b){return this.topic(a).subscribe(b),this},one:function(a,b){return this.topic(a).once(b),this},isLastTalk:function(){return l(this)}});b();return p}),define("widgets/player",["jquery","lodash","widgets/player/ga-tracker","widgets/player/ted-tracker","widgets/player/cs-tracker","utils/f","utils/is_mobile","utils/query_param","utils/ted","player/Player","lib/pubSub","lib/focus-zone","Cookies","spinjs","jqueryui/widget","widgets/hover","lib/resize"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function o(){return h("playerMode")||null}function p(a){a.preventDefault(),a.stopPropagation()}var q="player",r=q+"--playing",s=q+"--fullscreen",t=q+"--show-cursor",u=q+"__container",v=u+"__cursor-killer",w=u+"__focus",x=u+"__placeholder",y=u+"__video",z=a("<div></div>"),A=b.once(function(c,d){window.onYouTubeIframeAPIReady=b.bind(c,d),a.getScript("//www.youtube.com/iframe_api")});return a.widget("ted.player",a.ted.hover,{options:{breakpoint:!0,currentTalk:null,flashVars:{},metricsKey:null,mode:o(),nativeLanguage:"en",startTrackingAt:0,swf:i("playerPath"),talks:null,hideCursorDelay:1e3,soonThreshold:.1,recordInIdentity:!0},_isPlayerInitialized:!1,_isPlaying:!1,_addElements:function(){var a=this.element.find("div."+u);a.length||(a=z.clone().addClass(u).appendTo(this.element));var b=a.find("div."+x);b.length||(b=z.clone().addClass(x).appendTo(a)),b.wrap(z.clone().addClass(w));var c=b.closest("div."+w).addClass(y).attr({href:"#",role:"button",title:"Play/Pause"}),d=a.find("div."+v);d.length||(d=z.clone().addClass(v).appendTo(a)),this.elements={container:a,focal:c,placeholder:b,cursorKiller:d}},_breakpoint:function(a){this.options.breakpoint&&(1024>a?this.video.attr("controls","controls"):this.video.removeAttr("controls"))},_create:function(){this.options.currentTalk||(this.options.currentTalk=this.options.talks[0]),this._on({playerplay:function(){this._isPlaying=!0,this.element.addClass(r)},playerpause:function(){this._isPlaying=!1,this.element.removeClass(r)}}),this._isInternal=!this.talk().external,this.options.hoverStopDelay=this.options.hideCursorDelay,new c(this),new d(this),new e(this),this._initializePlayer()},_initializePlayer:function(){this._isPlayerInitialized||(this._isPlayerInitialized=!0,this.element.addClass(q),this._addElements(),this._isInternal?this._initializeInternalPlayer():"YouTube"===this.talk().external.service&&this._initializeYouTubePlayer(),this._hoverInit())},_initializeYouTubePlayer:function(){A(this._youTubeApiReady,this),this._on({playerrequestplay:function(){this._ytPlayer&&this._ytPlayer.playVideo&&this._ytPlayer.playVideo()}})},_youTubeApiReady:function(){var b=this,c=this.talk(),d="//www.youtube.com/embed/"+c.external.code+"?showinfo=0&enablejsapi=1&autoplay=0&origin="+location.origin;c.external.startTime&&(d+="&start="+c.external.startTime);var e=a("<iframe class="+y+" src="+d+" frameborder=0 allowfullscreen></iframe>");b.elements.placeholder.replaceWith(e),b._ytPlayer=new YT.Player(e.get(0),{events:{}}),b._trigger("domready")},_initializeInternalPlayer:function(){var c=h("dfptest");this.options.talks=this.options.talks.map(function(a){if(c){var b=encodeURIComponent(c);a.resources.hls.adUrl=a.resources.hls.adUrl.replace(/(cust_params=[^&]+)&/,"$1%26dfptest%3D"+b+"&")}var d=Number(a.introDuration);return a.introDuration=Math.min(d,11.82),a.adDuration=0===d?0:3.33,a.postAdDuration=0===d?0:.83,a}),this.player=new j({attrs:{"class":y},el:this.elements.placeholder.get(0),flashVars:this.options.flashVars,metricsKey:this.options.metricsKey,mode:this.options.mode,nativeLanguage:this.options.nativeLanguage,swf:this.options.swf,talks:this.options.talks}),this.element.addClass(q+"--"+this.mode()),g()&&this.element.addClass(q+"--is-mobile"),this._subscribeToPlayerEvents(),this._subscribeToKeyboardEvents(),this.player.one("ready.dom",b.bind(this._playerDomReady,this)),this.player.canFullScreen&&(this.player.on("enterFullScreen",b.bind(this._playerEnterFullScreen,this)),this.player.on("exitFullScreen",b.bind(this._playerExitFullScreen,this))),this.player.on("talk",b.bind(function(a){this.options.currentTalk=a,this._trigger("talk",null,a)},this)),this.player.on("bufferUnplayable",b.bind(this._bufferingStarted,this)),this.player.on("bufferPlayable",b.bind(this._bufferingStopped,this)),this._on({playercurrenttime:function(a,b){this._currentTime=b.currentTime},playerplaybackrate:function(a,b){this._playbackRate=b.playbackRate},playervolume:function(a,b){this._volume=b.volume},playerprogress:function(){var a;return function(b,c){!a&&c.progress>1-this.options.soonThreshold&&this.player.isLastTalk()&&(a=!0,this._trigger("soon"))}}(),playerpostrollcomplete:function(){this.player.isLastTalk()&&!this._queuedTalkId&&(this._queuedTalkId=this.options.currentTalk.id)},playerrequestplay:function(){var c=a("*:focus");c.closest(this.elements.focal).length||(this._oldFocus=c),this.elements.focal.attr("tabindex","1"),this._queuedTalkId?(a(this.player.el).attr("preload",""),this.player.playTalk(this._queuedTalkId),this._queuedTalkId=null,b.delay(f(this.player,"play"))):this.player.play()},playerplay:function(){this.elements.focal.focus()},playerrequestpause:function(){this.player.postrolling||this.player.pause()}})},_destroy:function(){this.options.breakpoint&&k("breakpoint").unsubscribe(this._breakpoint)},_playerDomReady:function(){var c=a(this.player.el);this.video=c,this.options.breakpoint&&k("breakpoint").subscribe(b.bind(this._breakpoint,this)),this._trigger("domready")},_playerEnterFullScreen:function(){this.element.addClass(s),this._fullscreenZone("activate")},_playerExitFullScreen:function(){this.element.removeClass(s),this._fullscreenZone("deactivate")},_subscribeToKeyboardEvents:function(){this._on(this.elements.focal,{keydown:this._keyDown,keyup:this._keyUp})},_subscribeToPlayerEvents:function(){var a,c=this;this._on({playerrequestplay:function(){a=!0},playerplay:function(){a=!1}}),b.forEach(["ad","currentTime","duration","ended","enterFullScreen","error","exitFullScreen","pause","play","progress","ready","seeked","seeking","volume","muted","idle","complete","talkComplete","prerollStart","prerollBlock","postrollStart","postrollComplete","postrollDuration","postrollRemaining","adBlock","bufferPlayable","bufferUnplayable","subtitle","playbackRate","metricsData","metricsToggle"],function(b){c.player.on(b,function(d){var e={};"play"!==b||a||c._trigger("requestplay"),e[b]=d,c._trigger(b,null,e),c["_"+b]=d})})},_hoverStart:function(a){this.element.addClass(t),this._trigger("hoverstart",a)},_hoverStop:function(a){this.element.removeClass(t),this._trigger("hoverstop",a)},_bufferingStarted:function(){this._spinner||(this._spinner=new n({lines:13,length:13,width:5,radius:16,color:"#FFF",trail:50,shadow:!0})),this._spinner.spin(this.element.get(0))},_bufferingStopped:function(){this._spinner.stop()},_keyDown:function(b){var c=a.ui.keyCode,d=b.ctrlKey||b.shiftKey||b.altKey,e=this,f=e.options.currentTalk&&e.options.currentTalk.duration||0,g=e._currentTime||0,h=e.volume()||0;switch(b.keyCode){case c.ENTER:case c.NUMPAD_ENTER:case c.SPACE:e.toggle(),p(b);break;case c.DOWN:d?e.mute(!0):e.volume(h-.1),p(b);break;case c.UP:d?e.mute(!1):e.volume(h+.1),p(b);break;case c.LEFT:d?e.seek(g-.1*f):e.seek(g-15),p(b);break;case c.RIGHT:d?e.seek(g+.1*f):e.seek(g+15),p(b);break;case c.HOME:e.seek(0),p(b);break;case c.END:e.seek(f-1),p(b);break;case c.TAB:var i=this._oldFocus;this._tabDown||!i||i.is(":hidden")||i.is(":disabled")||(i.focus(),p(b)),this._oldFocus=null,this._tabDown=!0}},_keyUp:function(b){b.keyCode===a.ui.keyCode.TAB&&(this._tabDown=!1)},_fullscreenZone:function(a){var b=this.player.fullScreenElement,c=this._fullscreenZoneObj;b&&(c||(c=new l(b),this._fullscreenZoneObj=c),c[a]())},mode:function(){return this._isInternal?this.player.options.mode:"external"},talk:function(a){return arguments.length&&(this.queue(a),this._trigger("requestplay")),this.options.currentTalk},talks:function(){return this.player.talks},toggle:function(){this[this._isPlaying?"pause":"play"]()},play:function(){this._trigger("requestplay")},playNext:function(){this._trigger("requestnext"),this.player.playNext()},playPrev:function(){this._trigger("requestprev"),this.player.playPrev()},pause:function(){this._trigger("requestpause")},_playbackRate:null,playbackRate:function(a){return arguments.length&&(this.player.playbackRate(a),this._playbackRate=a),this._playbackRate},queue:function(a){this._queuedTalkId=a},sendAds:function(a){this.player.sendAds(a)},seek:function(a,b){this.options.startTrackingAt=b?a:0,this.player.seek(a)},_subtitle:null,subtitle:function(a){if(arguments.length){var c=a?b.find(this.talk().languages,{languageCode:a}):!1;this.player.subtitle(a),this._subtitle=c}return this._subtitle},_volume:null,volume:function(a){return arguments.length&&this.player.volume(a),this._volume},_muted:null,mute:function(a){return arguments.length&&this.player.mute(a),this._muted},toggleFullScreen:function(){var b=a("html,body"),c=a(document).scrollTop(),d=a(this.element),e=d.offset().top;c>e&&b.scrollTop(e),this[this.player.isFullScreen?"cancelFullScreen":"requestFullScreen"](this.elements.container.get(0))},requestFullScreen:function(a){this.player.requestFullScreen(a)},cancelFullScreen:function(a){this.player.cancelFullScreen(a)},isControllable:function(){return this._isInternal},isFullScreen:function(){return this._isInternal?this.player.isFullScreen:!1},canFullScreen:function(){return this._isInternal?this.player.canFullScreen:!1},canPlaybackRate:function(){return this._isInternal?this.player.canPlaybackRate:!1},canSubtitle:function(){var a=String(this.player.mode);return this._isInternal&&"flash"===a},capQualityToStage:function(a){this.player.capQualityToStage(a)}}),function(b,c){return a(b).player(c)}}),define("hbs!templates/playerPip",["hbs","hbs/handlebars","templates/helpers/thumb"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div class="player-pip__controls">\n  <div class="player-pip__thumb">'+this.escapeExpression((b.thumb||a&&a.thumb||b.helperMissing).call(a,"",{name:"thumb",hash:{},data:d}))+'</div>\n\n  <a class="player-pip__controls__button player-pip__controls__play" href="#">\n    <i class="player-pip__controls__icon g-pip-play"></i>\n  </a>\n\n  <a class="player-pip__controls__button player-pip__controls__pause" href="#">\n    <i class="player-pip__controls__icon g-pip-pause"></i>\n  </a>\n</div>\n\n<div class="player-pip__details"></div>\n'},useData:!0});return b.registerPartial("templates/playerPip",c),c}),define("hbs!templates/playerPipDetails",["hbs","hbs/handlebars","templates/helpers/t","templates/helpers/formatDate","templates/helpers/formatDuration"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="player-pip__meta">\n  <span class="player-pip__meta__event">'+this.escapeExpression((e=null!=(e=b.event||(null!=a?a.event:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"event",hash:{},data:d}):e))+"</span>\n  &middot;\n  "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Filmed",{name:"t",hash:{},data:d}))+'\n  <span class="player-pip__meta__value">'+this.escapeExpression((b.formatDate||a&&a.formatDate||b.helperMissing).call(a,"MMMM YYYY",null!=a?a.filmed:a,{name:"formatDate",hash:{forceUTC:!0},data:d}))+'</span>\n  &middot;\n  <span class="player-pip__meta__value">'+this.escapeExpression((b.formatDuration||a&&a.formatDuration||b.helperMissing).call(a,null!=a?a.duration:a,{name:"formatDuration",hash:{},data:d}))+'</span>\n</div>\n\n<a class="l3 player-pip__title player-pip__top-link" href="#">'+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+"</a>\n"},useData:!0});return b.registerPartial("templates/playerPipDetails",c),c}),define("widgets/playerPip",["jquery","hbs!templates/playerPip","hbs!templates/playerPipDetails","waypoints","jqueryui/widget"],function(a,b,c){"use strict";var d="player-pip--playing",e="player-pip--paused",f="player-pip__container";return a.widget("ted.playerPip",{options:{player:null,waypoint:null},shouldBeOn:!1,_create:function(){var c=this,d=a("html,body"),e=a(b()),g=this.element.find("div."+f);g.length||(g=a("<div></div>").addClass(f).appendTo(this.element)),g.append(e),this.detailsElement=e.filter("div.player-pip__details"),this.options.player&&this._setPlayer(),c._on({"click a.player-pip__controls__play":function(a){a.preventDefault(),this._trigger("play")},"click a.player-pip__controls__pause":function(a){a.preventDefault(),this._trigger("pause")},"click a.player-pip__top-link":function(a){a.preventDefault(),d.animate({scrollTop:c.options.waypoint.offset().top},200)}}),c.options.waypoint.waypoint(function(a){c.shouldBeOn="down"===a,c.refreshState()},{offset:function(){return-c.options.waypoint.height()}})},_setPlayer:function(){function b(a){c.details({event:a.event,filmed:a.filmed,published:a.published,duration:a.duration,name:a.name,thumb:a.thumb})}var c=this,f=a(c.options.player);b(f.player("talk")),c._on({playerpipchangestate:function(a,b){f.player("capQualityToStage",!b.isOn)},playerpipplay:function(){f.player("play")},playerpippause:function(){f.player("pause")}}),f.on("playerrequestplay",function(){c.element.addClass(d)}).on("playerplay",function(){c.element.removeClass(e).addClass(d)}).on("playerpause",function(){c.element.addClass(e).removeClass(d)}).on("playerended",function(){c.element.removeClass(e).removeClass(d)}).on("playertalk",function(a,c){b(c)})},details:function(b){var d;arguments.length&&(a.isPlainObject(b)?(b=a.extend({eventName:"",filmed:new Date,duration:0,name:"",thumb:""},b),b.filmed*=1e3,b.thumb&&this.element.find("img.thumb__image").attr("src",b.thumb),d=c(b)):d=b,this.detailsElement.html(d))},refreshState:function(){var a=this.shouldBeOn;this.element[a?"addClass":"removeClass"]("player-pip--on"),this._trigger("changeState",null,{isOn:a})}}),function(b,c){return a(b).playerPip(c)}}),define("widgets/playerHero",["jquery","lodash","lib/pubSub","Modernizr","hbs!templates/playerHeroHiccup","widgets/controls","widgets/player","widgets/playerPip","lib/resize"],function(a,b,c,d,e){"use strict";return a.widget("ted.playerHero",{_hasPlayed:!1,options:{hiccups:!1,isSkip:!1,isTranscript:!1,metricsKey:null,nativeLanguage:"en",precontrol:!1,talks:[]},_create:function(){var a=this;a.playerElement=a.element.find("div.player"),a.maxiControlsElement=a.element.find("div.controls--maxi"),a.miniControlsElement=a.element.find("div.controls--mini"),a.pipElement=a.element.find("div.player-pip"),this._addPlayStates(),a._on(a.playerElement,{playererror:function(b,c){var d=c.error,e="client"===d.type?"isClient":!1;"abortive"===d.severity&&a._hiccup(e||"isInit"),"fatal"===d.severity&&a._hiccup(e||"isFatal")},playerrequestplay:function(){a._onFirstPlay()}}),a._on({"click a.player-hero__play":function(a){a.preventDefault(),this.play()}}),a._on(a.pipElement,{playerpipchangestate:function(b,c){a.element[c.isOn?"addClass":"removeClass"]("player-hero--pip-on")}}),a.playerElement.player({metricsKey:a.options.metricsKey,nativeLanguage:a.options.nativeLanguage,talks:a.options.talks})},_isMiniBreakpoint:!1,_isPlayerInitialized:!1,_isPlayerFullScreen:!1,_addPlayStates:function(){function b(){c.element.addClass(g).removeClass(j).removeClass(f).removeClass(h).removeClass(i)}var c=this,d=!1,e=c.playerElement,f="player-hero--idle",g="player-hero--playing",h="player-hero--paused",i="player-hero--unactivated",j="player-hero--ended",k="player-hero--early-request";c._on(e,{playerplay:b,playerrequestplay:b,playerpause:function(){c.element.removeClass(g).removeClass(f).removeClass(j),e.player("isControllable")?c.element.addClass(h).removeClass(i):c.element.addClass(i)},playerdomready:function(){window.playerHeroPlay&&(window.playerHeroPlay=a.noop),c.element.hasClass(k)&&(d=!0,c.play(),e.addClass("player--playing"),c.element.removeClass(k))},playerready:function(){d&&(c.play(),d=!1);var a=c.playerElement.player("mode");"flash"===a&&c.pipElement.playerPip({player:c.playerElement,waypoint:c.element.find("div.player-hero__banner")}),c.options.precontrol&&c._renderMaxiControls()},playeridle:function(){c.element.addClass(f)},playerended:function(){c.element.removeClass(f).addClass(j).removeClass(h).removeClass(i).addClass(g)},playerenterfullscreen:function(){c._isPlayerFullScreen=!0,c._refreshMiniControlsState(),c._isPlayerInitialized||c.play()},playerexitfullscreen:function(){c._isPlayerFullScreen=!1,c._refreshMiniControlsState()},playerhoverstart:function(){this.miniControlsElement.addClass("controls--visible")},playerhoverstop:function(){this.miniControlsElement.removeClass("controls--visible")}})},_refreshMiniControlsState:function(){var a=this._isPlayerFullScreen||this._isMiniBreakpoint;this.miniControlsElement[a?"addClass":"removeClass"]("controls--active")},_renderMaxiControls:function(){this._isMaxiControlsRendered||(this._isMaxiControlsRendered=!0,this.playerElement.player("isControllable")?this.maxiControlsElement.controls({isSkip:this.options.isSkip,isTranscript:this.options.isTranscript,player:this.playerElement,template:"maxi"}):this.element.addClass("player-hero--uncontrollable"))},_onFirstPlay:function(){var a=this;if(!a._isPlayerInitialized){a._isPlayerInitialized=!0,a._renderMaxiControls(),this.playerElement.player("isControllable")&&a.miniControlsElement.controls({player:a.playerElement,template:"mini"});var d=a.playerElement.player("mode"),e=a.options.hiccups;(e===d||e===!0||b.isArray(e)&&b.contains(e,d))&&a._hiccup("isHiccup"),"flash"===d&&c("breakpoint").subscribe(function(b){a._isMiniBreakpoint=1024>b,a._refreshMiniControlsState()})}},_hiccup:function(a){if(!this._hiccuped){this._hiccuped=!0;var b={};b[a]=!0,this.element.prepend(e(b))}},play:function(){this._hasPlayed=!0,TED.playerOffset&&TED.playerOffset>0&&this.playerElement.player("seek",TED.playerOffset),this.playerElement.player("play")},player:function(){return this.playerElement}}),function(b,c){return a(b).playerHero(c)}}),define("hbs!templates/popupMenu",["hbs","hbs/handlebars"],function(a,b){var c=b.template({1:function(a,b,c,d){var e,f;return'      <li class="poup-menu__item">\n        <a href="'+this.escapeExpression((f=null!=(f=b.url||(null!=a?a.url:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"url",hash:{},data:d}):f))+'" '+(null!=(e=b["if"].call(a,null!=a?a.blank:a,{name:"if",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:"")+' class="l3 popup-menu__link">\n          '+this.escapeExpression((f=null!=(f=b.label||(null!=a?a.label:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"label",hash:{},data:d}):f))+"\n        </a>\n      </li>\n"},2:function(a,b,c,d){return'target="_blank"'},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="popup-menu">\n  <ul class="popup-menu__list">\n'+(null!=(e=b.each.call(a,null!=a?a.items:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"  </ul>\n</div>\n"},useData:!0});return b.registerPartial("templates/popupMenu",c),c}),define("widgets/popupMenu",["jquery","lodash","hbs!templates/popupMenu","widgets/tooltip"],function(a,b,c){"use strict";return a.widget("ted.popupMenu",a.ted.tooltip,{options:{interactive:!0,inverse:!0,items:[],position:{my:"center top+10",at:"center bottom",of:window,collision:"fit flip"}},_create:function(){this.options.content||(this.options.content=c({items:this._items()})),this._super(),this._on(this.popupObject,{"click a.popup-menu__link":function(a){var b=this.popupObject.find("a.popup-menu__link").index(a.target),c=-1===b?null:this.options.items[b];c.url||a.preventDefault(),this._trigger("itemclick",a,c)!==!1&&c.callback&&c.callback.call(a.target,a,c)}})},_items:function(){return b.map(this.options.items,function(a){var c=a.url||"#",d=a.blank||c.match(/^(?:https?:)?\/\//);return b.merge({},a,{url:c,blank:d})})}}),function(b,c){return a(b).popupMenu(c)}}),define("hbs!templates/talkDownloadModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'    <select class="talk-download__language form-control form-control--dropdown">\n      <option value="">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Subtitles: None",{name:"t",hash:{},data:d}))+"</option>\n"+(null!=(e=b.each.call(a,null!=a?a.subtitledLanguages:a,{name:"each",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:"")+"    </select>\n"},2:function(a,b,c,d){var e;return'        <option value="'+this.escapeExpression((e=null!=(e=b.languageCode||(null!=a?a.languageCode:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"languageCode",hash:{},data:d}):e))+'">\n          '+this.escapeExpression((e=null!=(e=b.languageName||(null!=a?a.languageName:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"languageName",hash:{},data:d}):e))+"\n        </options>\n"},4:function(a,b,c,d){var e;return'      <li data-size="'+this.escapeExpression((e=null!=(e=b.size||(null!=a?a.size:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"size",hash:{},data:d}):e))+'">\n        <label>\n          <input name="size" class="talk-download__size" type="radio" value="'+this.escapeExpression((e=null!=(e=b.size||(null!=a?a.size:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"size",hash:{},data:d}):e))+'">\n          '+this.escapeExpression((e=null!=(e=b.label||(null!=a?a.label:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"label",hash:{},data:d}):e))+"\n        </label>\n      </li>\n"},6:function(a,b,c,d){var e;return'  <div class="talk-download__audio">\n    <h4>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Audio",{name:"t",hash:{},data:d}))+'</h4>\n    <div class="talk-download__coach">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Audio downloads are available in MP3 format.",{name:"t",hash:{},data:d}))+'</div>\n\n    <a class="button" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.talk:a)?e.audioDownload:e,a))+'" download>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Download audio",{name:"t",hash:{},data:d}))+"</a>\n  </div>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n  </a>\n\n  <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Download this talk",{name:"t",hash:{},data:d}))+'</h3>\n</div>\n\n<div class="talk-download__video">\n  <h4>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Video",{name:"t",hash:{},data:d}))+'</h4>\n  <div class="talk-download__coach">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Videos are available for download in MP4 format.",{name:"t",hash:{},data:d}))+"</div>\n\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.talk:a)?e.subtitledDownloads:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'\n  <ul class="talk-download__list">\n'+(null!=(e=b.each.call(a,null!=a?a.sizes:a,{name:"each",hash:{},fn:this.program(4,d,0),inverse:this.noop,data:d}))?e:"")+'  </ul>\n\n  <a class="button talk-download__button--video" href="#" download>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Download video",{name:"t",hash:{},data:d}))+'</a>\n\n  <div class="talk-download__link">\n    For low bandwidth downloads,\n    <a href="http://www.ted.com/talks/quick-list" target="_blank">\n      visit TED\'s quicklist\n    </a>\n  </div>\n</div>\n\n'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.talk:a)?e.audioDownload:e,{name:"if",hash:{},fn:this.program(6,d,0),inverse:this.noop,data:d}))?e:"")},useData:!0});return b.registerPartial("templates/talkDownloadModal",c),c}),define("widgets/talkDownloadModal",["jquery","hbs!templates/talkDownloadModal","widgets/modal"],function(a,b){"use strict";function c(a,b){for(var c,d=a.length,e=[],f=-1;++f<d;)c=a[f],b&&b[c.languageCode]&&e.push(c);return e}var d=[{size:"low",label:"Low (320x180)"},{size:"medium",label:"Medium (512x288)"},{size:"high",label:"High (854x480)"}];a.widget("ted.talkDownloadModal",a.ted.modal,{options:{subtitle:null,talk:null},elements:{},_create:function(){this.element.html(b({sizes:d,talk:this.options.talk,subtitledLanguages:c(this.options.talk.languages,this.options.talk.subtitledDownloads)})),this.elements.sizeRadios=this.element.find("input.talk-download__size"),this.elements.sizeItems=this.elements.sizeRadios.closest("li"),this.elements.videoDownload=this.element.find("a.talk-download__button--video"),this.elements.languageDropdown=this.element.find("select.talk-download__language"),this._on({talkdownloadmodalopen:this._onOpen}),this._super(),this._on({"click input.talk-download__size":this.refreshVideoUrl,"change select.talk-download__language":this.refreshVideoUrl,"click a.talk-download__button--video":function(a){this._trigger("download",a,{type:"video",language:this.elements.languageDropdown.val(),quality:this.elements.sizeRadios.filter(":checked:data(visible)").val()})},"click a.talk-download__button--audio":function(a){this._trigger("download",a,{type:"audio"})}}),this.refreshVideoUrl()},refreshVideoUrl:function(){var b,c=this.elements.languageDropdown.val(),d=this.options.talk;b=c?d.subtitledDownloads[c]:d.nativeDownloads,this.elements.sizeItems.each(function(){var c=a(this),d=c.find("input"),e="visible",f=b[c.data("size")];f?(c.show(),d.data(e,e)):(c.hide(),d.removeData(e))});var e=this.elements.sizeRadios.filter(":checked:data(visible)");e.length||(e=this.elements.sizeRadios.filter(":data(visible)").last().prop("checked",!0)),this.elements.videoDownload.attr("href",b[e.val()])},_onOpen:function(){this.options.subtitle&&this.elements.languageDropdown.length&&this.elements.languageDropdown.val(this.options.subtitle),this.refreshVideoUrl()}})}),define("hbs!templates/talkEmbedModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'    <div>\n      <h4 class="m5">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Select subtitles",{name:"t",hash:{},data:d}))+'</h4>\n      <select class="talk-embed__language">\n        <option value="">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Subtitles: None",{name:"t",hash:{},data:d}))+"</option>\n"+(null!=(e=b.each.call(a,null!=(e=null!=a?a.talk:a)?e.languages:e,{name:"each",hash:{},fn:this.program(2,d,0),inverse:this.noop,data:d}))?e:"")+"      </select>\n    </div>\n"},2:function(a,b,c,d){var e;return'          <option value="'+this.escapeExpression((e=null!=(e=b.languageCode||(null!=a?a.languageCode:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"languageCode",hash:{},data:d}):e))+'">\n            '+this.escapeExpression((e=null!=(e=b.languageName||(null!=a?a.languageName:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"languageName",hash:{},data:d}):e))+"\n          </options>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="modal__head">\n  <a class="modal__close modal__head__close" href="#" role="button">\n    <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n  </a>\n\n  <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Embed this talk",{name:"t",hash:{},data:d}))+'</h3>\n</div>\n\n<div class="talk-embed">\n  <div>\n    <h4 class="m5">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Copy & paste this code into your website or blog.",{name:"t",hash:{},data:d}))+'</h4>\n    <input class="form-control talk-embed__code">\n    <h4 class="m5">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Wordpress shortcode",{
name:"t",hash:{},data:d}))+'</h4>\n    <input class="form-control talk-embed__wordpress">\n  </div>\n\n'+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.talk:a)?e.languages:e,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'\n  <div class="talk-embed__sizes">\n    <h4 class="m5">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Select a size",{name:"t",hash:{},data:d}))+'</h4>\n    <a class="talk-embed__size talk-embed__size--small" href="#" data-x="560" data-y="315">560 x 315</a>\n    <a class="talk-embed__size talk-embed__size--selected talk-embed__size--medium" href="#" data-x="640" data-y="360">640 x 360</a>\n    <a class="talk-embed__size talk-embed__size--large" href="#" data-x="854" data-y="480">854 x 480</a>\n  </div>\n</div>\n'},useData:!0});return b.registerPartial("templates/talkEmbedModal",c),c}),define("widgets/talkEmbedModal",["jquery","hbs!templates/talkEmbedModal","widgets/modal"],function(a,b){"use strict";var c="talk-embed",d=c+"__size",e=d+"--selected";a.widget("ted.talkEmbedModal",a.ted.modal,{options:{talk:null},elements:{},_create:function(){this._setContent(),this._super(),this._on({"click a.talk-embed__size":function(b){this.elements.sizes.removeClass(e),a(b.target).addClass(e),this.refreshEmbed(),b.preventDefault()},"click input.talk-embed__code":function(b){a(b.target).select()},"change select.talk-embed__language":this.refreshEmbed}),this.refreshEmbed()},_setContent:function(){this.element.html(b(this.options)),this.elements.code=this.element.find("input."+c+"__code"),this.elements.wordpress=this.element.find("input."+c+"__wordpress"),this.elements.sizes=this.element.find("a."+d),this.elements.language=this.element.find("select."+c+"__language")},_setOptions:function(a,b){this._super(a,b),this._setContent(),this.refreshEmbed()},refreshEmbed:function(){var a=this.elements.language.val(),b=this.elements.sizes.filter("a."+e),c=a?"lang/"+a+"/":"",d=a?" lang="+a:"";this.elements.code.val(["<iframe ",'src="https://embed-ssl.ted.com/talks/',c,this.options.talk.slug,'.html" ','width="',b.data("x"),'" ','height="',b.data("y"),'" ','frameborder="0" scrolling="no" ',"webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>"].join("")),this.elements.wordpress.val(["[ted id=",this.options.talk.id,d,"]"].join(""))}})}),define("hbs!templates/talkRatingModal",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return'        <li class="talk-rating__item">\n          <label>\n            <input class="talk-rating__checkbox" type="checkbox" value="'+this.escapeExpression((e=null!=(e=b.id||(null!=a?a.id:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"id",hash:{},data:d}):e))+'">\n            <span>'+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+"</span>\n          </label>\n        </li>\n"},3:function(a,b,c,d){return'      <div class="talk-rating__flip">\n        <a class="l3 talk-rating__flip__link" href="#">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"See all ratings",{name:"t",hash:{},data:d}))+"</a>\n      </div>\n"},5:function(a,b,c,d){var e;return'        <li class="talk-rating__item">\n          <div class="talk-rating__result">\n            <div class="talk-rating__result__bar" style="width:'+this.escapeExpression((e=null!=(e=b.percent||(null!=a?a.percent:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"percent",hash:{},data:d}):e))+'%"></div>\n            <span class="talk-rating__result__name">'+this.escapeExpression((e=null!=(e=b.name||(null!=a?a.name:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"name",hash:{},data:d}):e))+'</span>\n            <span class="talk-rating__result__value">'+this.escapeExpression((e=null!=(e=b.percent||(null!=a?a.percent:a))?e:b.helperMissing,"function"==typeof e?e.call(a,{name:"percent",hash:{},data:d}):e))+"%</span>\n          </div>\n        </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="talk-rating">\n  <div class="modal__head">\n    <a class="modal__close modal__head__close" href="#" role="button">\n      <i class="g-button-modal-close">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Close",{name:"t",hash:{},data:d}))+'</i>\n    </a>\n    <h3 class="modal__head__title">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Rate this talk",{name:"t",hash:{},data:d}))+'</h3>\n  </div>\n\n  <div class="talk-rating__submit">\n    <p>\n      '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"How would you describe this talk? Tell us by choosing up to three words. (If you choose just one, it will count three times.)",{name:"t",hash:{},data:d}))+'\n    </p>\n\n    <ul class="talk-rating__list">\n'+(null!=(e=b.each.call(a,null!=a?a.ratings:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'    </ul>\n\n    <button class="button talk-rating__submit__commit" disabled>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Submit",{name:"t",hash:{},data:d}))+"</button>\n\n"+(null!=(e=b["if"].call(a,null!=a?a.total:a,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+'  </div>\n\n  <div class="talk-rating__show">\n    <p>\n      <span class="talk-rating__submitted-message">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Thanks for rating this talk!",{name:"t",hash:{},data:d}))+"</span>\n      "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Here's what everyone else thought:",{name:"t",hash:{},data:d}))+'\n    </p>\n\n    <ul class="talk-rating__list">\n'+(null!=(e=b.each.call(a,null!=a?a.ratings:a,{name:"each",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+'    </ul>\n\n    <div class="talk-rating__flip">\n      <a class="l3 talk-rating__flip__link" href="#">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Submit your own rating",{name:"t",hash:{},data:d}))+"</a>\n    </div>\n  </div>\n\n</div>\n"},useData:!0});return b.registerPartial("templates/talkRatingModal",c),c}),function(a,b,c){"object"==typeof exports?module.exports=c():"function"==typeof define&&define.amd?define("depot",c):b[a]=c()}("depot",this,function(){"use strict";function a(a){return a&&JSON.parse(a)}function b(a,b){return a+"-"+b}function c(a,b){var c,d;if("function"==typeof a)c=a(b);else{c=!0;for(d in a)c&=a[d]===b[d]}return c}function d(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function e(){return d()+d()+"-"+d()+"-"+d()+"-"+d()+"-"+d()+d()+d()}function f(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function g(a,b){var c,d;if(b=f({idAttribute:"_id",storageAdaptor:localStorage},b),!b.storageAdaptor)throw new Error("No storage adaptor was found");return c=b.storageAdaptor.getItem(a),d=c&&c.split(",")||[],Object.create(h,{name:{value:a},store:{value:c},ids:{value:d,writable:!0},idAttribute:{value:b.idAttribute},storageAdaptor:{value:b.storageAdaptor}})}var h={save:function(a){var c;return a[this.idAttribute]||(a[this.idAttribute]=e()),c=a[this.idAttribute]+"",this.ids.indexOf(c)<0&&(this.ids.push(c),this.storageAdaptor.setItem(this.name,this.ids.join(","))),this.storageAdaptor.setItem(b(this.name,c),JSON.stringify(a)),a},update:function(a,b){"undefined"==typeof b&&(b=a,a=b[this.idAttribute]);var c=this.get(a);return c&&(c=f(c,b),this.save(c)),c},updateAll:function(a){var b=this.all();return b.forEach(function(b){b=f(b,a),this.save(b)},this),b},find:function(d){var e,f,g=this.name,h=this;return d?this.ids.reduce(function(i,j){return f=a(h.storageAdaptor.getItem(b(g,j))),e=c(d,f),e&&i.push(f),i},[]):this.all()},get:function(c){return a(this.storageAdaptor.getItem(b(this.name,c)))},all:function(){var c,d=this,e=this.name;return this.ids.reduce(function(f,g){return c=d.storageAdaptor.getItem(b(e,g)),c&&f.push(a(c)),f},[])},destroy:function(c){var d,e=c[this.idAttribute]?c[this.idAttribute]:c,f=b(this.name,e);return c=a(this.storageAdaptor.getItem(f)),this.storageAdaptor.removeItem(f),d=this.ids.indexOf(e),-1!=d&&this.ids.splice(d,1),this.storageAdaptor.setItem(this.name,this.ids.join(",")),c},destroyAll:function(d){for(var e,f,g,h,i=this.ids.length-1;i>=0;i--)e=this.ids[i],h=b(this.name,e),d?(g=a(this.storageAdaptor.getItem(h)),f=c(d,g),f&&(this.storageAdaptor.removeItem(h),this.ids.splice(i,1))):this.storageAdaptor.removeItem(h);d?this.storageAdaptor.setItem(this.name,this.ids.join(",")):(this.storageAdaptor.removeItem(this.name),this.ids=[])},size:function(){return this.ids.length}};return g}),define("widgets/talkRatingModal",["jquery","lodash","Modernizr","hbs!templates/talkRatingModal","depot","widgets/modal"],function(a,b,c,d,e){"use strict";var f=a.ted.modal.prototype;if(c.localstorage){var g=e("talkRatings",{idAttribute:"id",storageAdaptor:window.sessionStorage});a.widget("ted.talkRatingModal",a.ted.modal,{options:{talkId:null,ratings:[]},_create:function(){var a=g.get(this.options.talkId),c=this;this._calculateTotal(),this._calculatePercents(),this.element.html(d({ratings:this.options.ratings,total:this.options.total})),a&&this.submitted(),f._create.apply(this,b.toArray(arguments)),this.boxes=this.element.find("input.talk-rating__checkbox"),this.button=this.element.find("button.talk-rating__submit__commit"),this._on("button.talk-rating__submit__commit",{click:function(a){a.preventDefault(),c.submit()}}),this._on("input.talk-rating__checkbox",{click:function(){c.sanitize()}}),this._on("a.talk-rating__flip__link",{click:function(a){a.preventDefault(),c.element.toggleClass("talk-rating--flipped")}})},_calculatePercents:function(){var a=this.options.total;b.forEach(this.options.ratings,function(b){b.percent=a>0?Math.round(b.count/a*100):0})},_calculateTotal:function(){var a=b.pluck(this.options.ratings,"count");this.options.total=b.reduce(a,function(a,b){return a+b})},sanitize:function(){var a=this.boxes,b=a.filter(":checked");this.button.prop("disabled",!b.length),a.not(b).prop("disabled",b.length>2)},submit:function(){var b=this.element.find("input.talk-rating__checkbox:checked"),c=b.map(function(){return+this.value}).toArray(),d=this;return this._trigger("submit"),a.post("/ratings",{talk_id:this.options.talkId,talk_rating_ids:c},"json").then(function(){g.save({id:d.options.talkId,ratings:c}),d.submitted()},function(){window.alert("Sorry, your rating couldn't be saved. Please try again.")})},submitted:function(){this.element.addClass("talk-rating--submitted")}})}}),define("widgets/favoriteButton",["jquery","lodash","lib/auth","lib/favorite","lib/pubSub","widgets/tooltip"],function(a,b,c,d,e){"use strict";function f(){return a(document.documentElement).hasClass("loggedin")}var g="favorite-button",h=g+"--remove",i=g+"--add",j=g+"--working",k=g+"__label",l="Remove",m="Favorite",n="Error",o="Working…";a.widget("ted.favoriteButton",a.ted.tooltip,{options:{favoriteId:null,interactive:!0,inverse:!0,position:{my:"right middle",at:"left middle",collision:"flip flip"},itemId:null,itemType:null,supportTouch:!1,allowClick:!0,signInUrl:window.TED?window.TED.signInUrl:"",signUpUrl:window.TED?window.TED.signUpUrl:""},add:function(){this._toggleFavorite(!0)},details:function(){var a,b=this.options;return a={itemId:b.itemId,itemType:b.itemType},b.favoriteId&&(a.id=b.favoriteId),a},remove:function(){this._toggleFavorite(!1)},_handleFavoriteButtonEvents:{click:function(a){(f()||c.capable())&&(a.preventDefault(),f()?this._toggleFavorite():c.prompt().done(this._toggleFavoriteBound))}},_isAdded:!1,_checkAddition:function(a){this._isOurItem(a)&&this._toggledFavorite(!0)},_checkRemoval:function(a){this._isOurItem(a)&&this._toggledFavorite(!1)},_create:function(){var a=this;this.element.addClass(g),this.label=this.element.find("."+k),b.extend(a.options,{content:'<div style="color:#111;text-align:left;font-size:13px;line-height:1.4;width:145px;"><a class="l3 auth-login" href="'+a.options.signInUrl+'">Log in</a> or <a class="l3" href="'+a.options.signUpUrl+'">sign up</a><br>to add favorites.</div>',beforeOpen:function(){return!f()}}),a._checkDetails(),a._checkAddition=b.bind(a._checkAddition,a),a._checkRemoval=b.bind(a._checkRemoval,a),e("favorite.add").subscribe(a._checkAddition),e("favorite.remove").subscribe(a._checkRemoval),a._on(a._handleFavoriteButtonEvents),a._super(),a._toggleFavoriteBound=b.bind(a._toggleFavorite,a),f()||(a.element.attr("href",a.options.signInUrl),e("auth.login").subscribe(function(){a._checkDetails(),a.element.attr("href","#")}))},_destroy:function(){e("favorite.add").unsubscribe(this._checkAddition),e("favorite.remove").unsubscribe(this._checkRemoval),this._super()},_isOurItem:function(a){return a.itemId===this.options.itemId||a.itemType===this.options.itemType},_setOption:function(a,b){this._super(a,b),"itemId"!==a&&"itemType"!==a||this._checkDetails()},_checkDetails:function(){var a=this;d.get(a.details()).then(function(b){a._isAdded=!!b,b&&(a.options.favoriteId=b.id),a._toggledFavorite(a._isAdded)},function(){a._toggledFavorite(!1)})},_setLabel:function(a){this.label.text(a)},_toggleFavorite:function(a){var c=this;b.isUndefined(a)&&(a=!this._isAdded),a=!!a,c.element.hasClass(j)||(c.element.addClass(j),c._setLabel(o),d[a?"add":"remove"](c.details()).then(function(b){c.options.favoriteId=a?b.id:null,c._toggledFavorite(a)},function(){c._setLabel(n),b.delay(function(){c._setLabel(a?m:l)},800)}).always(function(){c.element.removeClass(j)}))},_toggledFavorite:function(a){this._setLabel(a?l:m),this._isAdded=a,this.element.addClass(a?h:i).removeClass(a?i:h)}})}),define("widgets/watchLaterButton",["jquery","lodash","deferLink","lib/auth","lib/ga","lib/watchLater","lib/pubSub","widgets/tooltip"],function(a,b,c,d,e,f,g){"use strict";function h(){return a(document.documentElement).hasClass("loggedin")}var i="watch-later-button",j=i+"--remove",k=i+"--add",l=i+"--working",m=i+"__label",n="Remove",o="Watch later",p="Error",q="Working…";a.widget("ted.watchLaterButton",a.ted.tooltip,{options:{interactive:!0,inverse:!0,position:{my:"right middle",at:"left middle",collision:"flip flip"},saveId:null,itemId:null,itemType:null,supportTouch:!1,allowClick:!0,signInMessage:"Short on time? Save\nthis to watch later.",signInUrl:window.TED?window.TED.signInUrl:""},add:function(){this._toggleSave(!0)},details:function(){var a,b=this.options;return a={itemId:b.itemId,itemType:b.itemType},b.saveId&&(a.id=b.saveId),a},update:function(a){b.extend(this.options,a),f.update(this.details())},remove:function(){this._toggleSave(!1)},_handleWatchLaterEvents:{click:function(a){return e.sendEvent("watchLater","click",this.options.itemType.toLowerCase()),h()||d.capable()?(a.preventDefault(),void(h()?this._toggleSave():d.prompt().done(this._toggleSaveBound))):void c(50).call(a.target,a)}},_isSaved:!1,_checkAddition:function(a){this._isOurItem(a)&&this._toggledSave(!0)},_checkRemoval:function(a){this._isOurItem(a)&&this._toggledSave(!1)},_create:function(){var a=this;this.element.addClass(i),this.label=this.element.find("."+m),b.extend(a.options,{content:'<div style="color:#111;font-size:13px;line-height:1.6;text-align:left;width:145px;">'+a.options.signInMessage.replace("\n","<br>")+"</div>",beforeOpen:function(){return!h()}}),a._checkDetails(),a._checkAddition=b.bind(a._checkAddition,a),a._checkRemoval=b.bind(a._checkRemoval,a),g("watchLater.add").subscribe(a._checkAddition),g("watchLater.remove").subscribe(a._checkRemoval),a._on(a._handleWatchLaterEvents),a._super(),a._toggleSaveBound=b.bind(a._toggleSave,a),h()||(a.element.attr("href",a.options.signInUrl),g("auth.login").subscribe(function(){a._checkDetails(),a.element.attr("href","#")}))},_destroy:function(){g("watchLater.add").unsubscribe(this._checkAddition),g("watchLater.remove").unsubscribe(this._checkRemoval),this._super()},_isOurItem:function(a){return a.itemId===this.options.itemId&&a.itemType===this.options.itemType},_setOption:function(a,b){this._super(a,b),"itemId"!==a&&"itemType"!==a||this._checkDetails()},_checkDetails:function(){var a=this;f.get(a.details()).then(function(b){a._isAdded=!!b,b&&(a.options.saveId=b.id),a._toggledSave(a._isAdded)},function(){a._toggledSave(!1)})},_setLabel:function(a){this.label.text(a)},_toggleSave:function(a){var c=this;b.isUndefined(a)&&(a=!this._isAdded),a=!!a,c.element.hasClass(l)||(c.element.addClass(l),c._setLabel(q),f[a?"add":"remove"](c.details()).then(function(b){c.options.saveId=a?b.id:null,c._toggledSave(a)},function(){c._setLabel(p),b.delay(function(){c._setLabel(a?o:n)},800)}).always(function(){c.element.removeClass(l)}))},_toggledSave:function(a){this._setLabel(a?n:o),this._isAdded=a,this.element.addClass(a?j:k).removeClass(a?k:j)}})}),define("talk/talkPage",["jquery","lodash","./countdown","utils/query_param","lib/ga","lib/pubSub","talk/transcript","lib/ads","lib/instaplay","lib/qos","lib/favorite","lib/watchLater","utils/share","utils/timeFromUrl","views/subtitle-modal","hbs!templates/talkEndCard","hbs!templates/talkViewsBreakdown","views/ThreadView","models/Thread","hbs!templates/subtitle-help-modal","widgets/playerHero","widgets/tooltip","widgets/popupMenu","widgets/talkArticleLink","widgets/talkDownloadModal","widgets/talkEmbedModal","widgets/talkRatingModal","widgets/favoriteButton","widgets/watchLaterButton","waypoints"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){"use strict";function u(a,b){"embed"===b.service?w.embed(a):(e.sendEvent("talk.share","start",b.service),m(b.service,{url:v.talks[0].shareUrl||v.talks[0].canonical,message:v.talks[0].title}))}var v,w={};return w.endCardTempl=function(a){var d=w.hero.data("tedPlayerHero").playerElement,e=c.getNext(a.relatedTalks);return e&&i.capable()&&"flash"===d.player("mode")?c.template({nextTalk:e,relatedTalks:b.reject(a.relatedTalks,e)}):p(a)},w.forceEndCard=function(){var a=d("endCard");if(a){var e,f=w.options.relatedTalks.slice(0,3),g=f[0],h=b.reject(f,g);e="checker"===a?c.checkerTemplate({nextTalk:g,relatedTalks:h}):"timer"===a||"timer-halted"===a?c.timerTemplate({nextTalk:g,relatedTalks:h}):p({relatedTalks:f}),w.hero.removeClass("player-hero--unactivated").addClass("player-hero--playing player-hero--ended").find("a.player-hero__play").after(e),"timer"===a&&c.startCountdown()}},w.checkDeepLink=function(){var a=n(),b=a.seconds;if(b){if(a.offset){var c=v.talks[0].introDuration;b+=c}var d=w.hero.data("tedPlayerHero").playerElement;d.one("playerready",function(){d.player("seek",b)})}},w.initComments=b.once(function(){var a=new s({id:v.threadId}),b=new r({el:document.getElementById("thread"),model:a});b.render(),a.set("sort",b.getSort()),a.more(),f("comment.report").subscribe(function(){e.sendEvent("comment","flag","talk")}),f("comment.create").subscribe(function(a){e.sendEvent("comment",a.parentId?"reply":"new","talk")}),f("comment.upvote").subscribe(function(a){a.upvoted&&e.sendEvent("comment","upvote","talk")})}),w.initExtras=function(){var c=[];a('a.ga-link[data-ga-category="talk.extras"]').each(function(){c.push(a(this).data("ga-label").split("|")[0])}),c.length&&e.sendEvent("talk.extras","impression",b.uniq(c).join("|"),{nonInteraction:1}),a("a.open-article").talkArticleLink(),a("a.talk-more__link--citations").on("talkarticlelinkshow",function(){e.sendEvent("talk.extras","click","citation|show")}).on("talkarticlelinkhide",function(){e.sendEvent("talk.extras","click","citation|hide")})},w.initInstaplay=function(){i.check(window.location.href)&&w.hero.playerHero("player").player("play")},w.init=function(d){var f=d.talks[0];v=d,w.options=v,w.hero=a("#player-hero").playerHero({isTranscript:!0,nativeLanguage:v.language,precontrol:v.precontrol||!1,talks:v.talks}),e.sendEvent("talk.page","view",f.id,{nonInteraction:1}),w.initSubtitles(),h.initPlayer(w.hero.playerHero("player")),j.player=w.hero.playerHero("player"),j.initQos(),w.initInstaplay(),w.initWatchLater(f),w.initFavorite(f),w.checkDeepLink();var i=[{label:"Twitter",service:"twitter",smallOnly:!0},{label:"Facebook",service:"facebook",smallOnly:!0},{label:"Email",service:"email",smallOnly:!0},{label:"Google +",service:"gplus"},{label:"LinkedIn",service:"linkedin"},{label:"Pinterest",service:"pinterest"}],k=a("#sharing-other").popupMenu({items:b.map(i,function(a){return b.merge(a,{callback:u})})}).popupMenu("popup").find("li.poup-menu__item");b.each(b.filter(i,{smallOnly:!0}),function(a,b){k.eq(b).addClass("hide-lg")}),a("a.talk-sharing__link").click(function(b){var c=a(this);b.preventDefault(),u(b,{label:c.data("service-label"),service:c.data("service-name")})}),g.player=w.hero.data("tedPlayerHero").playerElement,g.initLink({offset:1e3*f.introDuration}),g.player.one("playerplay",function(){w.hero.find("a.player-hero__play").after(w.endCardTempl({relatedTalks:v.relatedTalks.slice(0,3)}))}),g.player.one("playerended",c.startCountdown),a("a.download-button").on("click",w.download),a("a.rate-button").on("click",w.rate),a("#thread").waypoint(w.initComments,{offset:"100%"}),w.initCoder(),w.initExtras(),w.initNoLanguage(),w.forceEndCard()},w.initCoder=function(){var a;return b.once(function(){history&&history.replaceState&&(g.player.on("playerpause",function(){if(a){var b=window.location.href.split("#")[0],c=a-v.talks[0].introDuration;if(0>=c)return;history.replaceState(history.state,null,b+"#t-"+Math.floor(1e3*c))}}),g.player.on("playercurrenttime",function(b,c){a=c.currentTime}))})}(),w.download=function(){var b;return function(c){c&&c.preventDefault()&&c.preventDefault(),b?b.talkDownloadModal("open"):(b=a("<div>").talkDownloadModal(a.extend({open:e.sendEvent.recall("talk.download","show"),download:function(a,b){e.sendEvent("talk.download","download",b.type+("audio"===b.type?"":"|"+b.quality))}},{talk:v.talks[0]})),g.player.on("playersubtitle",function(a,c){b.talkDownloadModal("option","subtitle",c.subtitle.languageCode)}))}}(),w.embed=function(){var b;return function(){b?b.talkEmbedModal("open"):b=a("<div>").talkEmbedModal(a.extend({open:e.sendEvent.recall("talk.embed","show")},{talk:v.talks[0]}))}}(),w.initBreakdown=function(c){a("#sharing-count").tooltip({openDelay:300,content:q({sources:b.map(c,function(a){return a.width=a.value/2,a})}),position:{my:"center top+10",at:"center bottom",of:window,collision:"fit flip"},inverse:"true",interactive:!0})},w.initFavorite=function(c){var d={itemId:c.id,itemType:"Talk"};a("a.favorite-button").favoriteButton(d);var g=null,h=b.once(function(){e.sendEvent("favorite","play","talk")}),i=w.hero.playerHero("player");i.on("playercurrenttime",function(){g&&h()}),k.get(d).done(function(a){a&&(g=a.id)}),f("favorite.add").subscribe(function(a){a.itemId===d.itemId&&a.itemType===d.itemType&&(g=a.id)}),f("favorite.remove").subscribe(function(a){a.itemId===d.itemId&&a.itemType===d.itemType&&(g=null)})},w.initNoLanguage=function(){d("nolanguage")&&a("<div class=player-hero__hiccup><div class=player-hero__inner><div class=container>Sorry, subtitles are not available in the language you requested.</div></div></div>").insertBefore(w.hero)},w.initSubtitles=function(){var b=a("#hero-subtitle-link"),c=w.hero.playerHero("player"),d=a("<div>").html(t()).modal({autoOpen:!1}),f=!1,g=new o;w.hero.on("click","a.controls__subtitles",function(){e.sendEvent("talk.subtitleSelector","show","controls")}),a("#hero-subtitle-help").on("click",function(a){a.preventDefault(),a.stopPropagation(),d.modal("open")}),b.on("click",function(a){a.preventDefault(),f&&(g.open(),e.sendEvent("talk.subtitleSelector","show","hero"))});var h;g.state.on("change:selected",function(a,b){var d=String(h),e=String(b),f=e!==d,i=!!b&&f;f&&(c.player("subtitle",b),g.close()),i&&c.player("play")}),c.on({playerready:function(){c.player("canSubtitle")&&(g.render(),f=!0,b.removeClass("player-hero__meta__transcript-link--unclickable"))},playersubtitle:function(a,b){h=b&&b.subtitle&&b.subtitle.languageCode?b.subtitle.languageCode:!1,g.state.set("selected",h)},playertalk:function(a,b){g.state.set("languages",b.languages)}})},w.initWatchLater=function(c){var d={itemId:c.id,itemType:"Talk"},g=w.hero.playerHero("player");a("a.watch-later-button").watchLaterButton(a.extend({signInMessage:"Short on time? Save\nthis talk to watch later."},d));var h=null,i=b.once(function(a){e.sendEvent("watchLater","play","talk",a)});g.on("playercurrenttime",b.throttle(function(a,b){if(h){var c=Math.floor(b.currentTime);c>5&&l.update({id:h,secondsPlayed:c}),i(c)}},3e4)),l.get(d).done(function(a){a&&(a.secondsPlayed&&!n().seconds&&g.one("playerready",function(){g.player("seek",a.secondsPlayed,!0)}),h=a.id)}),f("watchLater.add").subscribe(function(a){a.itemId===c.id&&(h=a.id)}),f("watchLater.remove").subscribe(function(a){a.itemId===c.id&&(h=null)})},w.rate=function(){var b;return function(c){c&&c.preventDefault()&&c.preventDefault(),b?b.talkRatingModal("open"):b=a("<div>").talkRatingModal(a.extend({open:e.sendEvent.recall("talk.rate","show"),submit:e.sendEvent.recall("talk.rate","submit")},{talkId:v.talks[0].id,ratings:v.ratings}))}}(),w.hero=null,w}),define("global/floodlight",["jquery","exports"],function(a,b){"use strict";b.close=function(){window.localStorage.setItem("floodlight","hide"),a("#floodlight").slideUp(240)},b.clear=function(){try{window.localStorage.removeItem("floodlight")}catch(a){}}}),define("global/links",["jquery","deferLink","lib/ga"],function(a,b,c){"use strict";function d(a){if(a.match(location.origin))return!1;for(var b=-1;++b<h;)if(a.match(g[b].re))return g[b]}function e(b,c,d){b=a.extend({},i,b);for(var e in b)b.hasOwnProperty(e)&&a.isFunction(b[e])&&(b[e]=b[e].call(c,d));return b}function f(a){var f=d(this.href);return f?(c.send(e(f,this,a)),b.call(this,a)):!0}var g=[{re:/^https?:\/\/(?:.*\.)tedprize\.(org|com)/,eventCategory:"link.outbound.tedPrize"},{re:/^https?:\/\/ed\.ted\.com/,eventCategory:"link.outbound.tedEd"},{re:/^https?:\/\/tedfellows\.posterous\.com/,eventCategory:"link.outbound.fellowsBlog"},{re:/^https?:\/\/(?:.*\.)universalsubtitles\.org/,eventCategory:"link.outbound.translatorDashboard"},{re:/^https?:\/\/(?:.*\.)feedburner\.com/,eventCategory:"link.outbound.feedburner"},{re:/^https?:\/\//}],h=g.length,i={hitType:"event",eventCategory:"link.outbound.other",eventAction:"click",eventLabel:function(){return this.href}};return{init:function(){a("body").on("click","a[href]",f)}}}),define("Mailcheck",["exports"],function(a){var b={domainThreshold:2,secondLevelThreshold:2,topLevelThreshold:2,defaultDomains:["msn.com","bellsouth.net","telus.net","comcast.net","optusnet.com.au","earthlink.net","qq.com","sky.com","icloud.com","mac.com","sympatico.ca","googlemail.com","att.net","xtra.co.nz","web.de","cox.net","gmail.com","ymail.com","aim.com","rogers.com","verizon.net","rocketmail.com","google.com","optonline.net","sbcglobal.net","aol.com","me.com","btinternet.com","charter.net","shaw.ca"],defaultSecondLevelDomains:["yahoo","hotmail","mail","live","outlook","gmx"],defaultTopLevelDomains:["com","com.au","com.tw","ca","co.nz","co.uk","de","fr","it","ru","net","org","edu","gov","jp","nl","kr","se","eu","ie","co.il","us","at","be","dk","hk","es","gr","ch","no","cz","in","net","net.au","info","biz","mil","co.jp","sg","hu"],run:function(a){a.domains=a.domains||b.defaultDomains,a.secondLevelDomains=a.secondLevelDomains||b.defaultSecondLevelDomains,a.topLevelDomains=a.topLevelDomains||b.defaultTopLevelDomains,a.distanceFunction=a.distanceFunction||b.sift3Distance;var c=function(a){return a},d=a.suggested||c,e=a.empty||c,f=b.suggest(b.encodeEmail(a.email),a.domains,a.secondLevelDomains,a.topLevelDomains,a.distanceFunction);return f?d(f):e()},suggest:function(a,b,c,d,e){a=a.toLowerCase();var f=this.splitEmail(a);if(c&&d&&-1!==c.indexOf(f.secondLevelDomain)&&-1!==d.indexOf(f.topLevelDomain))return!1;var g=this.findClosestDomain(f.domain,b,e,this.domainThreshold);if(g)return g==f.domain?!1:{address:f.address,domain:g,full:f.address+"@"+g};var h=this.findClosestDomain(f.secondLevelDomain,c,e,this.secondLevelThreshold),i=this.findClosestDomain(f.topLevelDomain,d,e,this.topLevelThreshold);if(f.domain){var g=f.domain,j=!1;if(h&&h!=f.secondLevelDomain&&(g=g.replace(f.secondLevelDomain,h),j=!0),i&&i!=f.topLevelDomain&&(g=g.replace(f.topLevelDomain,i),j=!0),1==j)return{address:f.address,domain:g,full:f.address+"@"+g}}return!1},findClosestDomain:function(a,b,c,d){d=d||this.topLevelThreshold;var e,f=99,g=null;if(!a||!b)return!1;c||(c=this.sift3Distance);for(var h=0;h<b.length;h++){if(a===b[h])return a;e=c(a,b[h]),f>e&&(f=e,g=b[h])}return d>=f&&null!==g?g:!1},sift3Distance:function(a,b){if(null==a||0===a.length)return null==b||0===b.length?0:b.length;if(null==b||0===b.length)return a.length;for(var c=0,d=0,e=0,f=0,g=5;c+d<a.length&&c+e<b.length;){if(a.charAt(c+d)==b.charAt(c+e))f++;else{d=0,e=0;for(var h=0;g>h;h++){if(c+h<a.length&&a.charAt(c+h)==b.charAt(c)){d=h;break}if(c+h<b.length&&a.charAt(c)==b.charAt(c+h)){e=h;break}}}c++}return(a.length+b.length)/2-f},splitEmail:function(a){var b=a.trim().split("@");if(b.length<2)return!1;for(var c=0;c<b.length;c++)if(""===b[c])return!1;var d=b.pop(),e=d.split("."),f="",g="";if(0==e.length)return!1;if(1==e.length)g=e[0];else{f=e[0];for(var c=1;c<e.length;c++)g+=e[c]+".";g=g.substring(0,g.length-1)}return{topLevelDomain:g,secondLevelDomain:f,domain:d,address:b.join("@")}},encodeEmail:function(a){var b=encodeURI(a);return b=b.replace("%20"," ").replace("%25","%").replace("%5E","^").replace("%60","`").replace("%7B","{").replace("%7C","|").replace("%7D","}")}};return"undefined"!=typeof module&&module.exports&&(module.exports=b),"function"==typeof define&&define.amd&&define("mailcheck",[],function(){return b}),"undefined"!=typeof window&&window.jQuery&&!function(a){a.fn.mailcheck=function(a){var c=this;if(a.suggested){var d=a.suggested;a.suggested=function(a){d(c,a)}}if(a.empty){var e=a.empty;a.empty=function(){e.call(null,c)}}a.email=this.val(),b.run(a)}}(jQuery),b}),define("lib/newsletter",["jquery","Mailcheck"],function(a,b){"use strict";function c(b){var c=[];return b.isDaily&&c.push("daily"),b.isWeekly&&c.push("weekly"),b.isFellows&&c.push("fellows"),a.getJSON("//www.ted.com/newsletter/signup.json?callback=?",{newsletterSignup:{email_address:b.email,subscription_list:c}})}function d(c){var d=[],e=new a.Deferred;return""===c.email&&d.push("blankemail"),(""+c.email).match(/.+@.+/)||d.push("email"),c.isDaily||c.isWeekly||c.isFellows||d.push("subscription"),b.run({email:c.email,suggested:function(a){if(d.push({type:"suggestion",data:a.full}),1===d.length){var e=c.email.match(/@(.+$)/)[1];b.defaultDomains.push(e)}}}),d.length?e.rejectWith(c,[d]):e.resolveWith(c),e.promise()}function e(b){function e(a){"error"===a.status?i.rejectWith(b,[["uncaught"]]):i.resolveWith(b)}function f(){i.rejectWith(b,[["server"]])}function g(){c(b).then(e,f)}function h(a){i.rejectWith(this,[a])}var i=new a.Deferred;return d(b).then(g,h),i}return{ajax:c,subscribe:e,validate:d}}),define("global/subscribe",["jquery","lodash","lib/newsletter","lib/ga"],function(a,b,c,d){"use strict";function e(){d.sendEvent("newsletter","success",b.filter([h.isDaily?"daily":!1,h.isWeekly?"weekly":!1]).join(",")),a(n+"-details").slideUp(o),a(n+"-success").slideDown(o)}function f(b){var c,d,e,f=b[0];if(m.slideUp(o),"object"==typeof f?(c=f.type,d=f.data):c=f,e=a(n+"-error-"+c),e.slideDown(o),d){var g=e.find(".newsletter-signup-error__data");g.text(d),g.click(function(a){a.preventDefault(),l.val(d),m.slideUp(o)})}}function g(a){p(),d.sendEvent("newsletter","submit","footer"),h={email:l.val(),isDaily:j.is(":checked"),isWeekly:k.is(":checked")},c.subscribe(h).then(e,f),a.preventDefault()}var h,i,j,k,l,m,n="#newsletter-signup",o="fast",p=b.once(function(){j=a(n+"-daily"),k=a(n+"-weekly"),l=a(n+"-email"),m=i.find("p.footer-newsletter__error")});return{init:function(){i=a(n),i.on("submit",g)}}}),define("hbs!templates/latcherFixture",["hbs","hbs/handlebars"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div class="latcher">\n  <a class="latcher__back" href="#">Main</a>\n</div>\n'},useData:!0});return b.registerPartial("templates/latcherFixture",c),
c}),define("global/navs",["jquery","lib/ga","lib/pubSub","spinjs","hbs!templates/latcherFixture","lib/resize"],function(a,b,c,d,e){"use strict";function f(){return i||(i=new d({className:"spinner spinner--centered"})),i}function g(b,c){var d=b.data("url");c.drillDown("findNext",d,function(b){if(b)b.element.drillDown("show");else{var g=a(e());f().spin(g.get(0)),g.find("a.latcher__back").on("click",function(){c.drillDown("show")}),c.drillDown("queue",g,{id:d}),g.drillDown("show"),a.ajax({url:d,xhrFields:{withCredentials:!0}}).done(function(b){f().stop(),g.append(a(b).find("#submenu").addClass("submenu--fixture").find("a.submenu__heading__link[href=#]").closest("h3").remove().end().end().find("li."+n).removeClass(n).end())})}})}function h(d){var e=c("breakpoint").read()>=1024,f=a(this),h=f.closest("li.nav__item"),i=h.siblings(),j=h.closest("div.shoji__fixture"),n=h.closest("div.drillDown"),o=h.children(l),p=h.hasClass(m),q=f.data("ga-label");if(!h.hasClass("nav__item--disabled")){if(h[e?"addClass":"toggleClass"](m),i.not(k).removeClass(m),!o.length)return void(n.length&&h.hasClass("nav__item--latch")&&(d.preventDefault(),g(f,n)));!p&&q&&h.hasClass(m)&&b.sendEvent("navigation.menu","open",q),!j.length&&e||(i.filter(k).removeClass(m).children(l).stop(!0,!0).animate({height:"hide"},200),o.stop(!0,!0).animate({height:"toggle"},200),d.preventDefault())}}var i,j={},k="li.nav__item--foldable",l="div.nav__folder",m="nav__item--active",n="submenu__item--active";return j.init=function(){a(document).on("click","a.nav__link",h)},j}),define("lib/shoji",["jquery","lodash","Modernizr","lib/pubSub","utils/throwError","lib/resize"],function(a,b,c,d,e){"use strict";function f(b){var c=a(b);return c.hasClass(o)||(c=c.closest("div."+o)),c.length||e("Could not find fixture "+b),c}function g(){s(),a(document.activeElement).blur(),l.removeClass(p+" "+q)}function h(c,d){var e=a("<div class="+o+">"),f={};return b.defaults(f,d,{at:"left"}),s(),e.addClass(o+"--"+f.at),e.data("at",f.at),e.append(c),e.appendTo(m),e}function i(){return s(),c.csstransforms3d&&n>=320}function j(a){g(),l.addClass("shoji--opened shoji--"+a)}function k(a){var b=f(a);s(),m.children().removeClass(r),b.addClass(r),j(b.data("at"))}var l,m,n,o="shoji__fixture",p="shoji--left",q="shoji--right",r=o+"--revealed",s=b.once(function(){l=a("#shoji"),m=a("#shoji-fixtures"),a("#shoji-lattice").on("click",function(){return g(),!1}),d("breakpoint").subscribe(function(a){n=a})});return{_getFixture:f,_init:s,addFixture:h,canSlide:i,concealFixture:g,revealFixture:k,slide:j}}),define("widgets/fixture",["jquery","lodash","lib/shoji","jqueryui/widget"],function(a,b,c){"use strict";var d,e=b.once(function(){d=a("body,html")});return a.widget("ted.fixture",{options:{at:"left",autoReveal:!0,scrollAnimationDuration:200},_create:function(){e(),this.fixture=c.addFixture(this.element.remove(),{at:this.options.at}),this.options.autoReveal&&this.reveal()},reveal:function(){this.options.scrollAnimationDuration&&d.scrollTop()&&d.animate({scrollTop:0},this.options.scrollAnimationDuration),c.revealFixture(this.fixture)},conceal:function(){c.concealFixture()}}),function(b,c){return a(b).fixture(c)}}),define("widgets/drillDown",["jquery","lodash","jqueryui/widget"],function(a,b){"use strict";a.widget("ted.drillDown",{options:{id:null,prev:null,next:null,tense:null},_create:function(){var a=this.options,b=a.prev;a.next||(a.next=[]);var c=a.next.length,d=a.tense;d||(d="present",b&&(d="future"),c&&(d="past")),this.element.addClass("drillDown drillDown--"+d),b?a.prev.after(this.element):c&&a.next[0].element.before(this.element)},next:function(a){return a&&(this.options.next=a),this.options.next},prev:function(a,b){return arguments.length?this.options.prev=this._drify(a,{next:this.element},b):this.options.prev},queue:function(a,b){this.options.next.push(this._drify(a,{prev:this.element},b))},show:function(){var a=this.options;if(a.prev&&a.prev.addClass("drillDown--past"),this._nextEls().addClass("drillDown--future"),this._dShow)this._dShow();else{var c=this.element;this._dShow=function(){c.removeClass("drillDown--past drillDown--future")},b.defer(this._dShow)}},findNext:function(a,b){for(var c,d=this.options.next,e=d.length;e--&&!c;)d[e].options.id===a&&(c=d[e]);return b&&b.call(c,c),c},_drify:function(b,c,d){var e=a(b),f=this.widgetFullName;return e.data(f)||e.drillDown(a.extend(c,d||{})).data(f)},_nextEls:function(){for(var b=a(),c=this.options.next,d=c.length;d--;)b=b.add(c[d].element);return b}})}),define("menuAim",["jquery"],function(a){"use strict";function b(b){var c,d=a(this),e=null,f=[],g=null,h=a.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:a.noop,exit:a.noop,activate:a.noop,deactivate:a.noop,exitMenu:a.noop},b),i=3,j=300,k=200,l=function(a){f.push({x:a.pageX,y:a.pageY}),f.length>i&&f.shift()},m=function(){g&&clearTimeout(g),h.exitMenu(this)&&(e&&h.deactivate(e),e=null)},n=function(){g&&clearTimeout(g),h.enter(this),r(this)},o=function(){h.exit(this)},p=function(){q(this)},q=function(a){a!==e&&(e&&h.deactivate(e),h.activate(a),e=a)},r=function(a){var b=s();null===b?g=setTimeout(function(){q(a)},k):b?g=setTimeout(function(){r(a)},b):q(a)},s=function(){function b(a,b){return(b.y-a.y)/(b.x-a.x)}if(!e||!a(e).is(h.submenuSelector))return null;var g=d.offset(),i={x:g.left,y:g.top-h.tolerance},k={x:g.left+d.outerWidth(),y:i.y},l={x:g.left,y:g.top+d.outerHeight()+h.tolerance},m={x:g.left+d.outerWidth(),y:l.y},n=f[f.length-1],o=f[0];if(!n)return 0;if(o||(o=n),o.x<g.left||o.x>m.x||o.y<g.top||o.y>m.y)return 0;if(c&&n.x===c.x&&n.y===c.y)return 0;var p=k,q=m;"left"===h.submenuDirection?(p=l,q=i):"below"===h.submenuDirection?(p=m,q=l):"above"===h.submenuDirection&&(p=i,q=k);var r=b(n,p),s=b(n,q),t=b(o,p),u=b(o,q);return t>r&&s>u?(c=n,j):(c=null,0)};d.mouseleave(m).find(h.rowSelector).mouseenter(n).mouseleave(o).on("touchend",function(b){e&&a(e).is(h.submenuSelector)||(b.preventDefault(),p.apply(this,Array.prototype.slice.call(arguments,0)))}).click(p),a(document).mousemove(l)}return a.fn.menuAim=function(a){return this.each(function(){b.call(this,a)}),this},a}),define("global/mainNav",["jquery","lodash","lib/shoji","lib/pubSub","lib/ga","hbs!templates/latcherFixture","lib/resize","widgets/fixture","widgets/drillDown","menuAim"],function(a,b,c,d,e,f){"use strict";function g(b){if(b.preventDefault(),c.canSlide())if(j)j.fixture("reveal");else{j=a("#banner-core").clone(),j.find("nav.nav--main").removeClass("nav--main"),j.add("*[id]",j).removeAttr("id"),j.find("li.nav__item--latch a").attr("href",function(){var b=a(this),c=b.attr("href");return b.attr("data-url",c),"#"}),j.show(),j.fixture();var d=a("div.shoji__fixture--left #submenu");if(j.drillDown({tense:d.length?"past":"present"}),!d.length)return;var e=a(f()).append(d.clone().addClass("submenu--fixture"));e.find("a.latcher__back").on("click",function(){j.drillDown("show")}),j.drillDown("queue",e,{tense:"present"})}else a("#main-nav").toggleClass("nav--main--open")}function h(b){1024>b||(d("breakpoint").unsubscribe(h),a("#main-nav").find("ul:first > li > a").each(function(){var b=a(this);a('<span class="nav__link nav__link--placeholder" aria-hidden></span>').text(b.text()).insertAfter(b),b.addClass("nav__link--placeheld")}))}function i(){function c(){i=!0,o.trigger("mouseleave")}function f(){return m.read()>=1024}function g(d){1024>d||(m.unsubscribe(g),o.menuAim({activate:function(b){var c=a(b),d=c.find("a.nav__link"),g=d.data("ga-label");return f()?(g&&!c.hasClass(j)&&e.sendEvent("navigation.menu","open",g),c.addClass(j).removeClass(k),void p.addClass(l)):!1},deactivate:function(b){return f()?(a(b).removeClass(j).removeClass(k),void p.removeClass(l)):!1},exitMenu:function(d){return f()?i?(i=!1,!0):(a(d).find("li."+j).addClass(k),h=b.delay(c,n),!1):!1},enter:function(b){return f()?(a(b).removeClass(k),clearTimeout(h),void(h=null)):!1},submenuDirection:"below"}),p.on("click",c))}var h,i,j="nav__item--active",k="nav__item--deactivating",l="main-nav-screen--active",m=d("breakpoint"),n=250,o=a(this).children("ul"),p=a("#main-nav-screen");d("breakpoint").subscribe(g)}var j,k={};return k.init=function(){d("breakpoint").subscribe(h),a("#main-nav-toggle").on("click",g),a("nav.nav--main").each(i)},k}),define("hbs!templates/login",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){return'\n<div class="login-form">\n  <form class="form-vertical" action="https://auth.ted.com/session" method="post">\n    <label class="form-group">\n      <span class="form-label">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Email:",{name:"t",hash:{},data:d}))+'</span>\n      <input class="form-control" name="user[email]" type="email">\n    </label>\n\n    <label class="form-group">\n      <span class="form-label">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Password:",{name:"t",hash:{},data:d}))+'</span>\n      <input class="form-control" name="user[password]" type="password">\n    </label>\n\n    <div class="form-group">\n      <input class="button button--dark button--wide" type="submit" value="Log in">\n\n      <div>\n        <a class="l3" href="https://auth.ted.com/account/password/new">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Need help logging in?",{name:"t",hash:{},data:d}))+'</a>\n      </div>\n    </div>\n  </form>\n\n  <div class="login-form__or"></div>\n\n  <div>\n    <a class="button button--wide button--dark button--facebook" href="/users/new?facebook=true">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Log in with Facebook",{name:"t",hash:{},data:d}))+"</a>\n  </div>\n\n  <div>\n    "+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Don't have a TED account?",{name:"t",hash:{},data:d}))+'\n    <a class="l3" href="/users/new">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Sign up",{name:"t",hash:{},data:d}))+"</a>\n  </div>\n</div>\n"},useData:!0});return b.registerPartial("templates/login",c),c}),define("global/login",["jquery","lib/shoji","lib/pubSub","hbs!templates/login","lib/resize","widgets/fixture","widgets/tooltip"],function(a,b,c,d){"use strict";function e(e){var f=c("breakpoint").read()>=1024;if(j&&!f&&b.canSlide())return e.preventDefault(),h?void h.fixture("reveal"):void(h=a(d()).fixture({at:"right"}))}function f(a){1024>a||j&&(c("breakpoint").unsubscribe(f),g.tooltip({content:d(),interactive:!0,position:{my:"right bottom-20",at:"right top",of:window,collision:"fit flip"},beforeOpen:function(){return c("breakpoint").read()>=1024}}))}var g,h,i={},j=!1;return i.init=function(){g=a("#login-link"),g.on("click",e),c("breakpoint").subscribe(f)},i}),define("hbs!templates/accountFixture",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){var e;return null!=(e=b["if"].call(a,null!=a?a.items:a,{name:"if",hash:{},fn:this.program(2,d,0),inverse:this.program(10,d,0),data:d}))?e:""},2:function(a,b,c,d){var e,f;return'          <li class="nav__item nav__item--foldable '+(null!=(e=b["if"].call(a,null!=a?a.open:a,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+'">\n            <a class="nav__link" href="#">'+this.escapeExpression((f=null!=(f=b.name||(null!=a?a.name:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"name",hash:{},data:d}):f))+'</a>\n            <div class="nav__folder" '+(null!=(e=b["if"].call(a,null!=a?a.open:a,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+'>\n              <ul class="nav__menu">\n'+(null!=(e=b.each.call(a,null!=a?a.items:a,{name:"each",hash:{},fn:this.program(7,d,0),inverse:this.noop,data:d}))?e:"")+"              </ul>\n            </div>\n          </li>\n"},3:function(a,b,c,d){return"nav__item--active"},5:function(a,b,c,d){return'style="display:block"'},7:function(a,b,c,d){var e,f;return'                  <li class="nav__item">\n                    <a class="nav__link" href="'+this.escapeExpression((f=null!=(f=b.url||(null!=a?a.url:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"url",hash:{},data:d}):f))+'" '+(null!=(e=b["if"].call(a,null!=a?a.external:a,{name:"if",hash:{},fn:this.program(8,d,0),inverse:this.noop,data:d}))?e:"")+">"+this.escapeExpression((f=null!=(f=b.name||(null!=a?a.name:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"name",hash:{},data:d}):f))+"</a>\n                  </li>\n"},8:function(a,b,c,d){return'target="_blank"'},10:function(a,b,c,d){var e,f;return'          <li class="nav__item '+(null!=(e=b["if"].call(a,null!=a?a.latch:a,{name:"if",hash:{},fn:this.program(11,d,0),inverse:this.noop,data:d}))?e:"")+'">\n            <a class="nav__link" href="'+this.escapeExpression((f=null!=(f=b.url||(null!=a?a.url:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"url",hash:{},data:d}):f))+'" '+(null!=(e=b["if"].call(a,null!=a?a.external:a,{name:"if",hash:{},fn:this.program(8,d,0),inverse:this.noop,data:d}))?e:"")+">"+this.escapeExpression((f=null!=(f=b.name||(null!=a?a.name:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"name",hash:{},data:d}):f))+"</a>\n          </li>\n"},11:function(a,b,c,d){return"nav__item--latch"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e;return'\n<div class="account__fixture">\n  <div class="account__fixture__welcome">\n    <h2 class="h6">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Hi ",{name:"t",hash:{},data:d}))+this.escapeExpression(this.lambda(null!=(e=null!=a?a.user:a)?e.firstName:e,a))+",</h2>\n    <div>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"This is your stuff.",{name:"t",hash:{},data:d}))+'</div>\n  </div>\n\n  <nav class="nav">\n    <ul class="nav__menu">\n'+(null!=(e=b.each.call(a,null!=a?a.items:a,{name:"each",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+"    </ul>\n  </nav>\n</div>\n"},useData:!0});return b.registerPartial("templates/accountFixture",c),c}),define("hbs!templates/accountPoparoo",["hbs","hbs/handlebars","templates/helpers/t"],function(a,b){var c=b.template({1:function(a,b,c,d){return"account__poparoo__later--populated"},3:function(a,b,c,d){var e;return'      <li class="account__poparoo__item">\n        <a class="l3" href="/profiles/'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.user:a)?e.profileId:e,a))+'/tedx-event-management">\n          '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"TEDx Events",{name:"t",hash:{},data:d}))+"\n        </a>\n      </li>\n"},5:function(a,b,c,d){var e;return'      <li class="account__poparoo__item">\n        <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.conferences:e,a))+'">\n          '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Conferences",{name:"t",hash:{},data:d}))+"\n        </a>\n      </li>\n"},7:function(a,b,c,d){var e;return'      <li class="account__poparoo__item">\n        <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.tedEdHistory:e,a))+'" target="_blank">\n          '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Your activity on TED-Ed",{name:"t",hash:{},data:d}))+"\n        </a>\n      </li>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(a,b,c,d){var e,f;return'\n<div class="account__poparoo">\n  <h2>'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Hi ",{name:"t",hash:{},data:d}))+this.escapeExpression(this.lambda(null!=(e=null!=a?a.user:a)?e.firstName:e,a))+",</h2>\n  <div>"+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"This is your stuff.",{name:"t",hash:{},data:d}))+'</div>\n\n  <ul class="account__poparoo__menu">\n    <li class="account__poparoo__item" id="account-talks">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.savedTalks:e,a))+'">\n        '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Saved talks",{name:"t",hash:{},data:d}))+'\n      </a>\n\n      <a class="account__poparoo__later '+(null!=(e=b["if"].call(a,null!=a?a.savedTalksCount:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.savedTalks:e,a))+'">\n        <span class="account__poparoo__later__count">'+this.escapeExpression((f=null!=(f=b.savedTalksCount||(null!=a?a.savedTalksCount:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"savedTalksCount",hash:{},data:d}):f))+'</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item" id="account-playlists">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.savedPlaylists:e,a))+'">\n        '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Saved playlists",{name:"t",hash:{},data:d}))+'\n      </a>\n\n      <a class="account__poparoo__later '+(null!=(e=b["if"].call(a,null!=a?a.savedPlaylistsCount:a,{name:"if",hash:{},fn:this.program(1,d,0),inverse:this.noop,data:d}))?e:"")+'" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.savedPlaylists:e,a))+'">\n        <span class="account__poparoo__later__count">'+this.escapeExpression((f=null!=(f=b.savedPlaylistsCount||(null!=a?a.savedPlaylistsCount:a))?f:b.helperMissing,"function"==typeof f?f.call(a,{name:"savedPlaylistsCount",hash:{},data:d}):f))+'</span>\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.favoriteTalks:e,a))+'">\n        '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Favorite talks",{name:"t",hash:{},data:d}))+'\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.favoritePlaylists:e,a))+'">\n        '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Favorite playlists",{name:"t",hash:{},data:d}))+"\n      </a>\n    </li>\n\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.user:a)?e.isTEDxOrganizer:e,{name:"if",hash:{},fn:this.program(3,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.user:a)?e.hasConferences:e,{name:"if",hash:{},fn:this.program(5,d,0),inverse:this.noop,data:d}))?e:"")+"\n"+(null!=(e=b["if"].call(a,null!=(e=null!=a?a.user:a)?e.hasEdActivity:e,{name:"if",hash:{},fn:this.program(7,d,0),inverse:this.noop,data:d}))?e:"")+'\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.settings:e,a))+'">\n        '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Settings",{name:"t",hash:{},data:d}))+'\n      </a>\n    </li>\n\n    <li class="account__poparoo__item">\n      <a class="l3" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.profile:e,a))+'">\n        '+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Your profile",{name:"t",hash:{},data:d}))+'\n      </a>\n    </li>\n  </ul>\n\n  <a class="account__poparoo__leave" href="'+this.escapeExpression(this.lambda(null!=(e=null!=a?a.itemUrls:a)?e.logOut:e,a))+'">'+this.escapeExpression((b.t||a&&a.t||b.helperMissing).call(a,"Log out",{name:"t",hash:{},data:d}))+"</a>\n</div>\n"},useData:!0});return b.registerPartial("templates/accountPoparoo",c),c}),define("plugins/addClassFor",["jquery"],function(a){"use strict";a.fn.extend({addClassFor:function(a,b){var c=this;return window.setTimeout(function(){c.removeClass(a)},b),c.addClass(a)}})}),define("global/account",["jquery","lodash","lib/shoji","lib/pubSub","lib/currentUser","lib/personalStorage","lib/watchLaterLocal","utils/monogram","hbs!templates/accountFixture","hbs!templates/accountPoparoo","hbs!templates/latcherFixture","lib/resize","transit","widgets/fixture","plugins/addClassFor"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(a,b){a.find("a.account__poparoo__later")[b?"addClass":"removeClass"]("account__poparoo__later--populated").find("span").text(b)}function m(b){var e=d("breakpoint").read()>=1024;if(c.canSlide()&&(b.preventDefault(),!e)){if(t)return void t.fixture("reveal");t=a(i({items:z(u),user:u})).fixture({at:"right"}),t.find("li.nav__item--latch a").attr("href",function(){var b=a(this),c=b.attr("href");return b.attr("data-url",c),"#"});var f=a("div.shoji__fixture--right #submenu");if(t.drillDown({tense:f.length?"past":"present"}),f.length){f.find("h3.submenu__heading").remove();var g=a(k()).append(f.clone().addClass("submenu--fixture"));g.find("a.latcher__back").on("click",function(){t.drillDown("show")}),t.drillDown("queue",g,{tense:"present"})}}}function n(){g.count().done(A)}function o(a){if(!(1024>a)){d("breakpoint").unsubscribe(o);var b=r.parent().find("div.nav__folder").html(j({itemUrls:y,user:u,savedTalksCount:!1,savedPlaylistsCount:!1}));v=b.find("a."+x),n()}}function p(){s||(s=a("#account-link").find("img.banner__account__image")),s.transition({opacity:0}).transition({opacity:1}).transition({opacity:0}).transition({opacity:1})}function q(b){var c;u=b,B(),n(),u.avatarUrl?(c=a("<img class=banner__account__image id=account-image>"),c.attr({alt:"",src:u.avatarUrl}),a("#account-image").replaceWith(c)):a("#account-image").text(h(u.firstName+" "+u.lastName))}var r,s,t,u,v,w={},x="account__poparoo__later",y={savedTalks:"/dashboard/saved_talks",savedPlaylists:"/dashboard/saved_playlists",favoriteTalks:"/dashboard/favorite_talks",favoritePlaylists:"/dashboard/favorite_playlists",watchHistory:"/dashboard/history",conferences:"/dashboard/conferences",tedEdHistory:"http://ed.ted.com/activity/lessons",settings:TED.settingsUrl,profile:"/profile",logOut:TED.signOutUrl},z=function(a){var b=[];if(b.push({name:"Talks",open:!0,items:[{name:"Saved talks",url:y.savedTalks},{name:"Saved playlists",url:y.savedPlaylists},{name:"Favorite talks",url:y.favoriteTalks},{name:"Favorite playlists",url:y.favoritePlaylists},{name:"Talks you've watched",url:y.watchHistory}]}),a&&a.isTEDxOrganizer&&b.push({name:"TEDx Events",url:"https://tedx-apply.ted.com/manage"}),a&&a.hasConferences){var c={name:"Conferences",open:!1,items:[]};a.upcomingConferences&&a.upcomingConferences.reduce(function(a,b){return a.push({name:b.name,url:"/dashboard/conferences/"+b.slug}),a},c.items),c.items.push({name:"Badge",url:"/dashboard/conferences/badge"}),c.items.push({name:"Contact us",url:"/dashboard/conferences/contact"}),b.push(c)}return a&&a.hasEdActivity&&b.push({name:"Your TED-Ed activity",url:y.tedEdHistory,external:!0}),b.push({latch:!0,name:"Settings",url:TED.settingsUrl}),b.push({name:"Your profile",url:"/profile"}),b.push({name:"Log out",url:TED.signOutUrl}),b},A=function(){var b,c,d;return function(e){var f,g=e.total,h=g>0;if(g!==b){var i;c&&e.talks!==c&&(f="talks",i=e.talks>c),d&&e.playlists!==d&&(f="playlists",i=e.playlists>d),f&&a("#account-"+f)[i?"addClass":"removeClass"]("account__poparoo__item--active"),e.talks!==c&&l(a("#account-talks"),e.talks),e.playlists!==d&&l(a("#account-playlists"),e.playlists);var j=a("#account-badge");j.text(e.total>99?99:e.total)[h?"addClass":"removeClass"]("badge--visible"),h&&null!==b&&e.total>b&&j.addClassFor("badge--notify",600),c=e.talks,d=e.playlists,b=g}}}(),B=b.once(function(){r=a("#account-link"),r.on("click",m),d("breakpoint").subscribe(o),d("favorite.add").subscribe(p),d("watchLater.add").subscribe(n),d("watchLater.remove").subscribe(n)});return w.init=b.once(function(){d("auth.login").subscribe(q),e.getDetails().done(q)}),w}),define("global/uconf",["jquery","Cookies"],function(a,b){"use strict";var c="#";return{init:function(d,e){a(c+e).on("click",function(e){e.preventDefault(),a(c+d).slideUp("fast"),b.expire("_uconf",{domain:"ted.com",path:"/"})})}}}),define("global/keyboard",["jquery","exports","jqueryui/core"],function(a,b){"use strict";b._keyDowned=!1,b._keyDown=function(c){var d;c.keyCode!==a.ui.keyCode.SPACE||b._keyDowned||c.isPropagationStopped()||c.isDefaultPrevented()||!(d=a(c.target)).is("a[role=button]")||(c.preventDefault(),d.trigger("click",c)),b._keyDowned=!0},b._keyUp=function(){b._keyDowned=!1},b.init=function(){a(window).on({keydown:b._keyDown,keyup:b._keyUp})}}),define("global/errors",["lib/errorCollector"],function(a){"use strict";window.onerror=function(b,c,d){d&&c.match(/^https?:\/\/(?:.*\.)?(?:ted|tedcdn)\.com\//)&&(!c.match(/\.js/)&&5>d||a.log(b,{file:c,line:d}))}}),require(["jquery","lodash","dq","global/floodlight","global/links","global/subscribe","global/navs","global/mainNav","global/login","global/account","global/uconf","global/keyboard","lib/ads","global/errors","lib/auth","lib/instaplay","jqueryujs"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";b.defer(function(){e.init(),f.init(),g.init(),h.init(),i.init(),j.init(),l.init()}),c({q:_g,modules:{ads:m,floodlight:d,uconf:k}})}),define("global",function(){}),define("talk",["jquery","dq","abby-tests/sponsorship-2/sponsorship","talk/talkPage","talk/transcript","global"],function(a,b,c,d,e){"use strict";b({modules:{sponsorship:c,talkPage:d,transcript:e}})})}();